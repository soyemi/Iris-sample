!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=47)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){n.d(t,"GLContext",function(){return Re}),n.d(t,"GLProgram",function(){return u}),n.d(t,"GLUtility",function(){return xe}),n.d(t,"glmath",function(){return ve}),n.d(t,"vec2",function(){return _e}),n.d(t,"vec4",function(){return ge}),n.d(t,"vec3",function(){return be}),n.d(t,"quat",function(){return we}),n.d(t,"mat4",function(){return Te}),n.d(t,"mat3",function(){return Ee}),n.d(t,"GLFrameBuffer",function(){return p}),n.d(t,"GLSL",function(){return a}),n.d(t,"GLSL_STRUCT",function(){return s}),n.d(t,"GLSL_FUNC",function(){return l}),n.d(t,"GLShaderComposerBase",function(){return c}),n.d(t,"GLShaderComposer",function(){return f}),n.d(t,"GLPipelineState",function(){return h}),n.d(t,"GLTFaccessor",function(){return Se}),n.d(t,"GLTFanimation",function(){return Pe}),n.d(t,"GLTFanimationSampler",function(){return Ae}),n.d(t,"GLTFasset",function(){return Fe}),n.d(t,"GLTFbuffer",function(){return De}),n.d(t,"GLTFbufferView",function(){return Oe}),n.d(t,"GLTFcamera",function(){return Me}),n.d(t,"GLTFchannel",function(){return Ce}),n.d(t,"GLTFimage",function(){return Ue}),n.d(t,"GLTFindices",function(){return Ie}),n.d(t,"GLTFmaterial",function(){return Be}),n.d(t,"GLTFmesh",function(){return ke}),n.d(t,"GLTFnode",function(){return Le}),n.d(t,"GLTFnormalTextureInfo",function(){return Ne}),n.d(t,"GLTFocclusionTextureInfo",function(){return je}),n.d(t,"GLTForthographic",function(){return ze}),n.d(t,"GLTFpbrMetallicRoughness",function(){return Xe}),n.d(t,"GLTFperspective",function(){return Ge}),n.d(t,"GLTFprimitive",function(){return Ve}),n.d(t,"GLTFsampler",function(){return He}),n.d(t,"GLTFscene",function(){return We}),n.d(t,"GLTFskin",function(){return Ye}),n.d(t,"GLTFsparse",function(){return qe}),n.d(t,"GLTFtarget",function(){return Qe}),n.d(t,"GLTFtexture",function(){return Ke}),n.d(t,"GLTFtextureInfo",function(){return $e}),n.d(t,"GLTFvalues",function(){return Je}),n.d(t,"GLTFfile",function(){return Ze}),n.d(t,"GLTFdata",function(){return et}),n.d(t,"GLTFbinary",function(){return tt}),n.d(t,"GLTFtool",function(){return nt});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})}function o(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var a,u=function(){function e(e,t){this.Attributes={},this.Uniforms={},this.UniformsInfo={},this.UniformBlock={},this.Program=t;for(var n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),r=0;r<n;r++){var i=e.getActiveAttrib(t,r);if(null!=i){var o=e.getAttribLocation(t,i.name);this.Attributes[i.name]=o}}var a=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(r=0;r<a;r++){var u=e.getActiveUniform(t,r);if(null!=u){var s=u.name;this.UniformsInfo[s]=u;var l=e.getUniformLocation(t,s);this.Uniforms[s]=l}}var c=e.getProgramParameter(t,e.ACTIVE_UNIFORM_BLOCKS);for(r=0;r<c;r++){var f=e.getActiveUniformBlockName(t,r);null!=f&&(this.UniformBlock[f]=r)}}return e.prototype.GetUniform=function(e){return this.Uniforms[e]},e.prototype.GetAttribute=function(e){return this.Attributes[e]},e}();!function(e){e[e.vs=0]="vs",e[e.ps=1]="ps",e[e.vec2=2]="vec2",e[e.vec3=3]="vec3",e[e.vec4=4]="vec4",e[e.float=5]="float",e[e.int=6]="int",e[e.sampler2D=7]="sampler2D",e[e.void=8]="void",e[e.in=9]="in",e[e.out=10]="out",e[e.inout=11]="inout",e[e.lowp=12]="lowp",e[e.mediump=13]="mediump",e[e.highp=14]="highp",e[e.mat3=15]="mat3",e[e.mat4=16]="mat4"}(a||(a={}));var s=function(){function e(){this.parameters=[]}return e.prototype.parameter=function(e,t){this.parameters.push({type:e,symbol:t})},e.prototype.mergeCode=function(){var e="struct "+this.name+" {";return this.parameters.forEach(function(t){e+=" "+a[t.type]+" "+t.symbol+";"}),e+="};\n"},e}(),l=function(){function e(e){this.rettype=a.void,this.code="",this.parameters=[],this.name=e}return e.prototype.line=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.join(" ");return(n=n.trim()).endsWith(";")||(n+=";"),n+="\n",this.code+=n,this},e.prototype.params=function(e){return this.parameters=e,this},e.prototype.parameter=function(e,t,n){return this.parameters.push({type:e,symbol:t,prefix:n}),this},e.prototype.body=function(e){return this.code=e,this},e.prototype.ret=function(e){return this.rettype=e,this},e.prototype.mergeCode=function(){for(var e=a[this.rettype]+" "+this.name+" (",t=0,n=this.parameters.length;t<n;t++){var r=this.parameters[t];e+=(null==r.prefix?"":a[r.prefix])+" "+a[r.type]+" "+r.symbol,t!=n-1&&(e+=",")}return e+="){\n",e+=this.code+"}\n"},e}(),c=function(){function e(e){this.m_attrs=[],this.m_varys=[],this.m_varysStruct=[],this.m_uniform=[],this.m_precisions=[],this.m_main=new l("main"),this.m_funcs=[],this.m_defines=[],this.m_shadertype=e}return e.prototype.attr=function(e,t,n){return void 0===n&&(n=a.in),this.m_attrs.push({symbol:t,type:e}),this.composer},e.prototype.vary=function(e,t,n){var r=n;return null==r&&(r=this.m_shadertype==a.vs?a.out:a.in),this.m_varys.push({type:e,symbol:t,prefix:r}),this.composer},e.prototype.varyStruct=function(e,t,n){var r=n;return null==r&&(r=this.m_shadertype==a.vs?a.out:a.in),this.m_varysStruct.push({type:e.name,symbol:t,prefix:r}),this.composer},e.prototype.uniform=function(e,t){return this.m_uniform.push({type:e,symbol:t}),this.composer},e.prototype.attrs=function(e){return this.m_attrs=this.m_attrs.concat(e),this.composer},e.prototype.define=function(e){return this.m_defines.push(e),this.composer},e.prototype.struct=function(e){return this.m_defines.push(e.mergeCode()),this.composer},e.prototype.main=function(e){return e(this.m_main),this.composer},e.prototype.func=function(e,t){var n=new l(e);return t(n),this.m_funcs.push(n),this.composer},e.prototype.precision=function(e,t){return this.m_precisions.push({type:e,level:t}),this.composer},e.prototype.compile=function(){return this.mergeShaderSource(),this.m_shaderSource},e.prototype.mergeShaderSource=function(){var e=this,t="#version 300 es\n";this.m_precisions.forEach(function(e){t+="precision "+a[e.level]+" "+a[e.type]+";\n"}),this.m_attrs.forEach(function(e){t+=a[null==e.prefix?a.in:e.prefix]+" "+a[e.type]+" "+e.symbol+";\n"}),this.m_varys.forEach(function(n){var r=null==n.prefix?e.m_shadertype==a.vs?a.out:a.in:n.prefix,i=n.type,o=i;Number.isInteger(i)&&(o=a[i]),t+=a[r]+" "+o+" "+n.symbol+";\n"}),this.m_uniform.forEach(function(e){t+="uniform "+a[e.type]+" "+e.symbol+";\n"}),this.m_defines.forEach(function(e){t+=e+"\n"}),this.m_varysStruct.forEach(function(n){var r=null==n.prefix?e.m_shadertype==a.vs?a.out:a.in:n.prefix,i=n.type,o=i;Number.isInteger(i)&&(o=a[i]),t+=a[r]+" "+o+" "+n.symbol+";\n"}),this.m_funcs.forEach(function(e){t+=e.mergeCode()}),t+=this.m_main.mergeCode(),this.m_shaderSource=t},e.createStruct=function(e){var t=new s;return t.name=e,t},e}(),f=function(e){function t(t){var n=e.call(this,t)||this;return n.composer=n,n}return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.create=function(e){return new t(e)},t}(c),p=function(){function e(){this.m_valid=!1}return e.create=function(t,n,r,i,o,a,u){var s=n.gl;null==o&&(o=s.canvas.width),null==a&&(a=s.canvas.height),null==u?u=new e:u.isvalid&&u.release(n);var l=s.createFramebuffer();if(null==l)return null;var c=t?n.savePipeline(s.FRAMEBUFFER_BINDING,s.TEXTURE_BINDING_2D):null;s.bindFramebuffer(s.FRAMEBUFFER,l);var f=s.createTexture();s.bindTexture(s.TEXTURE_2D,f),s.texStorage2D(s.TEXTURE_2D,1,r,o,a),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.bindTexture(s.TEXTURE_2D,null),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,f,0);var p=null;return null!=i&&(p=s.createTexture(),s.bindTexture(s.TEXTURE_2D,p),s.texStorage2D(s.TEXTURE_2D,1,i,o,a),s.bindTexture(s.TEXTURE_2D,null),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,p,0)),s.bindFramebuffer(s.FRAMEBUFFER,null),u.colorTex0=f,u.depthTex0=p,u.frambuffer=l,u.width=o,u.height=a,u.colorFormat=r,u.depthFormat=i,null!=c&&n.restorePipeline(c),u.m_valid=!0,u},e.prototype.release=function(e){var t=e.gl;t.deleteFramebuffer(this.frambuffer),this.frambuffer=null,t.deleteTexture(this.colorTex0),t.deleteTexture(this.depthTex0),this.colorTex0=null,this.depthTex0=null,this.m_valid=!1},Object.defineProperty(e.prototype,"isvalid",{get:function(){return this.m_valid},enumerable:!0,configurable:!0}),e.prototype.bind=function(e){e.bindFramebuffer(e.FRAMEBUFFER,this.frambuffer)},e}(),h=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.m_state=[],null!=e)for(var r=0,i=t.length;r<i;r++){var o=t[r],a=e.getParameter(o);this.m_state.push({type:o,data:a})}}return e.prototype.restore=function(e){for(var t=this.m_state,n=0,r=t.length;n<r;n++)this.restoreParamter(e,t[n])},e.prototype.restoreParamter=function(e,t){var n=t.data;switch(t.type){case e.VIEWPORT:e.viewport(n[0],n[1],n[2],n[3]);break;case e.COLOR_CLEAR_VALUE:e.clearColor(n[0],n[1],n[2],n[3]);break;case e.DEPTH_CLEAR_VALUE:e.clearDepth(n);break;case e.STENCIL_CLEAR_VALUE:e.clearStencil(n);break;case e.TEXTURE_BINDING_2D:e.bindTexture(e.TEXTURE_2D,n);break;case e.FRAMEBUFFER_BINDING:e.bindFramebuffer(e.FRAMEBUFFER,n);break;case e.ARRAY_BUFFER_BINDING:e.bindBuffer(e.ARRAY_BUFFER,n);break;case e.ELEMENT_ARRAY_BUFFER:e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n);break;case e.CULL_FACE:n?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE)}},e}(),d="undefined"!==typeof e?e:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{},m=[],y=[],v="undefined"!==typeof Uint8Array?Uint8Array:Array,_=!1;function g(){_=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;t<n;++t)m[t]=e[t],y[e.charCodeAt(t)]=t;y["-".charCodeAt(0)]=62,y["_".charCodeAt(0)]=63}function b(e){return m[e>>18&63]+m[e>>12&63]+m[e>>6&63]+m[63&e]}function w(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16)+(e[o+1]<<8)+e[o+2],i.push(b(r));return i.join("")}function T(e){var t;_||g();for(var n=e.length,r=n%3,i="",o=[],a=0,u=n-r;a<u;a+=16383)o.push(w(e,a,a+16383>u?u:a+16383));return 1===r?(t=e[n-1],i+=m[t>>2],i+=m[t<<4&63],i+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],i+=m[t>>10],i+=m[t>>4&63],i+=m[t<<2&63],i+="="),o.push(i),o.join("")}function E(e,t,n,r,i){var o,a,u=8*i-r-1,s=(1<<u)-1,l=s>>1,c=-7,f=n?i-1:0,p=n?-1:1,h=e[t+f];for(f+=p,o=h&(1<<-c)-1,h>>=-c,c+=u;c>0;o=256*o+e[t+f],f+=p,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;c>0;a=256*a+e[t+f],f+=p,c-=8);if(0===o)o=1-l;else{if(o===s)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),o-=l}return(h?-1:1)*a*Math.pow(2,o-r)}function R(e,t,n,r,i,o){var a,u,s,l=8*o-i-1,c=(1<<l)-1,f=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,d=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),(t+=a+f>=1?p/s:p*Math.pow(2,1-f))*s>=2&&(a++,s/=2),a+f>=c?(u=0,a=c):a+f>=1?(u=(t*s-1)*Math.pow(2,i),a+=f):(u=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+h]=255&u,h+=d,u/=256,i-=8);for(a=a<<i|u,l+=i;l>0;e[n+h]=255&a,h+=d,a/=256,l-=8);e[n+h-d]|=128*m}var x={}.toString,S=Array.isArray||function(e){return"[object Array]"==x.call(e)};function P(){return F.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function A(e,t){if(P()<t)throw new RangeError("Invalid typed array length");return F.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=F.prototype:(null===e&&(e=new F(t)),e.length=t),e}function F(e,t,n){if(!F.TYPED_ARRAY_SUPPORT&&!(this instanceof F))return new F(e,t,n);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return M(this,e)}return D(this,e,t,n)}function D(e,t,n,r){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);F.TYPED_ARRAY_SUPPORT?(e=t).__proto__=F.prototype:e=C(e,t);return e}(e,t,n,r):"string"===typeof t?function(e,t,n){"string"===typeof n&&""!==n||(n="utf8");if(!F.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|B(t,n),i=(e=A(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(I(t)){var n=0|U(t.length);return 0===(e=A(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||function(e){return e!==e}(t.length)?A(e,0):C(e,t);if("Buffer"===t.type&&S(t.data))return C(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function O(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function M(e,t){if(O(t),e=A(e,t<0?0:0|U(t)),!F.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function C(e,t){var n=t.length<0?0:0|U(t.length);e=A(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function U(e){if(e>=P())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+P().toString(16)+" bytes");return 0|e}function I(e){return!(null==e||!e._isBuffer)}function B(e,t){if(I(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return se(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return le(e).length;default:if(r)return se(e).length;t=(""+t).toLowerCase(),r=!0}}function k(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function L(e,t,n,r,i){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"===typeof t&&(t=F.from(t,r)),I(t))return 0===t.length?-1:N(e,t,n,r,i);if("number"===typeof t)return t&=255,F.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):N(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function N(e,t,n,r,i){var o,a=1,u=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,u/=2,s/=2,n/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var c=-1;for(o=n;o<u;o++)if(l(e,o)===l(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===s)return c*a}else-1!==c&&(o-=o-c),c=-1}else for(n+s>u&&(n=u-s),o=n;o>=0;o--){for(var f=!0,p=0;p<s;p++)if(l(e,o+p)!==l(t,p)){f=!1;break}if(f)return o}return-1}function j(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var u=parseInt(t.substr(2*a,2),16);if(isNaN(u))return a;e[n+a]=u}return a}function z(e,t,n,r){return ce(se(t,e.length-n),e,n,r)}function X(e,t,n,r){return ce(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function G(e,t,n,r){return X(e,t,n,r)}function V(e,t,n,r){return ce(le(t),e,n,r)}function H(e,t,n,r){return ce(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function W(e,t,n){return 0===t&&n===e.length?T(e):T(e.slice(t,n))}function Y(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,u,s,l=e[i],c=null,f=l>239?4:l>223?3:l>191?2:1;if(i+f<=n)switch(f){case 1:l<128&&(c=l);break;case 2:128===(192&(o=e[i+1]))&&(s=(31&l)<<6|63&o)>127&&(c=s);break;case 3:o=e[i+1],a=e[i+2],128===(192&o)&&128===(192&a)&&(s=(15&l)<<12|(63&o)<<6|63&a)>2047&&(s<55296||s>57343)&&(c=s);break;case 4:o=e[i+1],a=e[i+2],u=e[i+3],128===(192&o)&&128===(192&a)&&128===(192&u)&&(s=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&u)>65535&&s<1114112&&(c=s)}null===c?(c=65533,f=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=f}return function(e){var t=e.length;if(t<=q)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=q));return n}(r)}F.TYPED_ARRAY_SUPPORT=void 0===d.TYPED_ARRAY_SUPPORT||d.TYPED_ARRAY_SUPPORT,F.poolSize=8192,F._augment=function(e){return e.__proto__=F.prototype,e},F.from=function(e,t,n){return D(null,e,t,n)},F.TYPED_ARRAY_SUPPORT&&(F.prototype.__proto__=Uint8Array.prototype,F.__proto__=Uint8Array),F.alloc=function(e,t,n){return function(e,t,n,r){return O(t),t<=0?A(e,t):void 0!==n?"string"===typeof r?A(e,t).fill(n,r):A(e,t).fill(n):A(e,t)}(null,e,t,n)},F.allocUnsafe=function(e){return M(null,e)},F.allocUnsafeSlow=function(e){return M(null,e)},F.isBuffer=function(e){return null!=e&&(!!e._isBuffer||fe(e)||function(e){return"function"===typeof e.readFloatLE&&"function"===typeof e.slice&&fe(e.slice(0,0))}(e))},F.compare=function(e,t){if(!I(e)||!I(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},F.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},F.concat=function(e,t){if(!S(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return F.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=F.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(!I(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},F.byteLength=B,F.prototype._isBuffer=!0,F.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)k(this,t,t+1);return this},F.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)k(this,t,t+3),k(this,t+1,t+2);return this},F.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)k(this,t,t+7),k(this,t+1,t+6),k(this,t+2,t+5),k(this,t+3,t+4);return this},F.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?Y(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return $(this,t,n);case"utf8":case"utf-8":return Y(this,t,n);case"ascii":return Q(this,t,n);case"latin1":case"binary":return K(this,t,n);case"base64":return W(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},F.prototype.equals=function(e){if(!I(e))throw new TypeError("Argument must be a Buffer");return this===e||0===F.compare(this,e)},F.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},F.prototype.compare=function(e,t,n,r,i){if(!I(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var o=i-r,a=n-t,u=Math.min(o,a),s=this.slice(r,i),l=e.slice(t,n),c=0;c<u;++c)if(s[c]!==l[c]){o=s[c],a=l[c];break}return o<a?-1:a<o?1:0},F.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},F.prototype.indexOf=function(e,t,n){return L(this,e,t,n,!0)},F.prototype.lastIndexOf=function(e,t,n){return L(this,e,t,n,!1)},F.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return j(this,e,t,n);case"utf8":case"utf-8":return z(this,e,t,n);case"ascii":return X(this,e,t,n);case"latin1":case"binary":return G(this,e,t,n);case"base64":return V(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},F.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var q=4096;function Q(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function K(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function $(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=ue(e[o]);return i}function J(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function Z(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function ee(e,t,n,r,i,o){if(!I(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function te(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function ne(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function re(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function ie(e,t,n,r,i){return i||re(e,0,n,4),R(e,t,n,r,23,4),n+4}function oe(e,t,n,r,i){return i||re(e,0,n,8),R(e,t,n,r,52,8),n+8}F.prototype.slice=function(e,t){var n,r=this.length;if(e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),F.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=F.prototype;else{var i=t-e;n=new F(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},F.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||Z(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},F.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||Z(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},F.prototype.readUInt8=function(e,t){return t||Z(e,1,this.length),this[e]},F.prototype.readUInt16LE=function(e,t){return t||Z(e,2,this.length),this[e]|this[e+1]<<8},F.prototype.readUInt16BE=function(e,t){return t||Z(e,2,this.length),this[e]<<8|this[e+1]},F.prototype.readUInt32LE=function(e,t){return t||Z(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},F.prototype.readUInt32BE=function(e,t){return t||Z(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},F.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||Z(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},F.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||Z(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},F.prototype.readInt8=function(e,t){return t||Z(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},F.prototype.readInt16LE=function(e,t){t||Z(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},F.prototype.readInt16BE=function(e,t){t||Z(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},F.prototype.readInt32LE=function(e,t){return t||Z(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},F.prototype.readInt32BE=function(e,t){return t||Z(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},F.prototype.readFloatLE=function(e,t){return t||Z(e,4,this.length),E(this,e,!0,23,4)},F.prototype.readFloatBE=function(e,t){return t||Z(e,4,this.length),E(this,e,!1,23,4)},F.prototype.readDoubleLE=function(e,t){return t||Z(e,8,this.length),E(this,e,!0,52,8)},F.prototype.readDoubleBE=function(e,t){return t||Z(e,8,this.length),E(this,e,!1,52,8)},F.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||ee(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},F.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||ee(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},F.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||ee(this,e,t,1,255,0),F.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},F.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||ee(this,e,t,2,65535,0),F.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):te(this,e,t,!0),t+2},F.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||ee(this,e,t,2,65535,0),F.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):te(this,e,t,!1),t+2},F.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||ee(this,e,t,4,4294967295,0),F.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):ne(this,e,t,!0),t+4},F.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||ee(this,e,t,4,4294967295,0),F.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ne(this,e,t,!1),t+4},F.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);ee(this,e,t,n,i-1,-i)}var o=0,a=1,u=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===u&&0!==this[t+o-1]&&(u=1),this[t+o]=(e/a>>0)-u&255;return t+n},F.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);ee(this,e,t,n,i-1,-i)}var o=n-1,a=1,u=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===u&&0!==this[t+o+1]&&(u=1),this[t+o]=(e/a>>0)-u&255;return t+n},F.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||ee(this,e,t,1,127,-128),F.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},F.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||ee(this,e,t,2,32767,-32768),F.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):te(this,e,t,!0),t+2},F.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||ee(this,e,t,2,32767,-32768),F.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):te(this,e,t,!1),t+2},F.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||ee(this,e,t,4,2147483647,-2147483648),F.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):ne(this,e,t,!0),t+4},F.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||ee(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),F.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):ne(this,e,t,!1),t+4},F.prototype.writeFloatLE=function(e,t,n){return ie(this,e,t,!0,n)},F.prototype.writeFloatBE=function(e,t,n){return ie(this,e,t,!1,n)},F.prototype.writeDoubleLE=function(e,t,n){return oe(this,e,t,!0,n)},F.prototype.writeDoubleBE=function(e,t,n){return oe(this,e,t,!1,n)},F.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!F.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},F.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!F.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=I(e)?e:se(new F(e,r).toString()),u=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%u]}return this};var ae=/[^+\/0-9A-Za-z-_]/g;function ue(e){return e<16?"0"+e.toString(16):e.toString(16)}function se(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function le(e){return function(e){var t,n,r,i,o,a;_||g();var u=e.length;if(u%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[u-2]?2:"="===e[u-1]?1:0,a=new v(3*u/4-o),r=o>0?u-4:u;var s=0;for(t=0,n=0;t<r;t+=4,n+=3)i=y[e.charCodeAt(t)]<<18|y[e.charCodeAt(t+1)]<<12|y[e.charCodeAt(t+2)]<<6|y[e.charCodeAt(t+3)],a[s++]=i>>16&255,a[s++]=i>>8&255,a[s++]=255&i;return 2===o?(i=y[e.charCodeAt(t)]<<2|y[e.charCodeAt(t+1)]>>4,a[s++]=255&i):1===o&&(i=y[e.charCodeAt(t)]<<10|y[e.charCodeAt(t+1)]<<4|y[e.charCodeAt(t+2)]>>2,a[s++]=i>>8&255,a[s++]=255&i),a}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(ae,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function ce(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function fe(e){return!!e.constructor&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}d.setTimeout,d.clearTimeout;var pe=d.performance||{};pe.now||pe.mozNow||pe.msNow||pe.oNow||pe.webkitNow;function he(e){return"number"===typeof e}var de=Math.PI/360,me=Math.PI/180,ye=180/Math.PI,ve=function(){function e(){}return e.vec3=function(e,t,n){return new be([e,t,n])},e.vec4=function(e,t,n,r){return new ge([e,t,n,r])},e.quat=function(e,t,n,r){return new we([e,t,n,r])},e.clamp=function(e,t,n){return e>n?n:e<t?t:e},e.Deg2Rad=me,e.Rad2Deg=ye,e}(),_e=function(){function e(e){this.raw=[0,0],null!=e&&(this.raw[0]=e[0],this.raw[1]=e[1])}return Object.defineProperty(e.prototype,"x",{get:function(){return this.raw[0]},set:function(e){this.raw[0]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.raw[1]},set:function(e){this.raw[1]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maginatude",{get:function(){var e=this.raw[0],t=this.raw[1];return Math.sqrt(e*e+t*t)},enumerable:!0,configurable:!0}),e.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.addToRef=function(t,n){return null==n?new e([this.x+t.x,this.y+t.y]):(n.x=this.x+t.x,n.y=this.y+t.y,n)},e.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},e.prototype.subToRef=function(t,n){return null==n?new e([this.x-t.x,this.y-t.y]):(n.x=this.x-t.x,n.y=this.y-t.y,n)},e.prototype.mulNum=function(e){this.x*=e,this.y*=e},e.prototype.mulNumToRef=function(t,n){return n?(n.x=this.x*t,n.y=this.y*t,n):new e([this.x*t,this.y*t])},e.prototype.mul=function(e){this.x*=e.x,this.y*=e.y},e.prototype.mulToRef=function(t,n){return n?(n.x=this.x*t.x,n.y=this.y*t.y,n):new e([this.x*t.x,this.y*t.y])},e.prototype.div=function(e){this.x/=e.x,this.y/=e.y},e.prototype.divToRef=function(t,n){return n?(n.x=this.x/t.x,n.y=this.y/t.y,n):new e([this.x/t.x,this.y/t.y])},e.prototype.dot=function(e){return this.x*e.x+this.y*e.y},e.prototype.clone=function(){return new e([this.x,this.y])},Object.defineProperty(e.prototype,"normalize",{get:function(){return this.mulNum(1/this.maginatude),this},enumerable:!0,configurable:!0}),e.prototype.normalized=function(){return this.mulNumToRef(this.maginatude)},e.prototype.set=function(e){this.x=e.x,this.y=e.y},Object.defineProperty(e,"zero",{get:function(){return new e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"one",{get:function(){return new e([1,1])},enumerable:!0,configurable:!0}),e}(),ge=function(){function e(e){this.raw=null!=e?e:[0,0,0,0]}return Object.defineProperty(e.prototype,"x",{get:function(){return this.raw[0]},set:function(e){this.raw[0]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.raw[1]},set:function(e){this.raw[1]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this.raw[2]},set:function(e){this.raw[2]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"w",{get:function(){return this.raw[3]},set:function(e){this.raw[3]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return Math.sqrt(this.dot(this))},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return t instanceof be||t instanceof e?(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t instanceof e?t.w:0):t instanceof Array?(this.x+=t[0],this.y+=t[1],this.z+=t[2],this.w+=t[3]):(this.x+=t,this.y+=t,this.z+=t,this.w+=t),this},e.prototype.addToRef=function(t){if(t instanceof be||t instanceof e){var n=t.x+this.x,r=t.y+this.y,i=t.z+this.z,o=(t instanceof e?t.w:0)+this.w;return ve.vec4(n,r,i,o)}if(t instanceof Array){n=t[0]+this.x,r=t[1]+this.y,i=t[2]+this.z,o=t[3]+this.w;return ve.vec4(n,r,i,o)}return ve.vec4(this.x+t,this.y+t,this.z+t,this.w+t)},e.prototype.sub=function(t){return t instanceof be||t instanceof e?(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t instanceof e?t.w:0):t instanceof Array?(this.x-=t[0],this.y-=t[1],this.z-=t[2],this.w-=t[3]):(this.x-=t,this.y-=t,this.z-=t,this.w-=t),this},e.prototype.subToRef=function(t){if(t instanceof be||t instanceof e){var n=t.x-this.x,r=t.y-this.y,i=t.z-this.z,o=(t instanceof e?t.w:0)-this.w;return ve.vec4(n,r,i,o)}if(t instanceof Array){n=t[0]-this.x,r=t[1]-this.y,i=t[2]-this.z,o=t[3]-this.w;return ve.vec4(n,r,i,o)}return ve.vec4(this.x-t,this.y-t,this.z-t,this.w-t)},e.prototype.mulNum=function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},e.prototype.mulNumToRef=function(e){return ve.vec4(this.x*e,this.y*e,this.z*e,this.w*e)},e.prototype.mul=function(t){return t instanceof e?(this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w):t instanceof Array?(this.x*=t[0],this.y*=t[1],this.z*=t[2],this.w*=t[3]):t instanceof Te?this.raw=t.mulvec(this).raw:t instanceof we?this.raw=t.rota(new be([this.x,this.y,this.z])).raw:he(t)&&(this.x*=t,this.y*=t,this.z*=t,this.w*=t),this},e.prototype.mulToRef=function(t){return t instanceof e?ve.vec4(t.x*this.x,t.y*this.y,t.z*this.z,t.w*this.w):t instanceof Array?ve.vec4(t[0]*this.x,t[1]*this.y,t[2]*this.z,t[3]*this.w):t instanceof Te?t.mulvec(this):t instanceof we?null:he(t)?ve.vec4(this.x*t,this.y*t,this.z*t,this.w*t):void 0},e.prototype.div=function(e){return this.x/=e,this.y/=e,this.z/=e,this.w/=e,this},e.prototype.divToRef=function(e){return ve.vec4(this.x/e,this.y/e,this.z/e,this.w/e)},e.prototype.vec3=function(){return ve.vec3(this.x,this.y,this.z)},e.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},e.prototype.clone=function(){return new e([this.x,this.y,this.z,this.w])},Object.defineProperty(e.prototype,"normalize",{get:function(){return this.div(this.length)},enumerable:!0,configurable:!0}),e.prototype.normalized=function(){return this.divToRef(this.length)},e.Random=function(){return new e([Math.random(),Math.random(),Math.random(),Math.random()])},e.prototype.equals=function(e){for(var t=this.raw,n=e.raw,r=0;r<4;r++)if(t[r]!=n[r])return!1;return!0},e.prototype.set=function(e){this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w},Object.defineProperty(e,"zero",{get:function(){return new e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"one",{get:function(){return new e([1,1,1,1])},enumerable:!0,configurable:!0}),e}(),be=function(){function e(e){this.raw=null!=e?e:[0,0,0]}return Object.defineProperty(e.prototype,"x",{get:function(){return this.raw[0]},set:function(e){this.raw[0]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.raw[1]},set:function(e){this.raw[1]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this.raw[2]},set:function(e){this.raw[2]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return Math.sqrt(this.dot(this))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length2",{get:function(){var e=this.x,t=this.y,n=this.z;return e*e+t*t+n*n},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return t instanceof e||t instanceof ge?(this.x+=t.x,this.y+=t.y,this.z+=t.z):t instanceof Array?(this.x+=t[0],this.x+=t[1],this.x+=t[2]):(this.x+=t,this.y+=t,this.z+=t),this},e.prototype.addToRef=function(t){if(t instanceof e||t instanceof ge){var n=t.x+this.x,r=t.y+this.y,i=t.z+this.z;return ve.vec3(n,r,i)}if(t instanceof Array){n=t[0]+this.x,r=t[1]+this.y,i=t[2]+this.z;return ve.vec3(n,r,i)}return ve.vec3(this.x+t,this.y+t,this.z+t)},e.prototype.sub=function(t){return t instanceof e||t instanceof ge?(this.x-=t.x,this.y-=t.y,this.z-=t.z):t instanceof Array?(this.x-=t[0],this.y-=t[1],this.z-=t[2]):(this.x-=t,this.y-=t,this.z-=t),this},e.prototype.subToRef=function(t){if(t instanceof e||t instanceof ge){var n=this.x-t.x,r=this.y-t.y,i=this.z-t.z;return ve.vec3(n,r,i)}if(t instanceof Array){n=this.x-t[0],r=this.y-t[1],i=this.z-t[2];return ve.vec3(n,r,i)}return ve.vec3(this.x-t,this.y-t,this.z-t)},e.prototype.mulNum=function(e){return this.x*=e,this.y*=e,this.z*=e,this},e.prototype.mulNumToRef=function(e){return ve.vec3(this.x*e,this.y*e,this.z*e)},e.prototype.mul=function(t){return t instanceof e||t instanceof ge?(this.x*=t.x,this.y*=t.y,this.z*=t.z):t instanceof Array?(this.x*=t[0],this.y*=t[1],this.z*=t[2]):t instanceof Ee?this.raw=t.mulvec(this).raw:t instanceof we?this.raw=t.rota(this).raw:(this.x*=t,this.y*=t,this.z*=t),this},e.prototype.mulToRef=function(t){if(t instanceof e||t instanceof ge){var n=t.x*this.x,r=t.y*this.y,i=t.z*this.z;return ve.vec3(n,r,i)}if(t instanceof Array){n=t[0]*this.x,r=t[1]*this.y,i=t[2]*this.z;return ve.vec3(n,r,i)}return t instanceof Ee?e.zero:t instanceof we?t.rota(this):ve.vec3(this.x*t,this.y*t,this.z*t)},e.prototype.div=function(e){return this.x/=e,this.y/=e,this.z/=e,this},e.prototype.divToRef=function(e){return ve.vec3(this.x/e,this.y/e,this.z/e)},e.prototype.vec4=function(e){return void 0===e&&(e=0),ve.vec4(this.x,this.y,this.z,e)},e.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},e.prototype.clone=function(){return new e([this.x,this.y,this.z])},e.prototype.cross=function(t){return e.Cross(this,t)},e.prototype.crossRev=function(t){return e.Cross(t,this)},e.Cross=function(t,n){return new e([t.y*n.z-t.z*n.y,t.z*n.x-t.x*n.z,t.x*n.y-t.y*n.x])},e.SafeCross=function(t,n){var r=new e([t.y*n.z-t.z*n.y,t.z*n.x-t.x*n.z,t.x*n.y-t.y*n.x]);return 0==r.x&&0==r.y&&0==r.z?this.Cross(t.addToRef([1e-7,1e-7,1e-7]),n):r},e.Dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z},e.Add=function(t,n){return new e([t.x+n.x,t.y+n.y,t.z+n.z])},Object.defineProperty(e.prototype,"normalize",{get:function(){return this.div(this.length)},enumerable:!0,configurable:!0}),e.prototype.normalized=function(){return this.divToRef(this.length)},e.Random=function(t){return void 0===t&&(t=!1),new e(t?[Math.random(),Math.random(),Math.random()]:[Math.random()-.5,Math.random()-.5,Math.random()-.5])},e.RandomNorm=function(){return we.Random().rota(e.right)},e.Abs=function(t){return new e([Math.abs(t.x),Math.abs(t.y),Math.abs(t.z)])},e.prototype.set=function(e){this.x=e.x,this.y=e.y,this.z=e.z},Object.defineProperty(e,"zero",{get:function(){return new e([0,0,0])},enumerable:!0,configurable:!0}),Object.defineProperty(e,"one",{get:function(){return new e([1,1,1])},enumerable:!0,configurable:!0}),Object.defineProperty(e,"up",{get:function(){return new e([0,1,0])},enumerable:!0,configurable:!0}),Object.defineProperty(e,"forward",{get:function(){return new e([0,0,1])},enumerable:!0,configurable:!0}),Object.defineProperty(e,"back",{get:function(){return new e([0,0,-1])},enumerable:!0,configurable:!0}),Object.defineProperty(e,"left",{get:function(){return new e([-1,0,0])},enumerable:!0,configurable:!0}),Object.defineProperty(e,"right",{get:function(){return new e([1,0,0])},enumerable:!0,configurable:!0}),Object.defineProperty(e,"down",{get:function(){return new e([0,-1,0])},enumerable:!0,configurable:!0}),e}(),we=function(){function e(e){this.raw=null!=e?e:[0,0,0,0]}return Object.defineProperty(e.prototype,"x",{get:function(){return this.raw[0]},set:function(e){this.raw[0]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.raw[1]},set:function(e){this.raw[1]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this.raw[2]},set:function(e){this.raw[2]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"w",{get:function(){return this.raw[3]},set:function(e){this.raw[3]=e},enumerable:!0,configurable:!0}),e.prototype.conjugate=function(){return e.Conjugate(this)},e.prototype.fmt=function(){if(this.w<0){var e=this.raw;e[0]=-e[0],e[1]=-e[1],e[2]=-e[2],e[3]=-e[3]}return this},e.prototype.mul=function(t){var n=this,r=t.w,i=t.x,o=t.y,a=t.z,u=n.x,s=n.y,l=n.z,c=n.w;return new e([r*u+c*i+s*a-l*o,r*s+c*o+l*i-u*a,r*l+c*a+u*o-s*i,r*c-u*i-s*o-l*a]).fmt()},e.prototype.selfRota=function(e){var t=this.w,n=this.x,r=this.y,i=this.z,o=e.x,a=e.y,u=e.z,s=e.w;return this.x=t*o+s*n+a*i-u*r,this.y=t*a+s*r+u*n-o*i,this.z=t*u+s*i+o*r-a*n,this.w=t*s-o*n-a*r-u*i,this},Object.defineProperty(e,"Identity",{get:function(){return new e([0,0,0,1])},enumerable:!0,configurable:!0}),e.prototype.rota=function(e){var t=new be([this.x,this.y,this.z]),n=t.cross(e).mul(2);return e.clone().add(n.mulToRef(this.w)).add(t.cross(n))},e.fromEulerDeg=function(t,n,r){var i=t*de,o=n*de,a=r*de,u=Math.cos(i),s=Math.cos(o),l=Math.cos(a),c=Math.sin(i),f=Math.sin(o),p=Math.sin(a);return new e([c*s*l+u*f*p,u*f*l-c*s*p,u*s*p-c*f*l,u*s*l+c*f*p])},e.fromEuler=function(t,n,r){var i=t/2,o=n/2,a=r/2,u=Math.cos(i),s=Math.cos(o),l=Math.cos(a),c=Math.sin(i),f=Math.sin(o),p=Math.sin(a);return new e([c*s*l+u*f*p,u*f*l-c*s*p,u*s*p-c*f*l,u*s*l+c*f*p])},e.prototype.toEuler=function(){var e=new be,t=this.z,n=this.x,r=this.y,i=this.w,o=2*(i*t+n*r),a=1-2*(t*t+n*n);e.z=Math.atan2(o,a);var u=2*(i*n-r*t);u>1?u=1:u<-1&&(u=-1),e.x=Math.asin(u);var s=2*(i*r+t*n),l=1-2*(n*n+r*r);return e.y=Math.atan2(s,l),e},e.prototype.toEulerDeg=function(){var e=new be,t=this.z,n=this.x,r=this.y,i=this.w,o=2*(i*t+n*r),a=1-2*(t*t+n*n);e.z=Math.atan2(o,a)*ye;var u=2*(i*n-r*t);u>1?u=1:u<-1&&(u=-1),e.x=Math.asin(u)*ye;var s=2*(i*r+t*n),l=1-2*(n*n+r*r);return e.y=Math.atan2(s,l)*ye,e},e.axisRotation=function(t,n){var r=1/t.length,i=Math.sin(n/2),o=Math.cos(n/2);return new e(t.mulToRef(r*i).vec4(o).raw)},Object.defineProperty(e.prototype,"axis",{get:function(){if(this.magnitude2()>=1.0000001)throw new Error;var e=this.w,t=Math.sqrt(1-e*e);return ve.vec3(this.x/t,this.y/t,this.z/t)},enumerable:!0,configurable:!0}),e.axisRotationDeg=function(t,n){var r=n*me,i=1/t.length,o=Math.sin(r/2),a=Math.cos(r/2);return new e(t.mulToRef(i*o).vec4(a).raw)},e.FromToNormal=function(t,n,r){var i=t.normalized(),o=n.normalized(),a=r.normalized(),u=be.Cross(i,o),s=u.length2;if(0==s){if(1==i.dot(o))return e.Identity;var l=be.Cross(a,i),c=be.Cross(i,l).normalize;return new e([c.x,c.y,c.z,0])}u.div(Math.sqrt(s));var f=i.dot(o),p=Math.sqrt((1+f)/2),h=Math.sqrt((1-f)/2);return u.dot(a)<0&&(u.mul(-1),p*=-1),new e([u.x*h,u.y*h,u.z*h,p])},e.Coordinate=function(t,n){if(t.dot(n)>Number.EPSILON)throw new Error("<forward> must be perpendicular ot <up>");var r=t.normalized(),i=n.normalized(),o=e.FromToNormal(be.forward,r,i),a=o.rota(be.up);return e.FromToNormal(a,n,r).mul(o)},e.QuatToMtx=function(e){var t=e.x,n=e.y,r=e.z,i=e.w,o=2*t*t,a=2*n*n,u=2*r*r,s=t*n*2,l=n*r*2,c=r*t*2,f=i*t*2,p=i*n*2,h=i*r*2;return new Ee([1-a-u,s+h,c-p,s-h,1-o-u,l+f,c+p,l-f,1-o-a])},e.Conjugate=function(t){return new e([-t.x,-t.y,-t.z,t.w])},e.Flip=function(e,t,n,r){var i=e.clone(),o=0;return t&&(i.x=-i.x,o++),n&&(i.y=-i.y,o++),r&&(i.z=-i.z,o++),o%2==1&&(i.x=-i.x,i.y=-i.y,i.z=-i.z),i},e.Div=function(e,t,n){return void 0===n&&(n=!1),n?e.mul(t.conjugate()):t.conjugate().mul(e)},e.MtxToQuat=function(t){var n=t.raw,r=n[1],i=n[2],o=n[3],a=n[5],u=n[7],s=n[8],l=n[0],c=n[4],f=n[6],p=(l+1-2*((l+c+1+s)/4))/2,h=Math.sqrt(p),d=0,m=0,y=0;if(h<1e-6){h=0;var v=1-s;if(0==v){d=0;var _=-o/2;m=0==(y=Math.sqrt((l+1)/2))?1:_/y}else m=u/2/(d=Math.sqrt(v/2)),y=f/2/d}else 0==(d=(r+o)/4/h)?(m=i/2/h,y=u/-2/h):y=0==(m=(a+u)/4/d)?u/-2/h:(r-o)/4/m;return new e([h,d,m,y])},e.prototype.equals=function(e){for(var t=e.w*this.w<0?[-e.x,-e.y,-e.z,-e.w]:e.raw,n=0;n<4;n++)if(Math.abs(t[n]-this.raw[n])>.001)return!1;return!0},e.prototype.magnitude2=function(){var e=this.x,t=this.y,n=this.z,r=this.w;return e*e+t*t+n*n+r*r},e.prototype.magnitude=function(){return Math.sqrt(this.magnitude2())},e.prototype.clone=function(){return new e([this.x,this.y,this.z,this.w])},e.Random=function(){var t=e.axisRotation(ve.vec3(Math.random(),Math.random(),Math.random()),2*Math.PI*Math.random());return t.fmt(),t},e.prototype.set=function(e){this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w},e}(),Te=function(){function e(e){this.raw=null!=e?e:new Array(16)}return e.prototype.column=function(e){var t=this.raw,n=4*e;return new ge([t[n],t[n+1],t[n+2],t[n+3]])},e.prototype.row=function(e){var t=this.raw,n=e;return new ge([t[n],t[n+4],t[n+8],t[n+12]])},Object.defineProperty(e,"Identity",{get:function(){return new e([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},enumerable:!0,configurable:!0}),e.lookAt=function(t,n,r){var i=t.subToRef(n).normalize,o=r.cross(i).normalize,a=i.cross(o).normalize;return e.inverse(new e([o.x,o.y,o.z,0,a.x,a.y,a.z,0,i.x,i.y,i.z,0,-o.dot(t),-a.dot(t),-i.dot(t),1]))},e.coord=function(t,n,r){var i=n.normalized(),o=r.normalized(),a=o.cross(i).normalize;return o=i.cross(a).normalize,new e([a.x,o.x,i.x,0,a.y,o.y,i.y,0,a.z,o.z,i.z,0,-a.dot(t),-o.dot(t),-i.dot(t),1])},e.coordCvt=function(t,n,r){var i=n.normalized(),o=r.normalized(),a=o.crossRev(i).normalize;return o=i.crossRev(a).normalize,new e([a.x,o.x,i.x,0,a.y,o.y,i.y,0,a.z,o.z,i.z,0,-a.dot(t),-o.dot(t),-i.dot(t),1])},e.perspective=function(t,n,r,i){return new e([2*r/t,0,0,0,0,2*r/n,0,0,0,0,(r+i)/(r-i),-1,0,0,2*r*i/(r-i),0])},e.perspectiveFoV=function(e,t,n,r){var i=Math.tan(e/360*Math.PI)*n*2,o=i*t;return this.perspective(o,i,n,r)},e.orthographic=function(t,n,r,i){var o=i-r;return new e([2/t,0,0,0,0,2/n,0,0,0,0,2/o,0,0,0,-(r+i)/o,1])},e.prototype.inverse=function(){return e.inverse(this)},e.inverse=function(t){var n=t.raw,r=new Array(16),i=n[0],o=n[1],a=n[2],u=n[3],s=n[4],l=n[5],c=n[6],f=n[7],p=n[8],h=n[9],d=n[10],m=n[11],y=n[12],v=n[13],_=n[14],g=n[15],b=d*g,w=_*m,T=c*g,E=_*f,R=c*m,x=d*f,S=a*g,P=_*u,A=a*m,F=d*u,D=a*f,O=c*u,M=p*v,C=y*h,U=s*v,I=y*l,B=s*h,k=p*l,L=i*v,N=y*o,j=i*h,z=p*o,X=i*l,G=s*o,V=b*l+E*h+R*v-(w*l+T*h+x*v),H=w*o+S*h+F*v-(b*o+P*h+A*v),W=T*o+P*l+D*v-(E*o+S*l+O*v),Y=x*o+A*l+O*h-(R*o+F*l+D*h),q=1/(i*V+s*H+p*W+y*Y);return r[0]=q*V,r[1]=q*H,r[2]=q*W,r[3]=q*Y,r[4]=q*(w*s+T*p+x*y-(b*s+E*p+R*y)),r[5]=q*(b*i+P*p+A*y-(w*i+S*p+F*y)),r[6]=q*(E*i+S*s+O*y-(T*i+P*s+D*y)),r[7]=q*(R*i+F*s+D*p-(x*i+A*s+O*p)),r[8]=q*(M*f+I*m+B*g-(C*f+U*m+k*g)),r[9]=q*(C*u+L*m+z*g-(M*u+N*m+j*g)),r[10]=q*(U*u+N*f+X*g-(I*u+L*f+G*g)),r[11]=q*(k*u+j*f+G*m-(B*u+z*f+X*m)),r[12]=q*(U*d+k*_+C*c-(B*_+M*c+I*d)),r[13]=q*(j*_+M*a+N*d-(L*d+z*_+C*a)),r[14]=q*(L*c+G*_+I*a-(X*_+U*a+N*c)),r[15]=q*(X*d+B*a+z*c-(j*c+G*d+k*a)),new e(r)},e.Translate=function(t){return new e([1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,t.z,1])},e.mul=function(e,t){return new ge([t.dot(e.row(0)),t.dot(e.row(1)),t.dot(e.row(2)),t.dot(e.row(3))])},e.prototype.add=function(t){return e.add(this,t)},e.add=function(t,n){for(var r=[],i=t.raw,o=n.raw,a=0;a<16;a++)r.push(i[a]+o[a]);return new e(r)},e.prototype.mulvec=function(t){return e.mul(this,t)},e.prototype.mulnum=function(t){for(var n=[],r=this.raw,i=0;i<16;i++)n.push(r[i]*t);return new e(n)},e.Scale=function(t){return new e([t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1])},e.Rotation=function(e){return we.QuatToMtx(e).toMat4()},e.RotationEler=function(e){return Ee.Rotation(we.fromEuler(e.x,e.y,e.z)).toMat4()},e.TRS=function(t,n,r){var i=we.QuatToMtx(n).raw,o=r.x,a=r.y,u=r.z;return new e([i[0]*o,i[1]*o,i[2]*o,0,i[3]*a,i[4]*a,i[5]*a,0,i[6]*u,i[7]*u,i[8]*u,0,t.x,t.y,t.z,1])},e.prototype.setTRS=function(e,t,n){var r=this.raw,i=we.QuatToMtx(t).raw,o=n.x,a=n.y,u=n.z;r[0]=i[0]*o,r[1]=i[1]*o,r[2]=i[2]*o,r[3]=0,r[4]=i[3]*a,r[5]=i[4]*a,r[6]=i[5]*a,r[7]=0,r[8]=i[6]*u,r[9]=i[7]*u,r[10]=i[8]*u,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1},e.prototype.set=function(e){for(var t=this.raw,n=e.raw,r=0;r<16;r++)t[r]=n[r]},e.prototype.mul=function(t){var n=this.row(0),r=this.row(1),i=this.row(2),o=this.row(3),a=t.column(0),u=t.column(1),s=t.column(2),l=t.column(3);return new e([n.dot(a),r.dot(a),i.dot(a),o.dot(a),n.dot(u),r.dot(u),i.dot(u),o.dot(u),n.dot(s),r.dot(s),i.dot(s),o.dot(s),n.dot(l),r.dot(l),i.dot(l),o.dot(l)])},e.prototype.transpose=function(){return e.Transpose(this)},e.Transpose=function(t){var n=t.raw;return new e([n[0],n[4],n[8],n[10],n[1],n[5],n[7],n[11],n[2],n[6],n[8],n[12],n[3],n[7],n[9],n[13]])},e.Decompose=function(e,t){var n=e.raw,r=ve.vec3(n[12],n[13],n[14]),i=n[0],o=n[1],a=n[2],u=n[4],s=n[5],l=n[6],c=n[8],f=n[9],p=n[10],h=ve.vec3(i,o,a),d=ve.vec3(u,s,l),m=ve.vec3(c,f,p),y=ve.vec3(h.length,d.length,m.length);null!=t&&1!=t||i*(s*p-l*f)-o*(u*p-c*l)+a*(u*f-s*c)<0&&(y.z=-y.z);var v=Ee.fromColumns(h.div(y.x),d.div(y.y),m.div(y.z)),_=we.MtxToQuat(v);if(isNaN(_.w)||isNaN(_.x)||isNaN(_.y)||isNaN(_.z))throw new Error("quat is NaN, "+v.raw);return[r,_,y]},e.DecomposeTRS=function(t,n,r,i){var o=new Ee;e.DecomposeAffine(t,n,o,i),r.set(we.MtxToQuat(o))},e.DecomposeAffine=function(e,t,n,r,i){var o=e.raw;t.x=o[12],t.y=o[13],t.z=o[14];var a=e.toMat3();Ee.DecomposeAffine(a,n,r,i)},e.prototype.clone=function(){return new e(this.raw.slice(0))},e.RandomTRS=function(){return e.TRS(be.Random(),we.Random(),be.Random())},e.prototype.mat3Determinant=function(){var e=this.raw;return e[0]*(e[5]*e[10]-e[6]*e[9])-e[4]*(e[1]*e[10]-e[2]*e[9])+e[8]*(e[1]*e[6]-e[2]*e[5])},e.prototype.toMat3=function(){var e=this.raw;return new Ee([e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10]])},e}(),Ee=function(){function e(e){this.raw=null!=e?e:new Array(9)}return e.prototype.column=function(e){var t=this.raw,n=3*e;return new be([t[n],t[n+1],t[n+2]])},e.prototype.setColumn=function(e,t){var n=this.raw,r=3*t;n[r]=e.x,n[r+1]=e.y,n[r+2]=e.z},e.prototype.row=function(e){var t=this.raw,n=e;return new be([t[n],t[n+3],t[n+6]])},e.prototype.setRow=function(e,t){var n=this.raw;n[t]=e.x,n[t+3]=e.y,n[t+6]=e.z},Object.defineProperty(e,"Identity",{get:function(){return new e([1,0,0,0,1,0,0,0,1])},enumerable:!0,configurable:!0}),e.Transpose=function(t){var n=t.raw;return new e([n[0],n[3],n[6],n[1],n[4],n[7],n[2],n[5],n[8]])},e.prototype.transpose=function(){return e.Transpose(this)},e.prototype.toMat4=function(){return e.ToMat4(this)},e.ToMat4=function(e){var t=e.raw;return new Te([t[0],t[1],t[2],0,t[3],t[4],t[5],0,t[6],t[7],t[8],0,0,0,0,1])},e.Cross=function(t){return new e([0,t.z,-t.y,-t.z,0,t.x,t.y,-t.x,0])},e.Diagonal=function(t){return new e([t.x,0,0,0,t.y,0,0,0,t.z])},e.UpperTri=function(t){return new e([1,t.x,t.y,0,1,t.z,0,0,1])},e.fromRS=function(t,n){return e.Mul(we.QuatToMtx(t),e.Scale(n.x,n.y,n.z))},e.Mul=function(t,n){var r=t.row(0),i=t.row(1),o=t.row(2),a=n.column(0),u=n.column(1),s=n.column(2);return new e([r.dot(a),i.dot(a),o.dot(a),r.dot(u),i.dot(u),o.dot(u),r.dot(s),i.dot(s),o.dot(s)])},e.fromRows=function(t,n,r){return new e([t.x,n.x,r.x,t.y,n.y,r.y,t.z,n.z,r.z])},e.fromColumns=function(t,n,r){return new e([t.x,t.y,t.z,n.x,n.y,n.z,r.x,r.y,r.z])},e.prototype.mul=function(t){return e.Mul(this,t)},e.CrossRHS=function(t){return new e([0,-t.z,t.y,t.z,0,-t.x,-t.y,t.x,0])},e.prototype.mulvec=function(t){return e.MulVec(this,t)},e.MulVec=function(e,t){return new be([e.row(0).dot(t),e.row(1).dot(t),e.row(2).dot(t)])},e.Scale=function(t,n,r){return new e([t,0,0,0,n,0,0,0,r])},e.Shear=function(t){return new e([1,t.x,t.y,0,1,t.z,0,0,1])},e.ScaleShear=function(t,n){var r=t.x,i=t.y;return new e([r,r*n.x,r*n.y,0,i,i*n.z,0,0,t.z])},e.Rotation=function(e){return we.QuatToMtx(e)},e.prototype.clone=function(){return new e(this.raw.slice(0))},e.prototype.determinant=function(){var e=this.raw;return e[0]*(e[4]*e[8]-e[5]*e[7])-e[3]*(e[1]*e[8]-e[2]*e[7])+e[6]*(e[1]*e[5]-e[2]*e[4])},e.DecomposeAffine=function(e,t,n,r){var i=e.raw,o=i[0],a=i[1],u=i[2],s=i[3],l=i[4],c=i[5],f=i[6],p=i[7],h=i[8],d=ve.vec3(o,a,u),m=ve.vec3(s,l,c),y=ve.vec3(f,p,h),v=d.clone(),_=m.clone(),g=y.clone(),b=v.length;v.div(b);var w=v.dot(_);_.sub(v.mulNumToRef(w));var T=_.length;_.div(T);var E=v.dot(g),R=_.dot(g);g.sub(v.mulNumToRef(E).add(_.mulNumToRef(R)));var x=g.length;if(g.div(x),t.setColumn(v,0),t.setColumn(_,1),t.setColumn(g,2),t.determinant()<0){for(var S=t.raw,P=0;P<9;P++)S[P]=-S[P];v.mulNum(-1),_.mulNum(-1),g.mulNum(-1)}if(n.x=v.dot(d),n.y=_.dot(m),n.z=g.dot(y),null!=r){var A=1/n.x;r.x=v.dot(m)*A,r.y=v.dot(y)*A,r.z=_.dot(y)/n.y}},e.DecomposeRS=function(t,n,r){var i=new e;e.DecomposeAffine(t,i,r),n.set(we.MtxToQuat(i)),n.fmt()},e}(),Re=function(){function e(e){this.m_drawTexBuffer=new Float32Array(16),this.m_drawTexInited=!1,this.gl=e}return e.createFromGL=function(t){return new e(t)},e.createFromCanvas=function(t,n){var r=t.getContext("webgl2",n);return null==r&&(r=t.getContext("webgl")),null==r?null:new e(r)},e.prototype.createProgram=function(e,t){var n=this.gl,r=n.createShader(n.VERTEX_SHADER);if(n.shaderSource(r,e),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS))return console.error(e),console.error("compile vertex shader failed: "+n.getShaderInfoLog(r)),n.deleteShader(r),null;var i=n.createShader(n.FRAGMENT_SHADER);if(n.shaderSource(i,t),n.compileShader(i),!n.getShaderParameter(i,n.COMPILE_STATUS))return console.error(t),console.error("compile fragment shader failed: "+n.getShaderInfoLog(i)),n.deleteShader(i),null;var o=n.createProgram();return n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),n.getProgramParameter(o,n.LINK_STATUS)?null==o?null:new u(n,o):(console.error("link shader program failed!:"+n.getProgramInfoLog(o)),n.deleteProgram(o),n.deleteShader(r),n.deleteShader(i),null)},e.prototype.createTextureImage=function(e,t){var n=new Image,r=this.gl,i=r.createTexture();return n.onload=function(){r.bindTexture(r.TEXTURE_2D,i),r.texImage2D(r.TEXTURE_2D,0,r.RGB,r.RGB,r.UNSIGNED_BYTE,n),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null),console.log("init webgl texture"),null!=t&&t()},n.src=e,i},e.prototype.createTextureImageAsync=function(e,t,n){return i(this,void 0,void 0,function(){var r;return o(this,function(i){return r=this.gl,[2,new Promise(function(i,o){var a=new Image;a.onload=function(){var e=r.createTexture();try{r.bindTexture(r.TEXTURE_2D,e),r.texImage2D(r.TEXTURE_2D,0,r.RGB,r.RGB,r.UNSIGNED_BYTE,a),null==t&&(t=r.LINEAR_MIPMAP_LINEAR),null==n&&(n=r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,t),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null),i(e)}catch(t){r.deleteTexture(e),o(t)}},a.onerror=function(e){o(e)},a.src=e})]})})},e.prototype.createTexture=function(e,t,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=!1);var o=this.gl,a=o.createTexture();return o.bindTexture(o.TEXTURE_2D,a),o.texStorage2D(o.TEXTURE_2D,1,e,t,n),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,r?o.LINEAR:o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,r?i?o.LINEAR_MIPMAP_LINEAR:o.LINEAR:o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),i&&o.generateMipmap(o.TEXTURE_2D),a},e.prototype.createFrameBuffer=function(e,t,n,r,i,o){return p.create(e,this,t,n,r,i,o)},e.prototype.saveTextureToImage=function(e){if(null==e)return null;var t=this.gl;null==this.m_tempFrameBuffer&&(this.m_tempFrameBuffer=t.createFramebuffer());var n=t.getParameter(t.FRAMEBUFFER_BINDING),r=t.getParameter(t.TEXTURE_BINDING_2D);t.bindFramebuffer(t.FRAMEBUFFER,this.m_tempFrameBuffer),t.bindTexture(t.TEXTURE_2D,e),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);var i=this.saveCurrentFrameBufferToImage();return t.bindTexture(t.TEXTURE_2D,r),t.bindFramebuffer(t.FRAMEBUFFER,n),i},e.prototype.saveCurrentFrameBufferToImage=function(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=null),void 0===r&&(r=null);var i=this.gl;if(null==n||null==r){var o=i.canvas;n=o.width,r=o.height}var a=new Uint8Array(n*r*4);i.readPixels(e,t,n,r,i.RGBA,i.UNSIGNED_BYTE,a);var u=document.createElement("canvas");u.width=n,u.height=r;var s=u.getContext("2d"),l=s.createImageData(n,r);l.data.set(a),s.putImageData(l,0,0);var c=new Image;return c.src=u.toDataURL(),c},e.prototype.drawTexCheckInit=function(){if(this.m_drawTexInited)return!0;var e=this.gl;null==this.m_drawTexAryBuffer&&(this.m_drawTexAryBuffer=e.createBuffer());var t,n=f.create(a.vs).attr(a.vec2,"aPosition").attr(a.vec2,"aUV").vary(a.vec2,"vUV",a.out).precision(a.float,a.mediump).main(function(e){return e.line("gl_Position = vec4(aPosition,-1.0,1.0)").line("vUV = aUV")}).compile(),r=f.create(a.ps).uniform(a.sampler2D,"uSampler").vary(a.vec2,"vUV",a.in).vary(a.vec4,"fragColor",a.out).precision(a.float,a.lowp).main(function(e){return e.line("fragColor = texture(uSampler,vUV)")}).compile(),i=f.create(a.ps).precision(a.float,a.lowp).uniform(a.vec4,"uColor").vary(a.vec2,"vUV",a.in).vary(a.vec4,"fragColor",a.out).main(function(e){return e.line("fragColor = uColor")}).compile();if(null==(t=this.createProgram(n,r)))throw new Error("Internal shader compile error!");if(this.m_drawTexProgram=t,null==(t=this.createProgram(n,i)))throw new Error("Internal shader compile error!");return this.m_drawRectColorProgram=t,this.m_drawTexInited=!0,!0},e.prototype.drawTex=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!0);var i=this.gl;if(i.isTexture(e))if(this.drawTexCheckInit()){var o=n?this.savePipeline(i.ARRAY_BUFFER_BINDING,i.TEXTURE_BINDING_2D,i.CULL_FACE):null,a=null!=r,u=null;a&&(n||(u=i.getParameter(i.VIEWPORT)),i.viewport(r.x,r.y,r.z,r.w));i.disable(i.CULL_FACE),i.bindBuffer(i.ARRAY_BUFFER,this.m_drawTexAryBuffer),this.m_drawTexBuffer.set(t?[-1,1,0,0,1,1,1,0,-1,-1,0,1,1,-1,1,1]:[-1,1,0,1,1,1,1,1,-1,-1,0,0,1,-1,1,0]),i.bufferData(i.ARRAY_BUFFER,this.m_drawTexBuffer,i.STREAM_DRAW);var s=this.m_drawTexProgram;i.useProgram(s.Program);var l=s.Attributes.aPosition,c=s.Attributes.aUV;i.vertexAttribPointer(l,2,i.FLOAT,!1,16,0),i.vertexAttribPointer(c,2,i.FLOAT,!1,16,8),i.enableVertexAttribArray(l),i.enableVertexAttribArray(c),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,e),i.uniform1i(s.Uniforms.uSampler,0),i.drawArrays(i.TRIANGLE_STRIP,0,4),null!=o&&this.restorePipeline(o),a&&(n||i.viewport(u[0],u[1],u[2],u[3]))}else console.log("draw tex init failed")},e.prototype.drawTexFullscreen=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),this.drawTex(e,t,n)},e.prototype.drawSampleRect=function(e,t,n,r,i,o){void 0===o&&(o=ge.one);var a=this.gl;if(this.drawTexCheckInit()){var u=e?this.savePipeline(a.ARRAY_BUFFER_BINDING,a.TEXTURE_BINDING_2D,a.CULL_FACE):null,s=a.getParameter(a.VIEWPORT),l=s[2],c=s[3],f=2*t/l-1,p=2*n/c-1,h=f+2*r/l,d=p+2*i/c;a.disable(a.CULL_FACE),a.bindBuffer(a.ARRAY_BUFFER,this.m_drawTexAryBuffer),this.m_drawTexBuffer.set([f,d,0,1,h,d,1,1,f,p,0,0,h,p,1,0]),a.bufferData(a.ARRAY_BUFFER,this.m_drawTexBuffer,a.STREAM_DRAW);var m=this.m_drawRectColorProgram;a.useProgram(m.Program);var y=m.Attributes.aPosition,v=m.Attributes.aUV;a.vertexAttribPointer(y,2,a.FLOAT,!1,16,0),a.vertexAttribPointer(v,2,a.FLOAT,!1,16,8),a.enableVertexAttribArray(y),a.enableVertexAttribArray(v),a.uniform4fv(m.Uniforms.uColor,o.raw),a.drawArrays(a.TRIANGLE_STRIP,0,4),null!=u&&this.restorePipeline(u)}else console.log("draw tex init failed")},e.prototype.savePipeline=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(h.bind.apply(h,[void 0,this.gl].concat(e)))},e.prototype.restorePipeline=function(e){null!=e&&e.restore(this.gl)},e}(),xe=function(){function e(){}return e.registerOnFrame=function(t){e.s_animationFrameRegisted||(window.requestAnimationFrame(e.onAnimationFrame),e.s_animationFrameRegisted=!0),e.s_animationFrameFunc.push(t)},e.removeOnFrame=function(t){var n=e.s_animationFrameFunc,r=n.indexOf(t);r>=0&&(e.s_animationFrameFunc=n.splice(r,1))},e.setTargetFPS=function(t){e.s_targetFPS=t,e.s_frameInterval=1e3/t},e.onAnimationFrame=function(t){var n=e.s_frameInterval,r=t-e.s_lastTime;if(r>=n){e.s_lastTime=t-r%n;for(var i=e.s_animationFrameFunc,o=0,a=i.length;o<a;o++)i[o](t)}window.requestAnimationFrame(e.onAnimationFrame)},e.HttpGet=function(e,t){return i(this,void 0,void 0,function(){return o(this,function(n){return[2,new Promise(function(n,r){var i=new XMLHttpRequest;i.responseType=t,i.onload=function(e){n("blob"==t||"arraybuffer"==t?i.response:i.responseText)},i.onerror=function(e){r(e.target)},i.open("GET",e,!0),i.send()})]})})},e.loadImage=function(e){return i(this,void 0,void 0,function(){return o(this,function(t){return null==e?[2,null]:[2,new Promise(function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=function(){n("image load failed")},r.src=e})]})})},e.s_animationFrameRegisted=!1,e.s_animationFrameFunc=[],e.s_lastTime=0,e.s_targetFPS=60,e.s_frameInterval=1e3/60,e}(),Se=function(){return function(){this.byteOffset=0,this.normalized=!1}}(),Pe=function(){return function(){}}(),Ae=function(){return function(){this.interpolation="LINEAR"}}(),Fe=function(){return function(){}}(),De=function(){return function(){}}(),Oe=function(){return function(){this.byteOffset=0}}(),Me=function(){return function(){}}(),Ce=function(){return function(){}}(),Ue=function(){return function(){}}(),Ie=function(){return function(){this.byteOffset=0}}(),Be=function(){return function(){this.emissiveFactor=[0,0,0],this.alphaMode="OPAQUE",this.doubleSided=!1}}(),ke=function(){return function(){}}(),Le=function(){return function(){this.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.rotation=[0,0,0,1],this.scale=[1,1,1],this.translation=[0,0,0]}}(),Ne=function(){return function(){this.texCoord=0,this.scale=1}}(),je=function(){return function(){this.texCoord=0,this.strength=1}}(),ze=function(){return function(){}}(),Xe=function(){return function(){this.baseColorFactor=[1,1,1,1],this.metallicFactor=1,this.roughnessFactor=1}}(),Ge=function(){return function(){}}(),Ve=function(){return function(){this.mode=4}}(),He=function(){return function(){this.wrapS=10497,this.wrapT=10497}}(),We=function(){return function(){}}(),Ye=function(){return function(){}}(),qe=function(){return function(){}}(),Qe=function(){return function(){}}(),Ke=function(){return function(){}}(),$e=function(){return function(){this.texCoord=0}}(),Je=function(){return function(){this.byteOffset=0}}(),Ze=function(){return function(){}}(),et=function(){return function(){}}(),tt=function(){function e(){}return e.fromBuffer=function(e){var t=new DataView(e,0,e.byteLength),n=0;if(1179937895==t.getUint32(0,!0)){var r=new et;n+=4;t.getUint32(n,!0);n+=4;t.getUint32(n);return n+=4,n=this.parseChunk(r,t,n),n=this.parseChunk(r,t,n),r}},e.parseChunk=function(e,t,n){var r=t.getUint32(n,!0);n+=4;var i=t.getUint32(n,!0),o=n+=4;if(1313821514==i){var a=String.fromCharCode.apply(null,new Uint8Array(t.buffer,o,r));e.gltf=JSON.parse(a)}else{if(5130562!=i)throw new Error("unknown chunk. ");var u=t.buffer.slice(o,o+r);e.rawBinary=u}return n+=r},e}(),nt=function(){function e(){}return e.LoadGLTF=function(e,t,n){return i(this,void 0,void 0,function(){return o(this,function(e){return[2,new Promise(function(e,t){})]})})},e.LoadGLTFBinary=function(e){return i(this,void 0,void 0,function(){return o(this,function(t){return[2,new Promise(function(t,n){xe.HttpGet(e,"arraybuffer").then(function(e){t(tt.fromBuffer(e))},function(e){n("load failed")})})]})})},e}()}.call(t,n(27))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,o,a,u,s=n(0);!function(e){e[e.Opaque=0]="Opaque",e[e.Transparent=1]="Transparent",e[e.Skybox=2]="Skybox",e[e.Image=3]="Image",e[e.Other=4]="Other"}(r=t.RenderQueue||(t.RenderQueue={})),function(e){e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS"}(i=t.Comparison||(t.Comparison={})),function(e){e[e.ADD=32774]="ADD",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.SUBTRACT=32778]="SUBTRACT",e[e.RESERVE_SUBSTRACT=32779]="RESERVE_SUBSTRACT"}(o=t.BlendOperator||(t.BlendOperator={})),function(e){e[e.ONE=1]="ONE",e[e.ZERO=0]="ZERO",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR"}(a=t.BlendFactor||(t.BlendFactor={})),function(e){e[e.Front=1028]="Front",e[e.Back=1029]="Back",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.None=2884]="None"}(u=t.CullingMode||(t.CullingMode={}));var l=function(){function e(){this.blend=!1}return e.prototype.clone=function(){var t=new e;return t.queue=this.queue,t.ztest=this.ztest,t.zwrite=this.zwrite,t.blendOp=this.blendOp,t.blendFactorDst=this.blendFactorDst,t.blendFactorSrc=this.blendFactorSrc,t.culling=this.culling,t},e.prototype.fillDefaultVal=function(){null==this.queue&&(this.queue=r.Opaque),null==this.zwrite&&(this.zwrite=!0),null==this.ztest&&(this.ztest=i.LEQUAL),null==this.culling&&(this.culling=u.Back),null==this.blendOp&&(this.blendOp=o.ADD),null==this.blendFactorSrc&&(this.blendFactorSrc=a.SRC_ALPHA),null==this.blendFactorDst&&(this.blendFactorDst=a.ONE_MINUS_SRC_ALPHA)},e}();t.ShaderTags=l;var c=function(){function e(){}return Object.defineProperty(e.prototype,"glProgram",{get:function(){return this.glprogram.Program},enumerable:!0,configurable:!0}),e}();t.ShaderProgram=c;var f=function(){return function(){}}();t.ShaderPass=f;var p=function(){function e(e,t,n,r){this.m_compiledPrograms={},this.m_source=e,this.m_defaultProgram=t,this.m_defaultOptionsConfig=n,this.m_compiledPrograms[n.hashCode]=t,this.m_glctx=r}return Object.defineProperty(e.prototype,"source",{get:function(){return this.m_source},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultProgram",{get:function(){return this.m_defaultProgram},enumerable:!0,configurable:!0}),e.prototype.getVariantProgram=function(t){if(null==t)throw new Error("optconfig is null");var n=t.hashCode,r=this.m_compiledPrograms[n];if(null!=r)return r;var i=this.source.injectCompileFlags(t.compileFlag),o=i[0],a=i[1],u=e.CreateProgram(this.m_glctx,o,a);if(null==u)throw new Error("compile program failed");return this.m_compiledPrograms[n]=u,console.log("program hash "+n),u},e.prototype.release=function(){this.m_glctx=null},e.ParseShaderInfo=function(e,t){for(var n=/ERROR: 0:([\d]+):/g,r=e.split(/\r\n|\r|\n/),i=null;null!==(i=n.exec(t));)console.error(r[Number(i[1])-1])},e.CreateProgram=function(t,n,r){var i=t.gl,o=i.createShader(i.VERTEX_SHADER);if(i.shaderSource(o,n),i.compileShader(o),!i.getShaderParameter(o,i.COMPILE_STATUS)){console.error(n);var a=i.getShaderInfoLog(o);return console.error("compile vertex shader failed: "+a),e.ParseShaderInfo(n,a),i.deleteShader(o),null}var u=i.createShader(i.FRAGMENT_SHADER);if(i.shaderSource(u,r),i.compileShader(u),!i.getShaderParameter(u,i.COMPILE_STATUS)){console.error(r);a=i.getShaderInfoLog(u);return console.error("compile fragment shader failed: "+a),e.ParseShaderInfo(r,a),i.deleteShader(u),null}var l=i.createProgram();if(i.attachShader(l,o),i.attachShader(l,u),i.linkProgram(l),!i.getProgramParameter(l,i.LINK_STATUS))return console.error("link shader program failed!:"+i.getProgramInfoLog(l)),i.deleteProgram(l),i.deleteShader(o),i.deleteShader(u),null;if(null==l)throw new Error("compile shader error");return new s.GLProgram(i,l)},e}();t.Shader=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),i=n(20),o=n(1),a=n(64),u=function(){function e(){}return e.registVariant=function(e){this.variants[e.variantName]=e},e.linkAllVariant=function(){var t=e.variants;for(var n in t){var i=t[n];null!=i&&i instanceof r.ShaderVariant&&i.link(t)}},e.getShader=function(){},e.compileShaders=function(t,n){if(e.s_variantsLinked||(e.linkAllVariant(),e.s_variantsLinked=!0),null==n)return null;if(n.buildShader(e.variants),!n.isBuilt)return null;var i=new r.ShaderOptionsConfig(n.optionsList),a=i.compileFlag,u=n.injectCompileFlags(a),s=u[0],l=u[1],c=o.Shader.CreateProgram(t,s,l);if(null==c)return null;var f=new o.Shader(n,c,i,t),p=n.tags;return null==p&&(p=new o.ShaderTags),p.fillDefaultVal(),f.tags=p,f},e.isInternalUniformBlockName=function(t){var n=e;return t==n.UNIFORM_BASIS||t==n.UNIFORM_OBJ||t==n.UNIFORM_SHADOWMAP},e.variants={},e.s_variantsLinked=!1,e.VARIANT_SHADERFX_OBJ="SHADERFX_OBJ",e.VARIANT_SHADERFX_CAMERA="SHADERFX_CAMERA",e.VARIANT_SHADERFX_BASIS="SHADERFX_BASIS",e.VARIANT_SHADERFX_LIGHT="SHADERFX_LIGHT",e.VARIANT_SHADERFX_SHADOWMAP="SHADERFX_SHADOWMAP",e.VARIANT_SHADERFX_LIGHTING="SHADERFX_LIGHTING",e.OPT_SHADOWMAP_SHADOW="SHADOW",e.OPT_SHADOWMAP_SHADOW_ON="ON",e.OPT_SHADOWMAP_SHADOW_OFF="OFF",e.ATTR_aPosition="aPosition",e.ATTR_aUV="aUV",e.ATTR_aNormal="aNormal",e.UNIFORM_BASIS="UNIFORM_BASIS",e.UNIFORM_OBJ="UNIFORM_OBJ",e.UNIFORM_LIGHT="UNIFORM_LIGHT",e.UNIFORM_SHADOWMAP="UNIFORM_SHADOWMAP",e.UNIFORM_SHADOWMAP_SAMPLER="uShadowMap",e.UNIFORM_MAIN_COLOR="uColor",e.UNIFORM_MAIN_TEXTURE="uSampler",e.GL_TEXTURE_FB=33984,e.GL_TEXTURE_DEPTH=33985,e.GL_TEXTURE_TEMP=33986,e.GL_TEXTURE_DEF_TEX=33987,e.GL_TEXTURE_FB_ID=0,e.GL_TEXTURE_TEMP_ID=2,e.GL_TEXTURE_DEF_TEX_ID=3,e.GL_SH_TEXTURE0=33988,e.GL_SH_TEXTURE1=33989,e.GL_SH_TEXTURE2=33990,e.GL_SH_TEXTURE3=33991,e.GL_SH_TEXTURE4=33992,e.GL_SH_TEXTURE5=33993,e.GL_SH_TEXTURE6=543760,e.GL_SH_TEXTURE7=543761,e.GL_SH_TEXTURE0_ID=4,e.GL_SH_TEXTURE1_ID=5,e.GL_SH_TEXTURE2_ID=6,e.GL_SH_TEXTURE3_ID=7,e.GL_SH_TEXTURE4_ID=8,e.GL_SH_TEXTURE5_ID=9,e.GL_SH_TEXTURE6_ID=10,e.GL_SH_TEXTURE7_ID=11,e.GL_SHADOWMAP_TEX0=33996,e.GL_SHADOWMAP_TEX1=33997,e.GL_SHADOWMAP_TEX2=33998,e.GL_SHADOWMAP_TEX3=33999,e.GL_SHADOWMAP_TEX0_ID=12,e.GL_SHADOWMAP_TEX1_ID=13,e.GL_SHADOWMAP_TEX2_ID=14,e.GL_SHADOWMAP_TEX3_ID=15,e}();t.ShaderFX=u,t.ShaderFile=function(e,t){return function(n,r){null==t&&(t=e),n[r]=function(e,t,n){var r=a.ShaderGen[e];if(null!=r)return i.ShaderSource.create(r,n);var o=a.ShaderGen[e+"_vs"],u=a.ShaderGen[t+"_ps"];if(null!=o&&null!=u)return new i.ShaderSource(o,u,n);throw new Error("shader source invalid : "+e+" "+t)}(e,t,r)}},t.ShaderInc=function(e){return function(t,n){var i=function(e){var t=a.ShaderGen[e];if(null==t)throw new Error("shader include invalid : "+e);return new r.ShaderVariant(e.toUpperCase(),t)}(e);t[n]=i,u.registVariant(i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.pipeline=e}return e.prototype.render=function(e){},e.prototype.release=function(){this.pipeline=null},e.Release=function(e){return e.release(),null},e}();t.RenderPass=r},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(11),a=n(2),u=function(){function e(e,t,n,r,i,a,u){void 0===n&&(n=!1),void 0===r&&(r=o.GL.LINEAR),void 0===i&&(i=o.GL.LINEAR),void 0===a&&(a=o.GL.CLAMP_TO_EDGE),void 0===u&&(u=o.GL.CLAMP_TO_EDGE),this.mipmap=!1,this.format=e,this.internalformat=t,this.mipmap=n,this.min_filter=r,this.mag_filter=i,this.wrap_s=a,this.wrap_t=u}return e.prototype.clone=function(){var t=Object.create(e.prototype);for(var n in this)t[n]=this[n];return t},e}();t.TextureCreationDesc=u;var s=function(){function e(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=0),this.m_raw=e,this.m_width=t,this.m_height=n,this.m_desc=null==r?null:r.clone()}return Object.defineProperty(e.prototype,"rawtexture",{get:function(){return this.m_raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.m_width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.m_height},enumerable:!0,configurable:!0}),e.prototype.release=function(e){},e.createTexture2D=function(t,n,r,i){var o=i.gl,u=o.createTexture();return o.activeTexture(a.ShaderFX.GL_TEXTURE_TEMP),o.bindTexture(o.TEXTURE_2D,u),o.texStorage2D(o.TEXTURE_2D,1,r.internalformat,t,n),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,r.mag_filter),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,r.min_filter),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,r.wrap_s),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,r.wrap_t),r.mipmap&&o.generateMipmap(o.TEXTURE_2D),o.bindTexture(o.TEXTURE_2D,null),new e(u,t,n,r)},e.prototype.resize=function(e,t,n){if(e!=this.m_width||t!=this.m_height){var r=n.gl;r.deleteTexture(this.m_raw);var i=this.m_desc,o=r.createTexture();r.activeTexture(a.ShaderFX.GL_TEXTURE_TEMP),r.bindTexture(r.TEXTURE_2D,o),r.texStorage2D(r.TEXTURE_2D,1,i.internalformat,e,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,i.mag_filter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,i.min_filter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,i.wrap_s),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,i.wrap_t),i.mipmap&&r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null),this.m_raw=o,this.m_width=e,this.m_height=t}},e.crateEmptyTexture=function(t,n,r){if(t<2||n<2)throw new Error("invalid texture size");var i=r.gl,o=i.createTexture();return i.activeTexture(e.TEMP_TEXID),i.bindTexture(i.TEXTURE_2D,o),i.texStorage2D(i.TEXTURE_2D,1,i.RGBA8,t,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.bindTexture(i.TEXTURE_2D,null),new e(o,t,n)},e.createTextureSync=function(t,n,r,i){var o=new Blob([t],{type:n}),a=URL.createObjectURL(o),u=new Image,s=new e(null);return u.onload=function(){var t=r.gl,n=t.createTexture();t.activeTexture(e.TEMP_TEXID),t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.RGB,t.RGB,t.UNSIGNED_BYTE,u),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null),s.m_width=u.width,s.m_height=u.height,s.m_raw=n,null!=i&&i(!0)},u.onerror=function(e){console.error(e),null!=i&&i(!1)},u.src=a,s},e.createTexture=function(t,n,o){return r(this,void 0,void 0,function(){return i(this,function(r){return[2,new Promise(function(r,i){var a=e.createTextureSync(t,n,o,function(e){e?r(a):i("failed")})})]})})},e}();t.Texture=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(0),o=n(11);!function(e){e[e.Triangles=4]="Triangles",e[e.TriangleFan=6]="TriangleFan",e[e.TriangleStrip=5]="TriangleStrip",e[e.Points=0]="Points",e[e.Lines=1]="Lines",e[e.LineStrip=3]="LineStrip",e[e.LineLoop=2]="LineLoop"}(r=t.MeshTopology||(t.MeshTopology={}));var a=function(){function e(e,t,n,r){void 0===r&&(r=0),this.offset=0,this.type=e,this.size=t,this.totalbytes=n,this.offset=0}return Object.defineProperty(e.prototype,"length",{get:function(){return this.totalbytes/this.size/c.TypeSize(this.type)},enumerable:!0,configurable:!0}),e}();t.MeshVertexAttrDesc=a;var u=function(){function e(){}return Object.defineProperty(e.prototype,"totalByteSize",{get:function(){var e=this.position.totalbytes;return null!=this.uv&&(e+=this.uv.totalbytes),null!=this.normal&&(e+=this.normal.totalbytes),e},enumerable:!0,configurable:!0}),e}();t.MeshVertexDesc=u;var s=function(){function e(e,t,n,i){void 0===e&&(e=r.Triangles),void 0===t&&(t=0),void 0===n&&(n=o.GL.UNSIGNED_SHORT),void 0===i&&(i=0),this.indiceCount=0,this.topology=e,this.indiceCount=t,this.type=n,this.offset=i,this.totalbytes=t*c.TypeSize(n)}return e.prototype.set=function(e,t,n,i){void 0===e&&(e=r.Triangles),void 0===t&&(t=0),void 0===n&&(n=o.GL.UNSIGNED_SHORT),void 0===i&&(i=0),this.topology=e,this.indiceCount=t,this.type=n,this.offset=i,this.totalbytes=t*c.TypeSize(n)},e}();t.MeshIndicesDesc=s;var l=function(){function e(e,t){void 0===t&&(t=!1),this.vertexDesc=new u,this.indiceDesc=new s,this.m_bufferInited=!1,this.m_seperatedBuffer=!1,this.name=e,this.m_seperatedBuffer=t}return Object.defineProperty(e.prototype,"dataPosition",{get:function(){return this.m_dataPosition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataUV",{get:function(){return this.m_dataUV},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataNormal",{get:function(){return this.m_dataNormal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataIndices",{get:function(){return this.m_dataIndices},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seperatedBuffer",{get:function(){return this.m_seperatedBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferInited",{get:function(){return this.m_bufferInited},enumerable:!0,configurable:!0}),e.prototype.setNormal=function(e,t,n){this.m_dataNormal=e,this.vertexDesc.normal=new a(t,n,e.byteLength)},e.prototype.setUV=function(e,t,n){this.m_dataUV=e,this.vertexDesc.uv=new a(t,n,e.byteLength)},e.prototype.setPosition=function(e,t,n){this.m_dataPosition=e,this.vertexDesc.position=new a(t,n,e.byteLength)},e.prototype.setIndices=function(e,t,n){this.m_dataIndices=e;var r=this.indiceDesc;r.indiceCount=e.length,r.topology=n,r.offset=0,r.type=t,r.totalbytes=e.byteLength},Object.defineProperty(e,"Quad",{get:function(){if(null!=e.s_quad)return e.s_quad;var t=new e;e.s_quad=t;var n=new Float32Array([-.5,-.5,0,1,.5,-.5,0,1,-.5,.5,0,1,.5,.5,0,1]),i=new Uint16Array([0,1,2,1,3,2]),u=new Float32Array([0,1,1,1,0,0,1,0]);t.m_dataPosition=n,t.m_dataUV=u,t.m_dataIndices=i,t.name="quad";var s=t.vertexDesc;return s.position=new a(o.GL.FLOAT,4,4*n.length),s.uv=new a(o.GL.FLOAT,2,4*u.length),t.indiceDesc.set(r.Triangles,i.length,o.GL.UNSIGNED_SHORT,0),t.calculateNormal(),t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Sphere",{get:function(){if(null!=e.s_sphere)return e.s_sphere;var t=new e("sphere");e.s_sphere=t;var n=Math.PI/16,i=-Math.PI/2+n,u=[],s=[];u.push(0,-1,0,1),s.push(.5,0);for(var l=1;l<16;l++){for(var c=Math.sin(i),f=Math.cos(i),p=0,h=1*l/16,d=0;d<=32;d++){var m=f*Math.cos(p),y=f*Math.sin(p);u.push(m,c,y,1),s.push(1*d/32,h),p+=n}i+=n}u.push(0,1,0,1),s.push(.5,1);var v=[];for(l=1;l<=32;l++)v.push(0,l,l+1);for(l=0;l<14;l++){var _=1+33*l,g=_+33;for(d=0;d<33;d++){var b=_+d,w=g+d;v.push(b,b+1,w+1,b,w+1,w)}}for(l=463;l<496;l++)v.push(496,l,l+1);var T=new Float32Array(u);t.m_dataPosition=T;var E=new Uint16Array(v);t.m_dataIndices=E;var R=new Float32Array(s);t.m_dataUV=R,t.m_dataNormal=T;var x=t.vertexDesc;return x.position=new a(o.GL.FLOAT,4,T.byteLength),x.normal=new a(o.GL.FLOAT,4,T.byteLength),x.uv=new a(o.GL.FLOAT,2,R.byteLength),t.indiceDesc.set(r.Triangles,v.length,o.GL.UNSIGNED_SHORT,0),t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Cube",{get:function(){if(null!=e.s_cube)return e.s_cube;var t=new e;e.s_cube=t;for(var n=new Float32Array([-1,1,1,1,1,1,1,1,-1,-1,1,1,1,-1,1,1,1,1,1,1,1,1,-1,1,1,-1,1,1,1,-1,-1,1,1,1,-1,1,-1,1,-1,1,1,-1,-1,1,-1,-1,-1,1,-1,1,-1,1,-1,1,1,1,-1,-1,-1,1,-1,-1,1,1,-1,1,-1,1,1,1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,1,1,-1,1,1,-1,-1,-1,1,1,-1,-1,1]),i=new Float32Array(48),u=0;u<6;u++)i.set([0,1,1,1,0,0,1,0],8*u);for(var s=[],l=0;l<6;l++){var c=4*l;s.push(c,c+1,c+2,c+1,c+3,c+2)}t.m_dataIndices=new Uint16Array(s),t.m_dataPosition=n,t.m_dataUV=i,t.name="cube";var f=t.vertexDesc;return f.position=new a(o.GL.FLOAT,4,4*n.length),f.uv=new a(o.GL.FLOAT,2,4*i.length),t.indiceDesc.set(r.Triangles,s.length,o.GL.UNSIGNED_SHORT,0),t.calculateNormal(),t},enumerable:!0,configurable:!0}),e.prototype.calculateNormal=function(){if(this.indiceDesc.topology==r.Triangles){this.m_dataNormal;var e=this.m_dataPosition;if(null!=e){var t=this.m_dataIndices;if(null!=t){for(var n=this.vertexDesc.position,u=n.totalbytes/c.TypeSize(n.type),s=new Float32Array(u),l=u/n.size,f=new Array(l),p=new Uint16Array(l),h=t.length/3,d=0;d<h;d++){var m=3*d,y=t[m],v=t[m+1],_=t[m+2],g=4*y,b=4*v,w=4*_,T=new i.vec3([e[g],e[g+1],e[g+2]]),E=new i.vec3([e[b],e[b+1],e[b+2]]),R=new i.vec3([e[w],e[w+1],e[w+2]]),x=i.vec3.Cross(T.sub(E),R.sub(E)).normalize;p[y]++,null==f[y]&&(f[y]=i.vec3.zero),f[y].add(x),p[v]++,null==f[v]&&(f[v]=i.vec3.zero),f[v].add(x),p[_]++,null==f[_]&&(f[_]=i.vec3.zero),f[_].add(x)}for(d=0;d<l;d++){var S=f[d].div(p[d]).raw;s.set([S[0],S[1],S[2],0],4*d)}this.m_dataNormal=s,this.vertexDesc.normal=new a(o.GL.FLOAT,4,4*s.length)}else console.warn("indices data is needed for normal calculation.")}else console.warn("vertices position is needed for normal calculation.")}else console.warn(r[this.indiceDesc.topology]+" is not supported.")},e.prototype.refreshMeshBuffer=function(e){if(!this.m_bufferInited){var t=e.gl,n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),this.bufferVertices=n;var r=this.vertexDesc.totalByteSize,i=new ArrayBuffer(r),o=new DataView(i,0,r),a=0,u=this.vertexDesc;null!=this.m_dataPosition&&(u.position.offset=a,a=c.copyBuffer(o,this.m_dataPosition,a),a=4*Math.ceil(a/4)),null!=this.m_dataUV&&(u.uv.offset=a,a=c.copyBuffer(o,this.m_dataUV,a),a=4*Math.ceil(a/4)),null!=this.m_dataNormal&&(u.normal.offset=a,a=c.copyBuffer(o,this.m_dataNormal,a),a=4*Math.ceil(a/4)),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null);var s=this.m_dataIndices;if(null!=s&&0!=s.length){var l=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,l),t.bufferData(t.ELEMENT_ARRAY_BUFFER,s,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),this.bufferIndices=l}this.m_bufferInited=!0}},e}();t.Mesh=l;var c=function(){function e(){}return e.copyBuffer=function(e,t,n){var r=n;if(t instanceof DataView){for(var i=0,o=(a=new Uint8Array(t.buffer,0,t.byteLength)).byteLength;i<o;i++)e.setUint8(r,a[i]),r++;return r}if(t instanceof ArrayBuffer){var a;for(i=0,o=(a=new Uint8Array(t,0,t.byteLength)).byteLength;i<o;i++)e.setUint8(r,a[i]),r++;return r}if(t instanceof Float32Array){for(i=0,o=t.length;i<o;i++)e.setFloat32(r,t[i],!0),r+=4;return r}if(t instanceof Uint16Array){for(i=0,o=t.length;i<o;i++)e.setUint16(r,t[i]),r+=2;return r}throw new Error("not implemented")},e.TypeSize=function(e){return e==o.GLConst.FLOAT||e==o.GLConst.UNSIGNED_INT?4:e==o.GLConst.SHORT||e==o.GLConst.UNSIGNED_SHORT?2:e==o.GLConst.BYTE||e==o.GLConst.UNSIGNED_BYTE?1:0},e.IndicesBufferFillQuad=function(e,t){var n=6*t;if(e.length<n)throw new Error("buffer size exceeded.");for(var r=0,i=0,o=0;o<t;o++)e[r]=i,e[r+1]=i+1,e[r+2]=i+2,e[r+3]=i,e[r+4]=i+2,e[r+5]=i+3,r+=6,i+=4},e}();t.MeshBufferUtility=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=function(){function e(e,t){this.castShadow=!0,this.mesh=e,this.material=t}return Object.defineProperty(e.prototype,"vertexArrayObj",{get:function(){return this.m_vao},enumerable:!0,configurable:!0}),e.prototype.release=function(e){null!=this.m_vao&&(e.gl.deleteVertexArray(this.m_vao),this.m_vao=null),this.mesh=null},e.prototype.refershVertexArray=function(t){if(null==this.m_vao){var n=this.mesh,r=this.material;if(null==r||null==r.program)throw new Error("material or program is null");this.m_vao=e.CreateVertexArrayObj(t,n,r.program)}},e.CreateVertexArrayObj=function(e,t,n){if(t.bufferInited||t.refreshMeshBuffer(e),null==n)throw new Error("program is null");var i=n.Attributes,o=t.vertexDesc,a=e.gl,u=a.createVertexArray();if(a.bindVertexArray(u),t.seperatedBuffer){if(null!=o.position)if(a.bindBuffer(a.ARRAY_BUFFER,t.bufferVertices),null!=(f=i[r.ShaderFX.ATTR_aPosition])){var s=o.position;a.vertexAttribPointer(f,s.size,a.FLOAT,!1,4*s.size,s.offset),a.enableVertexAttribArray(f)}if(null!=o.uv)if(a.bindBuffer(a.ARRAY_BUFFER,t.bufferUV),null!=(p=i[r.ShaderFX.ATTR_aUV])){var l=o.uv;a.vertexAttribPointer(p,l.size,a.FLOAT,!1,4*l.size,l.offset),a.enableVertexAttribArray(p)}if(o.normal)if(a.bindBuffer(a.ARRAY_BUFFER,t.bufferNormal),null!=(h=i[r.ShaderFX.ATTR_aNormal])){var c=o.normal;a.vertexAttribPointer(h,c.size,a.FLOAT,!1,4*c.size,c.offset),a.enableVertexAttribArray(h)}a.bindBuffer(a.ARRAY_BUFFER,null)}else{var f,p,h;if(a.bindBuffer(a.ARRAY_BUFFER,t.bufferVertices),null!=o.position)if(null!=(f=i[r.ShaderFX.ATTR_aPosition])){s=o.position;a.vertexAttribPointer(f,s.size,a.FLOAT,!1,4*s.size,s.offset),a.enableVertexAttribArray(f)}if(null!=o.uv)if(null!=(p=i[r.ShaderFX.ATTR_aUV])){l=o.uv;a.vertexAttribPointer(p,l.size,a.FLOAT,!1,4*l.size,l.offset),a.enableVertexAttribArray(p)}if(o.normal)if(null!=(h=i[r.ShaderFX.ATTR_aNormal])){c=o.normal;a.vertexAttribPointer(h,c.size,a.FLOAT,!1,4*c.size,c.offset),a.enableVertexAttribArray(h)}}return a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t.bufferIndices),a.bindVertexArray(null),u},e}();t.MeshRender=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i=n(4),o=n(2),a=function(){function e(e){null!=e&&(null==this.uniforms&&(this.uniforms={}),this.setProgram(e))}return e.prototype.setProgram=function(e){if(e!=this.m_program)if(null!=this.m_program){var t=e.UniformsInfo,n=this.uniforms;for(var r in n)null==t[r]&&delete n[r];for(var r in t){var i=n[r],a=t[r];null==i?n[r]={type:a.type,value:null}:i.type!=a.type&&(i.type=a.type,i.value=null)}var s=this.m_program,l=this.uniformsBlock,c=e.UniformBlock;if(null!=l)for(var f in l){var p=l[f],h=u.programGetUniformBlockName(s,p);if(null!=h){var d=c[h];null!=d&&(delete l[f],l[d]=p)}}for(var m in c)if(!o.ShaderFX.isInternalUniformBlockName(m)){g=s.UniformBlock[m];null[c[m]]=null!=g?l[g]:null}this.uniformsBlock=null,this.m_program=e}else{var y=e.UniformsInfo,v=this.uniforms;for(var _ in y){var g=y[_];v[_]={type:g.type,value:null}}this.m_program=e}},e.prototype.clone=function(){var t=new e(null);return t.m_program=this.m_program,t.uniforms=r.Utility.cloneMap(this.uniforms,function(e){return{type:e.type,value:e.value}}),t},e.prototype.getUniform=function(e){return this.uniforms[e]},e.prototype.release=function(){this.m_program=null,this.uniforms=null},e}();t.MaterialPorpertyBlock=a;var u=function(){function e(e){this.m_useVariants=!1,this.m_shadertags=null,this.m_applyTexCount=0,null!=e&&(this.m_shader=e,this.m_program=e.defaultProgram,this.m_optConfig=e.m_defaultOptionsConfig,this.m_propertyBlock=new a(this.m_program))}return Object.defineProperty(e.prototype,"program",{get:function(){if(null==this.m_program){var e=this.m_shader.getVariantProgram(this.m_optConfig);this.m_propertyBlock.setProgram(e),this.m_program=e}return this.m_program},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderTags",{get:function(){return null==this.m_shadertags?this.m_shader.tags:this.m_shadertags},set:function(e){this.m_shadertags=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertyBlock",{get:function(){return this.m_propertyBlock},enumerable:!0,configurable:!0}),e.prototype.setShader=function(e){this.m_shader=e,this.m_program=null,this.m_useVariants=!1},e.prototype.clone=function(){var t=new e;return t.m_shader=this.m_shader,t.m_program=this.program,t.m_propertyBlock=this.m_propertyBlock.clone(),t.m_useVariants=this.m_useVariants,t.m_optConfig=this.m_optConfig.clone(),t},e.prototype.setColor=function(e,t){var n=this.m_propertyBlock.getUniform(e);null!=n&&(n.value=t)},e.prototype.setTexture=function(e,t){var n=this.m_propertyBlock.getUniform(e);null!=n&&(n.value=t)},e.prototype.setFloat=function(e,t){var n=this.m_propertyBlock.getUniform(e);null!=n&&(n.value=t)},e.prototype.setVec2=function(e,t,n){var r=this.m_propertyBlock.getUniform(e);null!=r&&(r.value=[t,n])},e.prototype.setVec3=function(e,t){var n=this.m_propertyBlock.getUniform(e);null!=n&&(n.value=t.clone())},e.prototype.setVec4=function(e,t){var n=this.m_propertyBlock.getUniform(e);null!=n&&(n.value=t)},e.prototype.setUniformBlockwitName=function(e,t){var n=this.m_program.UniformBlock[e];if(null!=n){var r=this.m_propertyBlock,i=r.uniformsBlock;null==i&&(i={},r.uniformsBlock=i),i[n]=t}},e.prototype.setUniformBlock=function(e,t){var n=this.propertyBlock,r=n.uniformsBlock;null==r&&(r={},n.uniformsBlock=r),r[e]=t},e.prototype.getUniformBlockIndex=function(e){return this.m_program.UniformBlock[e]},e.prototype.getUniformBlockName=function(t){return e.programGetUniformBlockName(this.program,t)},e.programGetUniformBlockName=function(e,t){var n=e.UniformBlock;for(var r in n)if(n[r]==t)return r},e.prototype.setFlag=function(e,t,n){void 0===n&&(n=!1);var r=this.m_shader.m_defaultOptionsConfig;this.m_shader.m_defaultOptionsConfig.verifyFlag(e,t)?(this.m_useVariants||(this.m_optConfig=r.clone()),this.m_optConfig.setFlag(e,t)?(this.m_program=null,this.m_useVariants=!0):console.warn("set shader flag: value not changed"),n&&this.refreshProgram()):console.warn("set shader flag verify failed: "+e+":"+t)},e.prototype.refreshProgram=function(){return this.program},e.prototype.setFlagNoVerify=function(e){var t=this.m_useVariants,n=t?this.m_optConfig:this.m_shader.m_defaultOptionsConfig,r=n.getFlag(e.flag);null!=r&&r!=e.default&&(t||(this.m_optConfig=n.clone(),this.m_useVariants=!0),this.m_optConfig.setFlag(e.flag,e.default),this.m_program=null)},e.prototype.getFlag=function(e){return(this.m_useVariants?this.m_shader.m_defaultOptionsConfig:this.m_optConfig).getFlag(e)},e.prototype.apply=function(e){this.m_applyTexCount=0;var t=this.program,n=this.m_propertyBlock,r=n.uniforms;for(var i in r){var o=r[i];"uShadowMap"!==i&&this.setUniform(e,t.Uniforms[i],o.type,o.value)}var a=n.uniformsBlock;if(null!=a){var u=t.Program;for(var i in a){var s=Number(i);e.uniformBlockBinding(u,s,a[s])}}},e.prototype.clean=function(e){},e.prototype.setUniform=function(t,n,r,o){if(null!=o||r==t.SAMPLER_2D)switch(r){case t.FLOAT:t.uniform1f(n,o);break;case t.FLOAT_VEC2:t.uniform2fv(n,o);break;case t.FLOAT_VEC3:t.uniform3fv(n,o.raw);break;case t.FLOAT_VEC4:t.uniform4fv(n,o.raw);break;case t.SAMPLER_2D:var a=this.m_applyTexCount;if(null!=o){var u=null;if(o instanceof i.Texture?u=o.rawtexture:o instanceof WebGLTexture&&(u=o),null==u)return void t.uniform1i(n,e.DEF_TEXID_NUM);t.activeTexture(t.TEXTURE4+a),t.bindTexture(t.TEXTURE_2D,u),t.uniform1i(n,4+a)}else t.uniform1i(n,e.DEF_TEXID_NUM)}},e.DEF_TEXID_NUM=3,e}();t.Material=u},function(e,t,n){"use strict";t.c=function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},t.b=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},t.a=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},t.d=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(0)),r(n(28)),r(n(29)),r(n(12)),r(n(33)),r(n(32)),r(n(38)),r(n(39)),r(n(34)),r(n(41)),r(n(36)),r(n(35)),r(n(3)),r(n(16)),r(n(2)),r(n(1)),r(n(31)),r(n(15)),r(n(20)),r(n(19)),r(n(21)),r(n(42)),r(n(43)),r(n(13)),r(n(24)),r(n(23)),r(n(7)),r(n(5)),r(n(68)),r(n(22)),r(n(17)),r(n(25)),r(n(44)),r(n(45)),r(n(10)),r(n(69))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e){void 0===e&&(e=300),this.m_newEmit=!1,this.m_ondelay=!1,this.m_time=300,this.m_time}return Object.defineProperty(e.prototype,"delaytime",{set:function(e){this.m_time=e},enumerable:!0,configurable:!0}),e.prototype.emit=function(e){null!=e&&(this.m_f=e,1==this.m_ondelay?this.m_newEmit=!0:(this.m_newEmit=!1,this.m_ondelay=!0,this.delayExec()))},e.prototype.delayExec=function(){var e=this;setTimeout(function(){e.m_newEmit?(e.m_newEmit=!1,e.delayExec()):(e.m_f(),e.m_ondelay=!1)},this.m_time)},e}();t.Delayter=i;var o=function(){function e(){}return e.Hashfnv32a=function(e){for(var t=2166136261,n=0;n<e.length;++n)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0},e.cloneMap=function(e,t){if(null==e)return null;var n={};if(t)for(var r in e){var i=e[r];n[r]=t(i)}else for(var r in e)n[r]=e[r];return n},e.randomColor=function(){return r.glmath.vec4(Math.random(),Math.random(),Math.random(),1)},e.colorRGBA=function(e,t,n,i){return r.glmath.vec4(e,t,n,i).div(255)},e}();t.Utility=o;var a=function(){function e(){}return e.setOnResizeFunc=function(t){e.onResizeFunc=t,this.s_windowResizeRegisted||(e.s_windowResizeRegisted=!0,window.addEventListener("resize",e.onWindowResize))},e.onWindowResize=function(){var t=e.onResizeFunc;null!=t&&t()},e.s_windowResizeRegisted=!1,e}();t.WindowUtility=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT"}(t.GLConst||(t.GLConst={}));var r=function(){function e(){}return e.BYTE=5120,e.UNSIGNED_BYTE=5121,e.SHORT=5122,e.UNSIGNED_SHORT=5123,e.UNSIGNED_INT=5125,e.FLOAT=5126,e.NEAREST=9728,e.LINEAR=9729,e.NEAREST_MIPMAP_NEAREST=9984,e.LINEAR_MIPMAP_NEAREST=9985,e.NEAREST_MIPMAP_LINEAR=9986,e.LINEAR_MIPMAP_LINEAR=9987,e.TEXTURE_MAG_FILTER=10240,e.TEXTURE_MIN_FILTER=10241,e.TEXTURE_WRAP_S=10242,e.TEXTURE_WRAP_T=10243,e.TEXTURE_2D=3553,e.TEXTURE=5890,e.TEXTURE_CUBE_MAP=34067,e.TEXTURE_BINDING_CUBE_MAP=34068,e.TEXTURE_CUBE_MAP_POSITIVE_X=34069,e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,e.EXTURE_CUBE_MAP_NEGATIVE_Z=34074,e.MAX_CUBE_MAP_TEXTURE_SIZE=34076,e.ACTIVE_TEXTURE=34016,e.REPEAT=10497,e.CLAMP_TO_EDGE=33071,e.MIRRORED_REPEAT=33648,e}();t.GL=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15),i=n(65),o=n(32),a=n(16),u=n(66),s=n(3),l=n(2),c=n(5),f=n(6),p=n(7),h=function(){function e(){this.m_inited=!1,this.m_bufferDebugInfo=[],this.m_shadowMapData=new a.ShadowMapData,this.m_shadowEnabled=!1,this.m_nodelist=[new i.RenderNodeList,new i.RenderNodeList],this.m_nodelistIndex=0,this.m_mainFrameBufferBinded=!1,this.m_mainFrameBufferAspect=1,this.m_mainFrameBufferWidth=0,this.m_mainFrameBufferHeight=0,this.m_mainFrameBufferResized=!0,this.m_shaderDataScreenResized=!1,this.renderPassDebug=!1}return Object.defineProperty(e.prototype,"GLCtx",{get:function(){return this.glctx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GL",{get:function(){return this.gl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferDebugInfo",{get:function(){return this.m_bufferDebugInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainDepthTexture",{get:function(){return this.m_mainDepthTexture},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainDepthFrameBuffer",{get:function(){return this.m_mainDepthFB},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderDataBasis",{get:function(){return this.m_shaderDataBasis},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderDataObj",{get:function(){return this.m_shaderDataObj},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderDataLight",{get:function(){return this.m_shaderDataLight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderDataShadowMap",{get:function(){return this.m_shaderDataShadowMap},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadowMapData",{get:function(){return this.m_shadowMapData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nodeList",{get:function(){return this.m_nodelistCur},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainFrameBufferWidth",{get:function(){return this.m_mainFrameBufferWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainFrameBufferHeight",{get:function(){return this.m_mainFrameBufferHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainFrameBufferAspect",{get:function(){return this.m_mainFrameBufferAspect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainFrameBuffer",{get:function(){return this.m_mainFrameBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stateCache",{get:function(){return this.m_pipestateCache},enumerable:!0,configurable:!0}),e.prototype.onSetupRender=function(e,t){this.glctx=e,this.gl=e.gl,this.m_mainFrameBufferInfo=t,this.init()},e.prototype.init=function(){if(!this.m_inited){var e=this.glctx,t=this.m_mainFrameBufferInfo;this.m_pipestateCache=new u.PipelineStateCache(e);var n=this.glctx.createFrameBuffer(!0,t.colorFormat,t.depthFormat);this.m_mainFrameBuffer=n,this.m_mainFrameBufferWidth=n.width,this.m_mainFrameBufferHeight=n.height,this.m_mainFrameBufferAspect=n.width/n.height,this.createUniformBuffers(),this.m_passDebug=new o.PassDebug(this),null==this.m_fullscreenMat&&(this.m_fullscreenMat=new p.Material(this.graphicRender.shaderLib.shaderBlit)),null==this.m_fullscreenRender&&(this.m_fullscreenRender=new f.MeshRender(c.Mesh.Quad,this.m_fullscreenMat)),this.m_inited=!0}},e.prototype.createUniformBuffers=function(){var t=e,n=this.gl;if(null==this.m_uniformBufferObj){var i=new r.ShaderDataUniformObj;this.m_shaderDataObj=i;var o=n.createBuffer();n.bindBuffer(n.UNIFORM_BUFFER,o),n.bufferData(n.UNIFORM_BUFFER,i.fxbuffer.raw,n.DYNAMIC_DRAW),n.bindBufferBase(n.UNIFORM_BUFFER,t.UNIFORMINDEX_OBJ,o),this.m_uniformBufferObj=o}if(null==this.m_uniformBufferBasis){i=new r.ShaderDataBasis;this.m_shaderDataBasis=i;o=n.createBuffer();n.bindBuffer(n.UNIFORM_BUFFER,o),n.bufferData(n.UNIFORM_BUFFER,i.fxbuffer.raw,n.DYNAMIC_DRAW),n.bindBufferBase(n.UNIFORM_BUFFER,t.UNIFORMINDEX_BASIS,o),this.m_uniformBufferBasis=o}if(null==this.m_uniformBufferShadowMap){i=new r.ShaderDataUniformShadowMap;this.m_shaderDataShadowMap=i;o=n.createBuffer();n.bindBuffer(n.UNIFORM_BUFFER,o),n.bufferData(n.UNIFORM_BUFFER,i.fxbuffer.raw,n.DYNAMIC_DRAW),n.bindBufferBase(n.UNIFORM_BUFFER,t.UNIFORMINDEX_SHADOWMAP,o),this.m_uniformBufferShadowMap=o}if(null==this.m_uniformBufferLight){i=new r.ShaderDataUniformLight;this.m_shaderDataLight=i;o=n.createBuffer();n.bindBuffer(n.UNIFORM_BUFFER,o),n.bufferData(n.UNIFORM_BUFFER,i.fxbuffer.raw,n.DYNAMIC_DRAW),n.bindBufferBase(n.UNIFORM_BUFFER,t.UNIFORMINDEX_LIGHT,o),this.m_uniformBufferLight=o}console.log("create uniform buffers")},e.prototype.renderBufferDebug=function(){if(this.renderPassDebug){var e=this.m_passDebug;null!=e&&0!=this.m_bufferDebugInfo.length&&e.render()}},e.prototype.resizeFrameBuffer=function(e,t){var n=this.m_mainFrameBufferInfo;this.m_mainFrameBuffer=this.glctx.createFrameBuffer(!1,n.colorFormat,n.depthFormat,e,t,this.m_mainFrameBuffer),this.m_mainFrameBufferWidth=e,this.m_mainFrameBufferHeight=t,this.m_mainFrameBufferAspect=e/t,this.m_mainFrameBufferResized=!0,this.m_shaderDataScreenResized=!0},e.prototype.exec=function(e){},e.prototype.onRenderToCanvas=function(){this.gl.viewport(0,0,this.m_mainFrameBufferWidth,this.m_mainFrameBufferHeight),this.drawFullScreenTex(this.m_mainFrameBuffer.colorTex0)},e.prototype.updateShaderDataBasis=function(e,t){void 0===t&&(t=!0);var n=this.graphicRender,r=this.m_shaderDataBasis,i=r.render;i.setTime(n.time,this.graphicRender.deltaTime),this.m_shaderDataScreenResized&&(i.setScreenParam(this.mainFrameBufferWidth,this.mainFrameBufferHeight),this.m_shaderDataScreenResized=!1);var o=r.camrea;e.isDataTrsDirty&&(o.setCameraMtxView(e.WorldMatrix),o.setCameraPos(e.transform.position),e.isDataTrsDirty=!1),e.isDataProjDirty&&(o.setCameraMtxProj(e.ProjMatrix),o.setProjParam(e.near,e.far),e.isDataProjDirty=!1),t&&this.submitShaderDataBasis()},e.prototype.submitShaderDataBasis=function(){var e=this.m_shaderDataBasis,t=this.gl;e.submitBuffer(t,this.m_uniformBufferBasis)},e.prototype.updateUniformCamera=function(e,t){void 0===t&&(t=!1);var n=this.m_shaderDataBasis.camrea,r=e.transform;n.setCameraPos(r.position),n.setCameraMtxProj(e.ProjMatrix),n.setCameraMtxView(e.WorldMatrix),t&&this.submitShaderDataBasis()},e.prototype.updateUniformBufferObject=function(e){var t=this.gl;e.submitBuffer(t,this.m_uniformBufferObj)},e.prototype.updateUniformBufferShadowMap=function(e){var t=this.gl;e.submitBuffer(t,this.m_uniformBufferShadowMap)},e.prototype.updateUniformBufferLight=function(e){var t=this.gl;e.submitBuffer(t,this.m_uniformBufferLight)},e.prototype.activeDefaultTexture=function(){var e=this.gl;e.activeTexture(e.TEXTURE3),e.bindTexture(e.TEXTURE_2D,this.graphicRender.defaultTexture.rawtexture)},e.prototype.addBufferDebugInfo=function(e){var t=this.m_bufferDebugInfo;t.indexOf(e)>=0||t.push(e)},e.prototype.removeBufferDebugInfo=function(e){var t=this.m_bufferDebugInfo,n=t.indexOf(e);n<0||(t=t.splice(n,1))},e.prototype.bindTargetFrameBuffer=function(e){void 0===e&&(e=!1);var t=this.m_mainFrameBuffer;this.m_mainFrameBufferBinded&&!e||(t.bind(this.gl),this.m_mainFrameBufferBinded=!0,e=!0),(this.m_mainFrameBufferResized||e)&&(this.gl.viewport(0,0,t.width,t.height),this.m_mainFrameBufferResized=!1)},e.prototype.UnBindTargetFrameBuffer=function(){if(this.m_mainFrameBufferBinded){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),this.m_mainFrameBufferBinded=!1}},e.prototype.generateDrawList=function(e){var t=this.m_nodelistIndex,n=this.m_nodelist[t];return n.reset(),this.traversalRenderNode(n,e.transform),n.sort(),this.m_nodelistIndex=0==t?1:0,this.m_nodelistCur=n,n},e.prototype.traversalRenderNode=function(e,t){var n=t.children;if(null!=n)for(var r=0,i=n.length;r<i;r++){var o=n[r],a=o.gameobject;if(a.active){var u=a.render;null!=u&&null!=u.mesh&&e.pushRenderNode(u),this.traversalRenderNode(e,o)}}},e.prototype.uniformBindDefault=function(t){var n=e,i=l.ShaderFX.UNIFORM_BASIS,o=r.ShaderDataUniformObj.UNIFORM_OBJ,a=r.ShaderDataUniformLight.UNIFORM_LIGHT,u=l.ShaderFX.UNIFORM_SHADOWMAP,s=this.gl,c=t.UniformBlock,f=t.Program,p=c[i];null!=p&&s.uniformBlockBinding(f,p,n.UNIFORMINDEX_BASIS);var h=c[o];null!=h&&s.uniformBlockBinding(f,h,n.UNIFORMINDEX_OBJ);var d=c[a];null!=d&&s.uniformBlockBinding(f,d,n.UNIFORMINDEX_LIGHT);var m=c[u];if(null!=m){s.uniformBlockBinding(f,m,n.UNIFORMINDEX_SHADOWMAP);var y=t.Uniforms[l.ShaderFX.UNIFORM_SHADOWMAP_SAMPLER];null!=y&&s.uniform1i(y,l.ShaderFX.GL_SHADOWMAP_TEX0_ID)}},e.prototype.drawFullScreenTex=function(e){this.m_fullscreenMat.setTexture(l.ShaderFX.UNIFORM_MAIN_TEXTURE,e),this.drawMeshRender(this.m_fullscreenRender)},e.prototype.drawMeshWithMat=function(e,t,n,r,i){void 0===i&&(i=!0);var o=this.gl,a=t.program;o.useProgram(a.Program),i&&this.uniformBindDefault(a),t.apply(o);var u=this.m_shaderDataObj;if(null!=r&&(u.setMtxModel(r),this.updateUniformBufferObject(u)),null==n)throw new Error("vertex array obj is null!");o.bindVertexArray(n);var s=e.indiceDesc;o.drawElements(o.TRIANGLES,s.indiceCount,s.type,s.offset),o.bindVertexArray(null),t.clean(o)},e.prototype.drawMeshRender=function(e,t,n){void 0===n&&(n=!0);var r=this.gl,i=e.material,o=e.mesh;e.refershVertexArray(this.glctx);var a=i.program;r.useProgram(a.Program),n&&this.uniformBindDefault(a),i.apply(r);var u=this.m_shaderDataObj;null!=t&&(u.setMtxModel(t),this.updateUniformBufferObject(u));var s=e.vertexArrayObj;r.bindVertexArray(s);var l=o.indiceDesc;r.drawElements(r.TRIANGLES,l.indiceCount,l.type,l.offset),r.bindVertexArray(null),i.clean(r)},e.prototype.release=function(){if(this.m_inited){var e=this.glctx,t=e.gl;this.m_bufferDebugInfo=[],this.m_mainFrameBuffer.release(e),this.m_mainFrameBufferWidth=0,this.m_mainFrameBufferHeight=0,this.m_mainFrameBufferAspect=1,this.m_mainFrameBuffer=null,this.m_pipestateCache.release(),this.m_pipestateCache=null,t.deleteBuffer(this.m_uniformBufferBasis),t.deleteBuffer(this.m_uniformBufferLight),t.deleteBuffer(this.m_uniformBufferObj),t.deleteBuffer(this.m_uniformBufferShadowMap),this.m_uniformBufferBasis=null,this.m_uniformBufferLight=null,this.m_uniformBufferObj=null,this.m_uniformBufferShadowMap=null,this.m_shadowEnabled=!1,this.m_shadowMapData=new a.ShadowMapData;var n=this.m_passDebug;null!=n&&(this.m_passDebug=s.RenderPass.Release(n)),this.m_inited=!1}},e.prototype.reload=function(){this.release(),this.init()},e.UNIFORMINDEX_OBJ=0,e.UNIFORMINDEX_BASIS=1,e.UNIFORMINDEX_SHADOWMAP=2,e.UNIFORMINDEX_LIGHT=3,e.UNIFORMINDEX_SHADER=4,e}();t.PipelineBase=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),i=function(){function e(e){this.active=!0,this.name=e,this.transform=new r.Transform(this)}return Object.defineProperty(e.prototype,"render",{get:function(){return this.m_render},set:function(e){e.object=this,this.m_render=e},enumerable:!0,configurable:!0}),e.prototype.update=function(e){var t=this.components;if(null!=t)for(var n=0,r=t.length;n<r;n++){var i=t[n];null!=i.onUpdate&&i.onUpdate(e)}var o=this.transform.isDirty,a=this.transform.children;if(null!=a)for(n=0,r=a.length;n<r;n++){var u=a[n].gameobject;u.transform.setObjMatrixDirty(o),u.update(e)}},e.prototype.addComponent=function(e){var t=this.components;null==t&&(t=[],this.components=t),t.indexOf(e)>=0||(e.gameobject=this,null!=e.onStart&&e.onStart(),t.push(e))},e.prototype.getComponent=function(e){for(var t=this.components,n=0,r=t.length;n<r;n++)if(t[n]instanceof e)return t[n];return null},e.prototype.getChildByName=function(e){var t=this.transform.children;if(null==t)return null;for(var n=0,r=t.length;n<r;n++){var i=t[n].gameobject;if(i.name===e)return i;var o=i.getChildByName(e);if(null!=o)return o}return null},e}();t.GameObject=i},function(e,t,n){"use strict";e.exports=n(54)},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=n(0),u=n(31),s=function(){function e(e){this.glctx=e}return Object.defineProperty(e.prototype,"shaderUnlitColor",{get:function(){return null==this.m_unlitColor&&(this.m_unlitColor=o.ShaderFX.compileShaders(this.glctx,e.SH_unitColor)),this.m_unlitColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderUnlitTexture",{get:function(){return null==this.m_unlitTexture&&(this.m_unlitTexture=o.ShaderFX.compileShaders(this.glctx,e.SH_unlitTexture)),this.m_unlitTexture},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderUVvalue",{get:function(){return null==this.m_uvValue&&(this.m_uvValue=o.ShaderFX.compileShaders(this.glctx,e.SH_uvValue)),this.m_uvValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderDiffuse",{get:function(){return null==this.m_diffuse&&(this.m_diffuse=o.ShaderFX.compileShaders(this.glctx,e.SH_diffuse)),this.m_diffuse},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderSkybox",{get:function(){return null==this.m_skybox&&(this.m_skybox=o.ShaderFX.compileShaders(this.glctx,e.SH_skybox)),this.m_skybox},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderPbrMetallicRoughness",{get:function(){return null==this.m_pbrMetallicRoughness&&(this.m_pbrMetallicRoughness=o.ShaderFX.compileShaders(this.glctx,e.SH_pbrMetallicRoughness)),this.m_pbrMetallicRoughness},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderDepth",{get:function(){return null==this.m_depth&&(this.m_depth=o.ShaderFX.compileShaders(this.glctx,e.SH_depth)),this.m_depth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderShadowMap",{get:function(){return null==this.m_shadermap&&(this.m_shadermap=o.ShaderFX.compileShaders(this.glctx,e.SH_shadowmap)),this.m_shadermap},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderBlit",{get:function(){return null==this.m_blit&&(this.m_blit=o.ShaderFX.compileShaders(this.glctx,e.SH_blit)),this.m_blit},enumerable:!0,configurable:!0}),e.prototype.release=function(){},e.prototype.reload=function(){},e.SH_PBR_BaseColorFactor="uColor",e.SH_PBR_BaseColorTexture="uSampler",e.SH_PBR_MetallicFactor="uMetallic",e.SH_PBR_RoughnessFactor="uRoughness",e.SH_PBR_MetallicRoughnessTexture="uTexMetallicRoughness",e.SH_PBR_EmissiveFactor="uEmissive",e.SH_PBR_EmissiveTexture="uTexEmissive",i([o.ShaderFile("UnlitColor")],e,"SH_unitColor",void 0),i([o.ShaderFile("UnlitTexture")],e,"SH_unlitTexture",void 0),i([o.ShaderFile("uvValue")],e,"SH_uvValue",void 0),i([o.ShaderFile("diffuse")],e,"SH_diffuse",void 0),i([o.ShaderFile("skybox")],e,"SH_skybox",void 0),i([o.ShaderFile("pbrMetallicRoughness")],e,"SH_pbrMetallicRoughness",void 0),i([o.ShaderFile("depth")],e,"SH_depth",void 0),i([o.ShaderFile("shadowmap")],e,"SH_shadowmap",void 0),i([o.ShaderFile("blit")],e,"SH_blit",void 0),i([o.ShaderInc(o.ShaderFX.VARIANT_SHADERFX_BASIS)],e,"SHADERFX_BASIS",void 0),i([o.ShaderInc(o.ShaderFX.VARIANT_SHADERFX_LIGHT)],e,"SHADERFX_LIGHT",void 0),i([o.ShaderInc(o.ShaderFX.VARIANT_SHADERFX_LIGHTING)],e,"SHADERFX_LIGHTING",void 0),i([o.ShaderInc(o.ShaderFX.VARIANT_SHADERFX_SHADOWMAP)],e,"SHADERFX_SHADOWMAP",void 0),e}();t.ShaderFXLibs=s;var l=function(e){function t(){return e.call(this,64)||this}return r(t,e),t.prototype.setMtxModel=function(e){this.buffer.setMat4(0,e)},t.UNIFORM_OBJ="UNIFORM_OBJ",t}(u.ShaderData);t.ShaderDataUniformObj=l;var c=function(e){function t(){return e.call(this,144)||this}return r(t,e),t.prototype.setLightData=function(e,t,n){var r=32*n,i=this.buffer;i.setVec3(r,e),i.setFloat(r+12,t)},t.prototype.setLightColorIntensity=function(e,t,n){var r=32*n+16,i=this.buffer;i.setVec3(r,e),i.setFloat(r+12,t)},t.prototype.setAmbientColor=function(e){this.buffer.setVec4(128,e)},t.UNIFORM_LIGHT="UNIFORM_LIGHT",t}(u.ShaderData);t.ShaderDataUniformLight=c;var f=function(e){function t(){return e.call(this,260)||this}return r(t,e),t.prototype.setLightMtx=function(e,t){this.buffer.setMat4(64*t,e)},t.prototype.setShadowDistance=function(e){},t.prototype.setCascadeCount=function(e){},t}(u.ShaderData);t.ShaderDataUniformShadowMap=f;var p=function(e){function t(){var t=e.call(this,304)||this;return t.render=new h(t),t.camrea=new d(t),t.ambientfog=new m(t),t}return r(t,e),t.prototype.updateDataBasic=function(e){e.isSeperated&&(this.buffer.setOfSubData(e),e.setDirty=!1)},t.prototype.updateDataCamera=function(e){e.isSeperated&&(this.buffer.setOfSubData(e),e.setDirty=!1)},t.prototype.updateDateAmbeintFog=function(e){e.isSeperated&&(this.buffer.setOfSubData(e),e.setDirty=!1)},t.prototype.submitBuffer=function(t,n){this.buffer.offsetMin,this.buffer.offsetMax;return e.prototype.submitBuffer.call(this,t,n)},t}(u.ShaderData);t.ShaderDataBasis=p;var h=function(e){function t(t){return e.call(this,t,32,0)||this}return r(t,e),t.prototype.setScreenParam=function(e,t){this.view.setVec4(0,new a.vec4([e,t,1/e,1/t]))},t.prototype.setTime=function(e,t){this.view.setVec4(16,new a.vec4([e,t,Math.sin(e),Math.cos(e)]))},t}(u.ShaderSubData);t.ShaderDataRender=h;var d=function(e){function t(t){return e.call(this,t,224,32)||this}return r(t,e),t.prototype.setProjParam=function(e,t){this.view.setVec4(80,new a.vec4([e,t,1/e,1/t]))},t.prototype.setCameraPos=function(e){this.view.setVec3(0,e)},t.prototype.setCameraMtxView=function(e){this.view.setMat4(16,e)},t.prototype.setCameraMtxProj=function(e,t){var n=this.view;n.setMat4(96,e),null==t?n.setMat4(160,e.inverse()):n.setMat4(160,t)},t}(u.ShaderSubData);t.ShaderDataCamera=d;var m=function(e){function t(t){return e.call(this,t,48,256)||this}return r(t,e),t.prototype.setAmbientColor=function(e){this.view.setVec4(0,e)},t.prototype.setFogColor=function(e){this.view.setVec4(16,e)},t.prototype.setFogParam=function(e){this.view.setVec4(32,e)},t}(u.ShaderSubData);t.ShaderDataAmbientFog=m},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NoCascade=1]="NoCascade",e[e.TwoCascade=2]="TwoCascade",e[e.FourCascade=4]="FourCascade"}(r=t.ShadowCascade||(t.ShadowCascade={}));var i=function(){function e(){this.shadowmapSize=1024,this.cascade=r.NoCascade,this.shadowDistance=40,this.cascadeSplit=e.CASCADE_SPLIT_NONE}return e.CASCADE_SPLIT_TWO_CASCADE=[.333,.667],e.CASCADE_SPLIT_FOUR_CASCADE=[.067,.133,.266,.534],e.CASCADE_SPLIT_NONE=[1],e}();t.ShadowConfig=i;var o=function(){return function(){}}();t.ShadowMapData=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return Object.defineProperty(e.prototype,"transform",{get:function(){return this.gameobject.transform},enumerable:!0,configurable:!0}),e}();t.Component=r},function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,a,u=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),s=1;s<arguments.length;s++){for(var l in n=Object(arguments[s]))i.call(n,l)&&(u[l]=n[l]);if(r){a=r(n);for(var c=0;c<a.length;c++)o.call(n,a[c])&&(u[a[c]]=n[a[c]])}}return u}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(10),u=n(30),s=function(){function e(e,t){this.includes=[],this.linked=!1,this.options=[],this.variantName=e,this.process(e,t)}return e.load=function(t,n){return r(this,void 0,void 0,function(){var a=this;return i(this,function(u){return null==t||""===t?[2,null]:[2,new Promise(function(u,s){return r(a,void 0,void 0,function(){var r,a;return i(this,function(i){switch(i.label){case 0:return[4,o.GLUtility.HttpGet(t,"text")];case 1:return r=i.sent(),a=new e(n,r),u(a),[2]}})})})]})})},Object.defineProperty(e.prototype,"sources",{get:function(){return this.m_sources},enumerable:!0,configurable:!0}),e.prototype.link=function(e){if(!this.linked){var t=this.includes;if(0==t.length)this.linked=!0;else{for(var n=0,r=t.length;n<r;n++){var i=t[n],o=e[i.key];if(null==o)throw new Error("can't find variant : ["+i.key+"]");if(o.linked||o.link(e),!o.linked)throw new Error("variance ["+o.variantName+"] link: failed");this.lines[i.line]=o.sources}this.linked=!0}this.m_sources=this.lines.join("\n")}},e.prototype.process=function(e,t){for(var n=(t="\n        #ifndef "+e+"\n        #define "+e+"\n        "+t+"\n        #endif\n        ").split("\n"),r=0,i=n.length;r<i;r++){var o=n[r],a=u.ShaderPreprocessor.processVariantInclude(o,r);if(null==a){var s=u.ShaderPreprocessor.processOptions(o);null==s||(n[r]=s[0],this.options.push(s[1]))}else this.includes.push(a)}this.lines=n},e}();t.ShaderVariant=s;var l=function(){return function(e,t){this.flag=e,this.default=t}}();t.ShaderOptions=l;var c=function(){function e(e){if(this.m_hashCode=0,this.m_dirty=!1,this.m_optmap={},null!=e){this.m_options=e;for(var t=this.m_optmap,n=0,r=e.length;n<r;n++){var i=e[n];t[i.flag]=i.default}this.compileOptions()}}return e.prototype.getFlag=function(e){return this.m_optmap[e]},e.prototype.verifyFlag=function(e,t){if(null==this.m_optmap[e])return console.warn("invalid shader option flag: ["+e+"]"),!1;for(var n=this.m_options,r=0,i=n.length;r<i;r++){var o=n[r];if(o.flag===e)return o.values.indexOf(t)>=0||(console.warn("invalid shader option value : ["+e+": "+t+"]"),!1)}},e.prototype.setFlag=function(e,t){return this.m_optmap[e]=t,this.m_dirty=!0,!0},Object.defineProperty(e.prototype,"hashCode",{get:function(){return this.m_dirty&&this.compileOptions(),this.m_hashCode},enumerable:!0,configurable:!0}),e.prototype.compileOptions=function(){this.m_dirty=!1;var e="",t=[],n=this.m_optmap;for(var r in n){var i=n[r];if(null==i)throw new Error("shader flag is null ["+r+"]");var o=" "+r+"_"+i;t.push(o),e+="#define "+o+"\n"}this.m_compileFlags=e,this.calculateHashCode(t)},e.prototype.calculateHashCode=function(e){e.sort(),this.m_hashCode=a.Utility.Hashfnv32a(e.join(" "))},Object.defineProperty(e.prototype,"compileFlag",{get:function(){return this.m_dirty&&this.compileOptions(),this.m_compileFlags},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.m_hashCode=this.m_hashCode,t.m_dirty=this.m_dirty,t.m_options=this.m_options,t.m_compileFlags=this.m_compileFlags,t.m_optmap=a.Utility.cloneMap(this.m_optmap),t},e}();t.ShaderOptionsConfig=c},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=n(30),u=n(0),s=function(){function e(e,t,n){this.m_built=!1,this.m_shaderTag=null,this.optionsList=[],this.ps=t,this.vs=e,this.name=n}return e.create=function(t,n){var r=a.ShaderPreprocessor.processUnifiedSource(t,n);return new e(r[0],r[1],n)},e.load=function(t,n){return r(this,void 0,void 0,function(){var o=this;return i(this,function(a){return null==t||""===t?[2,null]:[2,new Promise(function(a,s){return r(o,void 0,void 0,function(){var r,o;return i(this,function(i){switch(i.label){case 0:return[4,u.GLUtility.HttpGet(t,"text")];case 1:return r=i.sent(),o=e.create(r,n),a(o),[2]}})})})]})})},Object.defineProperty(e.prototype,"isBuilt",{get:function(){return this.m_built},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertex",{get:function(){return this.vs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pixel",{get:function(){return this.ps},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tags",{get:function(){return this.m_shaderTag},enumerable:!0,configurable:!0}),e.prototype.buildShader=function(e){if(this.m_built)return!0;var t=this.ProcessShader(this.vs,e),n=this.ProcessShader(this.ps,e);return this.ps=n,this.vs=t,this.m_built=!0,!0},e.prototype.addVariant=function(e){if(null==this.variants)return this.variants=[],this.variants.push(e),!0;var t=this.variants;return t.indexOf(e)<0&&(t.push(e),!0)},e.prototype.addOptions=function(e){var t=e.options;if(null!=t)for(var n=this.optionsList,r=0,i=t.length;r<i;r++)n.push(t[r])},e.prototype.ProcessShader=function(e,t){for(var n=e.split("\n"),r=0,i=n.length;r<i;r++){var o=n[r],u=a.ShaderPreprocessor.processSourceInclude(o,t);if(null==u){var s=a.ShaderPreprocessor.processOptions(o);null==s?n[r]=this.processShaderTag(o):(n[r]=s[0],this.optionsList.push(s[1]))}else{n[r]=u[0];var l=u[1];this.addVariant(l)&&this.addOptions(t[l])}}return n.join("\n").trim()},e.prototype.processShaderTag=function(e){e=e.trim();var t=this.m_shaderTag,n=e.match(/#(ztest|zwrite|queue) ([\w]+)/);if(null!=n){null==t&&(t=new o.ShaderTags,this.m_shaderTag=t);var r=n[1].toLowerCase(),i=n[2].toUpperCase();switch(r){case"ztest":this.setShaderTagProperty("ztest",i,o.Comparison);break;case"zwrite":var a="OFF"===i?0:"ON"===i?1:-1;if(-1==a)throw new Error("invalid zwrite tag ["+n[2]+"]");var u=1==a;if(null!=t.zwrite&&t.zwrite!=u)throw new Error("zwrite tag conflict");t.zwrite=u;break;case"queue":i=i.charAt(0).toUpperCase()+n[2].slice(1),this.setShaderTagProperty("queue",i,o.RenderQueue);break;case"cull":var s=o.CullingMode.Back;switch(i){case"ALL":s=o.CullingMode.FRONT_AND_BACK;break;case"BACK":s=o.CullingMode.Back;break;case"FRONT":s=o.CullingMode.Front;break;case"NONE":s=o.CullingMode.None;break;default:throw new Error("invalid culling mode")}if(null==t.culling)t.culling=s;else if(t.culling!=s)throw new Error("culling mode confliect : "+s+" "+t.culling);default:throw new Error("unknown shader tag ["+e+"]")}e=""}if(null!=(n=e.match(/#blend ([\w]+) ([\w]+)[\s]*([\w]+)*/))){null==t&&(t=new o.ShaderTags,this.m_shaderTag=t);var l=n[1].toUpperCase(),c=n[2].toUpperCase(),f=n[3].toLocaleUpperCase();if(null==f)f="ADD";else if(null==o.BlendOperator[f])throw new Error("invalid blend operator ["+f+"]");var p=o.BlendFactor[l],h=o.BlendFactor[c];if(null==p)throw new Error("invalid blend factor ["+n[1]+"]");if(null==h)throw new Error("invalid blend factor ["+n[2]+"]");var d=o.BlendFactor[f];if(null!=t.blendOp&&(t.blendOp!=d||t.blendFactorDst!=h||t.blendFactorSrc!=p))throw new Error("bleng tag conflict ["+e+"]");t.blendOp=d,t.blendFactorSrc=p,t.blendFactorDst=h,e=""}return e},e.prototype.setShaderTagProperty=function(e,t,n){var r=this.m_shaderTag,i=n[t];if(void 0==i)throw new Error("invalid "+e+" tag ["+t+"]");if(null==r[e])r[e]=i;else if(r[e]!=i)throw new Error(e+" tag conflict ["+o.Comparison[r[e]]+"] ["+t+"]")},e.prototype.injectCompileFlags=function(e){var t="#version 300 es\n",n=this.vs,r=this.pixel;return[n=n.startsWith(t)?t+"#define SHADER_VS\r\n"+e+n.slice(15):t+"#define SHADER_VS\r\n"+e+n,r=r.startsWith(t)?t+"#define SHADER_PS\r\n"+e+r.slice(15):t+"#define SHADER_PS\r\n"+e+r]},e}();t.ShaderSource=s},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i,o,a,u=n(0),s=n(13),l=n(17);!function(e){e[e.Background=0]="Background",e[e.AmbientColor=1]="AmbientColor"}(i=t.AmbientType||(t.AmbientType={})),function(e){e[e.Background=0]="Background",e[e.Skybox=1]="Skybox"}(o=t.ClearType||(t.ClearType={})),function(e){e[e.perspective=0]="perspective",e[e.orthographic=1]="orthographic"}(a=t.ProjectionType||(t.ProjectionType={}));var c=function(e){function t(){var t=e.call(this)||this;return t.enabled=!0,t.order=0,t.m_fov=60,t.m_projDirty=!1,t.orthosize=10,t.m_worldMtxCalculated=!1,t.m_background=u.vec4.zero,t.m_ambientColor=u.glmath.vec4(.1,.1,.1,1),t.m_ambientType=i.AmbientColor,t.m_clearType=o.Background,t.m_dataTrsDirty=!0,t.m_dataProjDirty=!0,t.ambientDataDirty=!0,t.worldRHS=!0,t.m_projMtx=u.mat4.perspectiveFoV(60,1,.01,100),t.m_projectionType=a.perspective,t}return r(t,e),Object.defineProperty(t.prototype,"isDataTrsDirty",{get:function(){return this.m_dataTrsDirty||this.transform.isDirty},set:function(e){this.m_dataTrsDirty=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDataProjDirty",{get:function(){return this.m_dataProjDirty},set:function(e){this.m_dataProjDirty=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"far",{get:function(){return this.m_far},set:function(e){this.m_far!=e&&(this.m_far=e,this.m_projDirty=!0,this.m_dataProjDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"near",{get:function(){return this.m_near},set:function(e){this.m_near!=e&&(this.m_near=e,this.m_projDirty=!0,this.m_dataProjDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fov",{get:function(){return this.m_fov},set:function(e){this.m_fov!=e&&(this.m_fov=e,this.m_projDirty=!0,this.m_dataProjDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aspect",{get:function(){return this.m_aspectratio},set:function(e){e!=this.m_aspectratio&&(this.m_aspectratio=e,this.m_projDirty=!0,this.m_dataProjDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ambientColor",{get:function(){return this.m_ambientColor},set:function(e){this.m_ambientColor=e,this.ambientDataDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this.m_background},set:function(e){this.m_background=e,this.m_ambientType==i.Background&&(this.ambientDataDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skybox",{get:function(){return this.m_skybox},set:function(e){this.m_skybox=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clearType",{get:function(){return this.m_clearType},set:function(e){this.m_clearType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ambientType",{get:function(){return this.m_ambientType},set:function(e){this.m_ambientType!=e&&(this.m_ambientType=e,this.ambientDataDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"WorldMatrix",{get:function(){var e=this.transform;return!this.m_worldMtxCalculated&&e.isDirty&&(this.m_worldMtx=u.mat4.coordCvt(e.position,e.worldForward,e.worldUp),this.m_dataTrsDirty=!0,this.m_worldMtxCalculated=!0),this.m_worldMtx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ProjMatrix",{get:function(){return this.m_projDirty&&(this.m_projMtx=u.mat4.perspectiveFoV(this.m_fov,this.m_aspectratio,this.m_near,this.m_far),this.m_projDirty=!1,this.m_dataProjDirty=!0),this.m_projMtx},enumerable:!0,configurable:!0}),t.prototype.onUpdate=function(e){e.mainCamera=this,this.m_worldMtxCalculated=!1},t.persepctive=function(e,n,r,i,o){var l=new t;l.m_fov=n,l.m_aspectratio=r,l.m_near=i,l.m_far=o,null==e&&(e=new s.GameObject),e.addComponent(l),l.m_projMtx=u.mat4.perspectiveFoV(n,r,i,o),l.m_projectionType=a.perspective;var c=e.transform;return l.m_worldMtx=u.mat4.coordCvt(c.localPosition,c.worldForward,c.worldUp),l},t.orthographic=function(e,n,r,i,o){var l=new t;l.m_aspectratio=r,l.m_near=i,l.m_far=o,null==e&&(e=new s.GameObject),e.addComponent(l),l.orthosize=n;var c=n*r;l.m_projMtx=u.mat4.orthographic(c,n,i,o),l.m_projectionType=a.orthographic;var f=e.transform;return l.m_worldMtx=u.mat4.coordCvt(f.localPosition,f.worldForward,f.worldUp),l},t}(l.Component);t.Camera=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(e){this.m_localPosition=r.vec3.zero,this.m_localRotation=r.quat.Identity,this.m_localScale=r.vec3.one,this.m_worldPositon=r.vec3.zero,this.m_worldRotation=r.quat.Identity,this.m_worldScale=r.vec3.one,this.m_localTRSdirty=!0,this.m_TRSDirty=!1,this.m_needDecompose=!1,this.m_frameTRSDirty=!1,this.m_localMtx=r.mat4.Identity,this.m_objMtx=r.mat4.Identity,this.m_right=r.vec3.right,this.m_forward=r.vec3.forward,this.m_up=r.vec3.up,this.m_gameobj=e}return Object.defineProperty(e.prototype,"gameobject",{get:function(){return this.m_gameobj},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.m_parent},set:function(e){if(null==e){var t=this.m_parent;null!=t&&t.removeChild(this)}else e.addChild(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localMatrix",{get:function(){return 1==this.m_localTRSdirty&&(this.m_localMtx.setTRS(this.localPosition,this.localRotation,this.localScale),this.m_localTRSdirty=!1,this.m_TRSDirty=!0),this.m_localMtx},set:function(e){this.m_localTRSdirty=!1,this.m_localMtx=e,r.mat4.DecomposeTRS(e,this.m_localPosition,this.m_localRotation,this.m_localScale),this.m_TRSDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"objMatrix",{get:function(){return this.calObjMatrix(),this.m_objMtx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"worldToLocalMatrix",{get:function(){return null==this.m_objMtxInv&&(this.m_objMtxInv=this.objMatrix.inverse()),this.m_objMtxInv},enumerable:!0,configurable:!0}),e.prototype.calObjMatrix=function(e){if(void 0===e&&(e=!1),this.m_TRSDirty){if(null==this.parent)this.m_objMtx.set(this.localMatrix),this.m_worldPositon=this.m_localPosition.clone(),this.m_worldRotation=this.m_localRotation.clone(),this.m_worldScale=this.m_localScale.clone(),this.m_needDecompose=!1;else{var t=this.parent.objMatrix.mul(this.localMatrix);this.m_objMtx.set(t),this.m_needDecompose=!0}this.m_objMtxInv=null,this.m_TRSDirty=!1}if(e&&this.m_needDecompose){var n=r.vec3.zero,i=new r.mat3;r.mat4.DecomposeAffine(this.m_objMtx,this.m_worldPositon,i,this.m_worldScale,n),this.m_worldRotation=r.quat.MtxToQuat(i),this.m_needDecompose=!1}},Object.defineProperty(e.prototype,"position",{get:function(){return this.calObjMatrix(!0),this.m_worldPositon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.calObjMatrix(!0),this.m_worldRotation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lossyScale",{get:function(){return this.calObjMatrix(!0),this.m_localScale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.m_children},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localRotation",{get:function(){return this.m_localRotation},set:function(e){this.setRotation(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localPosition",{get:function(){return this.m_localPosition},set:function(e){this.setPosition(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localScale",{get:function(){return this.m_localScale},set:function(e){this.setScale(e)},enumerable:!0,configurable:!0}),e.prototype.setRotation=function(e){this.m_localRotation.set(e),this.m_forward=null,this.m_up=null,this.m_right=null,this.m_localTRSdirty=!0,this.m_TRSDirty=!0},e.prototype.setPosition=function(e){this.m_localPosition.set(e),this.m_localTRSdirty=!0,this.m_TRSDirty=!0},e.prototype.setScale=function(e){this.m_localScale.set(e),this.m_localTRSdirty=!0,this.m_TRSDirty=!0},Object.defineProperty(e.prototype,"worldForward",{get:function(){return this.rotation.rota(r.vec3.forward)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"worldUp",{get:function(){return this.rotation.rota(r.vec3.up)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"worldRight",{get:function(){return this.rotation.rota(r.vec3.right)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"forward",{get:function(){return null==this.m_forward&&(this.m_forward=this.m_localRotation.rota(r.vec3.forward)),this.m_forward},set:function(e){var t=e.length;if(0!=t){var n=e.divToRef(t),i=this.up,o=r.vec3.SafeCross(n,i).normalize;i=n.cross(o).normalize,this.m_localRotation=r.quat.Coordinate(n,i),this.m_forward=n,this.m_up.set(i),this.m_right=o,this.m_localTRSdirty=!0,this.m_TRSDirty=!0}else console.warn("can not set forward to "+e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"up",{get:function(){return null==this.m_up&&(this.m_up=this.m_localRotation.rota(r.vec3.up)),this.m_up},set:function(e){var t=e.length;if(0!=t){var n=e.divToRef(t),i=r.vec3.SafeCross(n,this.forward).normalize,o=i.cross(n).normalize;this.m_localRotation=r.quat.Coordinate(o,n),this.m_up=n,this.m_forward.set(o),this.m_right=i,this.m_localTRSdirty=!0,this.m_TRSDirty=!0}else console.warn("can not set up to "+e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return null==this.m_right&&(this.m_right=this.m_localRotation.rota(r.vec3.right)),this.m_right},set:function(e){var t=e.length;if(0!=t){var n=e.divToRef(t),i=r.vec3.SafeCross(n,this.up).normalize,o=i.cross(n);this.m_localRotation=r.quat.Coordinate(i,o),this.m_up.set(o),this.m_forward=i,this.right=n,this.m_localTRSdirty=!0,this.m_TRSDirty=!0}else console.warn("can not set up to "+e)},enumerable:!0,configurable:!0}),e.prototype.addChild=function(e){if(null==e)return!1;var t=this.m_children;return null==t&&(t=[],this.m_children=t),t.indexOf(e)>=0||(e.m_parent=this,t.push(e),!0)},e.prototype.removeChild=function(e){var t=this.m_children;if(null==t)return!1;var n=t.indexOf(e);return!(n<0)&&(e.m_parent=null,this.m_children=t.splice(n,1),!0)},e.prototype.setLocalDirty=function(e){void 0===e&&(e=!0),e!=this.m_localTRSdirty&&(this.m_localTRSdirty=e,e?this.m_TRSDirty=!0:this.localMatrix)},e.prototype.setObjMatrixDirty=function(e){var t=this.m_TRSDirty||e;this.m_frameTRSDirty=t,t&&(this.m_TRSDirty=!0,this.calObjMatrix(!1))},Object.defineProperty(e.prototype,"isDirty",{get:function(){return this.m_localTRSdirty||this.m_frameTRSDirty},enumerable:!0,configurable:!0}),e.prototype.setLookAt=function(e,t){this.m_localTRSdirty=!0,this.setLookDir(e.subToRef(this.m_localPosition),t)},e.prototype.setLookDir=function(e,t){this.m_localTRSdirty=!0;var n=e.normalized();null==t&&(t=this.up);var i=r.vec3.SafeCross(t,n).normalize,o=n.cross(i).normalize;this.m_up.set(o),this.m_right=i,this.m_forward=n,this.m_localRotation=r.quat.Coordinate(n,o)},e.prototype.applyTranslate=function(e,t){if(void 0===t&&(t=!0),t)this.localPosition.add(e),this.setLocalDirty();else{var n=this.m_parent;if(null==n)this.localPosition.add(e),this.setLocalDirty();else{var r=n.worldToLocalMatrix.mulvec(e.vec4(0));this.localPosition.add(r),this.setLocalDirty()}}},e.prototype.applyRotate=function(e){this.localRotation.selfRota(e),this.m_forward.mul(e),this.m_up.mul(e),this.m_right.mul(e),this.setLocalDirty()},e.prototype.applyScale=function(e){this.m_localScale.mul(e),this.setLocalDirty()},e}();t.Transform=i},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(0),a=n(17);!function(e){e[e.direction=0]="direction",e[e.point=1]="point"}(i=t.LightType||(t.LightType={}));var u=function(e){function t(t,n,r){var a=e.call(this)||this;return a.lightType=i.point,a.intensity=1,a.lightColor=o.vec3.one,a.m_range=10,a.m_paramDirty=!0,a.castShadow=!1,a.lightType=t,n&&(a.intensity=n),r&&(a.lightColor=r),a}return r(t,e),Object.defineProperty(t.prototype,"range",{get:function(){return this.m_range},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lightPosData",{get:function(){return this.lightType==i.direction?this.transform.forward:this.transform.localPosition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDirty",{get:function(){return this.transform.isDirty&&this.m_paramDirty},set:function(e){e?this.m_paramDirty=!0:(this.m_paramDirty=!1,this.transform.setLocalDirty(!1))},enumerable:!0,configurable:!0}),t.createPointLight=function(e,n,r,o,a){void 0===n&&(n=10);var u=new t(i.point,o,a);return e.addComponent(u),r&&(u.transform.localPosition=r),u.m_range=n,u},t.creatDirctionLight=function(e,n,r,a){void 0===n&&(n=1),void 0===r&&(r=o.vec3.down),void 0===a&&(a=o.vec3.one);var u=new t(i.direction,n,a);return e.addComponent(u),u.transform.forward=r.normalized(),u.castShadow=!0,u},t.prototype.onUpdate=function(e){e.addLight(this)},t}(a.Component);t.Light=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){this.key={},this.keyDown={},this.keyUp={},this.hasKeyPressEvent=!1,this.mouse=new Array(4),this.mouseDown=new Array(4),this.mouseUp=new Array(4),this.mousepos=new r.vec4,this.mousewheel=!1,this.mousewheelDelta=0,this.mouseMove=!1,this.deltaTime=0}return e.prototype.getKeyDown=function(e){return 1==this.keyDown[e]},e.prototype.getKeyUp=function(e){return 1==this.keyUp[e]},e.prototype.getKey=function(e){return this.key[e]},e.prototype.getMouseBtn=function(e){return this.mouse[e]},e.prototype.getMouseDown=function(e){return this.mouseDown[e]},e.prototype.getMouseUp=function(e){return this.mouseUp[e]},e}();t.InputSnapShot=i;var o=function(){function e(){this.mousepos=new r.vec4,this.mousebtn=new Array(4),this.mousedown=new Array(4),this.mouseup=new Array(4),this.mousewheel=!1,this.mousewheelDelta=0,this.keyDown={},this.keyUp={},this.m_keydirty=!1,this.m_mousedirty=!1,this.m_mousePosDirty=!1,this.m_shotMouseDownFalse=!1,this.m_shotMouseUpFalse=!1}return e.prototype.setKeyDown=function(e){var t=this.keyPress;null==t&&(t={},this.keyPress=t),t[e.key]=!0,this.keyDown[e.key]=!0,this.m_keydirty=!0},e.prototype.setKeyUp=function(e){var t=this.keyPress;null==t&&(t={},this.keyPress=t),t[e.key]=!1,this.keyUp[e.key]=!0,this.m_keydirty=!0},e.prototype.setMousePos=function(e){var t=this.mousepos,n=e.offsetX,r=e.offsetY;t.z=n-t.x,t.w=r-t.y,t.x=n,t.y=r,this.m_mousePosDirty=!0},e.prototype.setButtonDown=function(e){var t=e.button;this.mousebtn[t]=!0,this.mousedown[t]=!0,this.m_mousedirty=!0},e.prototype.setButtonUp=function(e){var t=e.button;this.mousebtn[t]=!1,this.mouseup[t]=!0,this.m_mousedirty=!0},e.prototype.setMouseWheel=function(e){this.mousewheel=!0,this.mousewheelDelta+=e},e.prototype.reset=function(){if(this.mousewheel=!1,this.mousewheelDelta=0,this.m_mousedirty){var e=this.mouseup,t=this.mousedown;e.fill(!1),t.fill(!1),this.m_mousedirty=!1}this.m_keydirty&&(this.keyDown=[],this.keyUp=[],this.m_keydirty=!1,this.keyPress={})},e.prototype.applytoSnapShot=function(e){var t=this.m_mousePosDirty;(e.mouseMove=t,t)&&(this.m_mousePosDirty=!1,e.mousepos.set(this.mousepos));e.mousewheelDelta=this.mousewheelDelta,e.mousewheel=0!=this.mousewheelDelta&&this.mousewheel;var n=e.mouseDown,r=e.mouseUp,i=e.mouse;if(this.m_mousedirty){for(var o=this.mousedown,a=0;a<4;a++)n[a]=o[a];var u=this.mouseup;for(a=0;a<4;a++)r[a]=u[a];this.m_shotMouseDownFalse=!1,this.m_shotMouseUpFalse=!1;var s=this.mousebtn;for(a=0;a<4;a++)i[a]=s[a]}else this.m_shotMouseDownFalse||(n.fill(!1),this.m_shotMouseDownFalse=!0),this.m_shotMouseUpFalse||(r.fill(!1),this.m_shotMouseUpFalse=!0);var l=this.m_keydirty;if(e.hasKeyPressEvent=l,l){var c=e.key,f=this.keyPress;for(var p in f)c[p]=f[p];e.keyDown=this.keyDown,e.keyUp=this.keyUp}else e.keyDown=null,e.keyUp=null},e}(),a=function(){function e(){}return e.init=function(t){e.s_inited||(e.s_canvas=t,e.regEventListener(),e.s_inited=!0)},e.prototype.release=function(){e.removeEventListener()},e.regEventListener=function(){window.addEventListener("keydown",e.onEvtKeyDown),window.addEventListener("keyup",e.onEvtKeyUp);var t=e.s_canvas;t.addEventListener("mousemove",e.onEvtMouseMove),t.addEventListener("mousedown",e.onEvtMouseDown),t.addEventListener("mouseup",e.onEvtMouseUp),t.addEventListener("mousewheel",e.onEvtMouseWheel)},e.removeEventListener=function(){window.removeEventListener("keydown",e.onEvtKeyDown),window.removeEventListener("keyup",e.onEvtKeyUp);var t=e.s_canvas;t.removeEventListener("mousemove",e.onEvtMouseMove),t.removeEventListener("mousedown",e.onEvtMouseDown),t.removeEventListener("mouseup",e.onEvtMouseUp)},e.onEvtKeyDown=function(t){e.s_cache.setKeyDown(t)},e.onEvtKeyUp=function(t){e.s_cache.setKeyUp(t)},e.onEvtMouseMove=function(t){e.s_cache.setMousePos(t)},e.onEvtMouseDown=function(t){e.s_cache.setButtonDown(t)},e.onEvtMouseUp=function(t){e.s_cache.setButtonUp(t)},e.onEvtMouseWheel=function(t){e.s_cache.setMouseWheel(t.deltaY)},e.onFrame=function(t){var n=e.s_cache;e.snapshot.deltaTime=t,n.applytoSnapShot(e.snapshot),n.reset()},e.s_inited=!1,e.s_cache=new o,e.snapshot=new i,e}();t.Input=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){var t=e.call(this)||this;return t.m_lightList=[],t}return r(t,e),Object.defineProperty(t.prototype,"lights",{get:function(){return this.m_lightList},enumerable:!0,configurable:!0}),t.prototype.onFrameStart=function(){this.m_lightList=[]},t.prototype.onFrameEnd=function(){},t.prototype.addLight=function(e){this.m_lightList.push(e)},t}(n(13).GameObject);t.Scene=i},function(e,t,n){"use strict";var r=n(50);function i(){}var o=null,a={};function u(e){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof e)throw new TypeError("Promise constructor's argument is not a function");this._75=0,this._83=0,this._18=null,this._38=null,e!==i&&h(e,this)}function s(e,t){for(;3===e._83;)e=e._18;if(u._47&&u._47(e),0===e._83)return 0===e._75?(e._75=1,void(e._38=t)):1===e._75?(e._75=2,void(e._38=[e._38,t])):void e._38.push(t);!function(e,t){r(function(){var n=1===e._83?t.onFulfilled:t.onRejected;if(null!==n){var r=function(e,t){try{return e(t)}catch(e){return o=e,a}}(n,e._18);r===a?c(t.promise,o):l(t.promise,r)}else 1===e._83?l(t.promise,e._18):c(t.promise,e._18)})}(e,t)}function l(e,t){if(t===e)return c(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"===typeof t||"function"===typeof t)){var n=function(e){try{return e.then}catch(e){return o=e,a}}(t);if(n===a)return c(e,o);if(n===e.then&&t instanceof u)return e._83=3,e._18=t,void f(e);if("function"===typeof n)return void h(n.bind(t),e)}e._83=1,e._18=t,f(e)}function c(e,t){e._83=2,e._18=t,u._71&&u._71(e,t),f(e)}function f(e){if(1===e._75&&(s(e,e._38),e._38=null),2===e._75){for(var t=0;t<e._38.length;t++)s(e,e._38[t]);e._38=null}}function p(e,t,n){this.onFulfilled="function"===typeof e?e:null,this.onRejected="function"===typeof t?t:null,this.promise=n}function h(e,t){var n=!1,r=function(e,t,n){try{e(t,n)}catch(e){return o=e,a}}(e,function(e){n||(n=!0,l(t,e))},function(e){n||(n=!0,c(t,e))});n||r!==a||(n=!0,c(t,o))}e.exports=u,u._47=null,u._71=null,u._44=i,u.prototype.then=function(e,t){if(this.constructor!==u)return function(e,t,n){return new e.constructor(function(r,o){var a=new u(i);a.then(r,o),s(e,new p(t,n,a))})}(this,e,t);var n=new u(i);return s(this,new p(e,t,n)),n}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"===typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={};function i(e,t){var n=r[e];null!=n?n(t):console.warn("[DebugEntry] no cmd found: "+e)}t.DebugEntry=function(e){return function(t,n,i){t instanceof Function?r[e]=t[n]:console.warn("debug entry only support static function.")}},t.DebugCmd=i,window.DebugCmd=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(15),o=n(16),a=n(10),u=n(4),s=n(7),l=function(){return function(){this.colorFormat=32856,this.depthFormat=33190,this.frameBufferResizeDelay=250}}();t.GraphicsRenderCreateInfo=l;var c=function(){function e(t,n,c){this.shadowConfig=new o.ShadowConfig,this.pause=!1,this.m_frameBufferInvalid=!1,this.m_valid=!1,this.m_time=0,this.m_dt=0,this.m_resizeDelayter=new a.Delayter,this.canvas=t,null==c&&(c=new l,this.m_creationInfo=c);var f=r.GLContext.createFromCanvas(t,{antialias:!0,alpha:!1,depth:!1,stencil:!1});this.m_glctx=f,this.m_shaderFXlib=new i.ShaderFXLibs(f);var p=f.gl;s.Material.DEF_TEXID_NUM=e.TEXID_DEFAULT_TEX,u.Texture.TEMP_TEXID=p.TEXTURE2,this.m_defaultTexture=u.Texture.crateEmptyTexture(2,2,f),p.activeTexture(p.TEXTURE3),p.bindTexture(p.TEXTURE_2D,this.m_defaultTexture.rawtexture),p.frontFace(p.CCW),this.setPipeline(n)}return Object.defineProperty(e.prototype,"isFrameBufferInvalid",{get:function(){return this.m_frameBufferInvalid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return this.m_time},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deltaTime",{get:function(){return this.m_dt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pipeline",{get:function(){return this.m_renderPipeline},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderLib",{get:function(){return this.m_shaderFXlib},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glctx",{get:function(){return this.m_glctx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultTexture",{get:function(){return this.m_defaultTexture},enumerable:!0,configurable:!0}),e.prototype.setPipeline=function(e){if(null!=e){var t=this.m_renderPipeline;null!=t&&(t.release(),t=null),e.graphicRender=this,e.onSetupRender(this.glctx,this.m_creationInfo),this.m_renderPipeline=e,this.m_valid=!0}},e.prototype.reload=function(){var e=this.m_shaderFXlib;null!=e&&e.reload();var t=this.m_renderPipeline;null!=t&&t.reload()},e.prototype.release=function(){var e=this.m_renderPipeline;null!=e&&(e.release(),this.m_renderPipeline=null),this.m_shaderFXlib.release(),this.m_time=0,this.m_valid=!1},e.prototype.resizeCanvas=function(e,t){var n=this,r=this.canvas;if(r.width!=e||r.width!=t)if(e<=0||t<=0)this.m_frameBufferInvalid=!0;else if(this.m_frameBufferInvalid=!1,this.m_valid){var i=this.m_creationInfo.frameBufferResizeDelay;if(0==i)return r.width=e,r.height=t,void this.m_renderPipeline.resizeFrameBuffer(e,t);var o=this.m_resizeDelayter;o.delaytime=i,o.emit(function(){r.width=e,r.height=t,n.m_renderPipeline.resizeFrameBuffer(e,t)})}},e.prototype.render=function(e,t){if(!this.pause&&!this.m_frameBufferInvalid){this.m_time+=t,this.m_dt=t;this.m_glctx.gl;var n=this.pipeline;null!=n&&n.exec(e)}},e.prototype.renderToCanvas=function(){this.pipeline.onRenderToCanvas()},e.TEXID_FB=0,e.TEXID_TEMP=2,e.TEXID_DEFAULT_TEX=3,e.TEXID_SHADER_TEX=[4,5,6,7,8,9,10,11],e.TEXID_SHADOW_MAP=[15,16,17,18],e}();t.GraphicsRender=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),i=function(){function e(){}return e.processVariantInclude=function(t,n){var r=e.REGEX_INCLUDE,i=t.match(r);return null!=i?{key:i[1],line:n}:null},e.processUnifiedSource=function(t,n){var r,i,o,a,u=null,s=null,l=t.match(/#pragma ([\w]+) ([\w]+)/g);if(null!=l)for(var c=0,f=l.length;c<f;c++){var p=l[c].split(/\s+/),h=p[1],d=p[2];"vs"===h&&(u=d),"ps"===h&&(s=d)}if(null==u)throw new Error("vs entry is not definded, shader:"+n);if(null==s)throw new Error("ps entry is not definded, shader:"+n);var m=null,y=null,v=t.match(/void ([\w\d]+)[\s]*\(/g);if(null!=v){var _=v.length;for(c=0;c<_;c++){var g=v[c],b=g.split(/\s+/)[1].replace("(","").trim();b!==u?b!==s||(y=e.getFunctionPosIndex(t,g)):m=e.getFunctionPosIndex(t,g)}}var w=t,T=null,E=null;m[0]>y[0]?(w=(r=e.Seperate(w,m[0],m[1]))[0],T=r[1],w=(i=e.Seperate(w,y[0],y[1]))[0],E=i[1]):(w=(o=e.Seperate(w,y[0],y[1]))[0],E=o[1],w=(a=e.Seperate(w,m[0],m[1]))[0],T=a[1]);var R=w.split("\n"),x=[],S=[],P=/^(inout|in|out)\s+[\d\w]+\s+/;for(c=0,_=R.length;c<_;c++){var A=R[c].trimLeft();if(null!=A&&""!==A){var F=A.match(P);if(null!=F){var D=F[1];"inout"===D?(A=A.substr(5),x.push("out"+A),S.push("in"+A)):"in"===D?x.push(A):"out"===D&&S.push(A)}else x.push(A),S.push(A)}}return T=T.replace(u,"main"),E=E.replace(s,"main"),[x.join("\n")+"\n"+T,S.join("\n")+"\n"+E]},e.getFunctionPosIndex=function(e,t){for(var n=e.indexOf(t),r=t.length+n,i=e.substr(r),o=i.length,a=-1,u=0,s=0;s<o;s++){var l=i[s];if("{"===l)u++;else if("}"===l&&0==--u){a=s;break}}if(-1==a)throw new Error("invalid function");return[n,r+a+1]},e.Seperate=function(e,t,n){var r=e.substr(0,t),i=e.substr(t,n-t);return[r+e.substr(n),i]},e.TrimEmptyLine=function(e){return e.replace(/^([\s]*)$/gm,"")},e.processSourceInclude=function(e,t){var n=e.match(/#include ([\w]+)/);if(null!=n){var r=n[1],i=t[r];if(null==i)throw new Error("shader variant ["+r+"] not found!");if(!i.linked)throw new Error("shader variant ["+r+"] not linked!");return[i.sources,r]}return null},e.processOptions=function(t){var n=e.REGEX_OPTIONS;if(!t.match(n))return null;var i=t.trim().substr(8).split(" ");if(null==i||0==i.length)throw new Error("invalid #options "+t);for(var o=[],a=0,u=i.length;a<u;a++){var s=i[a].trim();""!=s&&o.push(s)}var l=o.length;if(0==l||1==l)throw new Error("invalid #options "+t);if(2==l){var c,f=o[1];if("ON"!=f&&"OFF"!=f)throw new Error("invalid #options "+t);return(c=new r.ShaderOptions).flag=o[0],c.default=f,c.values=["ON","OFF"],["//"+t,c]}return(c=new r.ShaderOptions).flag=o[0],c.default=o[1],c.values=o.slice(1),["//"+t,c]},e.REGEX_INCLUDE=/#include ([\w]+)/,e.REGEX_OPTIONS=/^[\s]*#options/,e}();t.ShaderPreprocessor=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.minoff=0,this.maxoff=0,this.m_isdirty=!1,this.maxoff=0,this.minoff=e;var t=new ArrayBuffer(e);this.rawbuffer=t,this.dataView=new DataView(t),this.byteArray=new Uint8Array(t)}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this.m_isdirty},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offsetMin",{get:function(){return this.minoff},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offsetMax",{get:function(){return this.maxoff},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"raw",{get:function(){return this.byteArray},enumerable:!0,configurable:!0}),e.prototype.setDirty=function(e){this.m_isdirty=e,e||(this.minoff=this.rawbuffer.byteLength,this.maxoff=0)},e.prototype.set=function(e,t){this.byteArray.set(e.byteArray,t)},e.prototype.setOfView=function(e){this.set(e.buffer,e.viewbase)},e.prototype.setOfSubData=function(e){this.set(e.bufferView.buffer,e.baseOffset)},e.prototype.setMinMaxOffset=function(e,t){e<this.minoff&&(this.minoff=e);var n=e+t;n>this.maxoff&&(this.maxoff=n),this.m_isdirty=!0},e.prototype.setFloat=function(e,t){this.setMinMaxOffset(e,4),this.dataView.setFloat32(e,t,!0)},e.prototype.setUint32=function(e,t){this.setMinMaxOffset(e,4),this.dataView.setUint32(e,t)},e.prototype.setVec3=function(e,t){this.setMinMaxOffset(e,12);var n=t.raw,r=this.dataView,i=e;r.setFloat32(i,n[0],!0),i+=4,r.setFloat32(i,n[1],!0),i+=4,r.setFloat32(i,n[2],!0)},e.prototype.setVec4=function(e,t){this.setMinMaxOffset(e,16);var n=t.raw,r=this.dataView,i=e;r.setFloat32(i,n[0],!0),i+=4,r.setFloat32(i,n[1],!0),i+=4,r.setFloat32(i,n[2],!0),i+=4,r.setFloat32(i,n[3],!0)},e.prototype.setMat4=function(e,t){this.setMinMaxOffset(e,64);for(var n=t.raw,r=this.dataView,i=n.length,o=e,a=0;a<i;a++)r.setFloat32(o,n[a],!0),o+=4},e.prototype.setMat3=function(e,t){this.setMinMaxOffset(e,36);for(var n=t.raw,r=this.dataView,i=n.length,o=e,a=0;a<i;a++)r.setFloat32(o,n[a],!0),o+=4},e}(),i=function(){function e(e,t,n){this.base=0,this.fxbuffer=e,this.base=t}return Object.defineProperty(e.prototype,"buffer",{get:function(){return this.fxbuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewbase",{get:function(){return this.base},enumerable:!0,configurable:!0}),e.prototype.setFloat=function(e,t){var n=this.base;this.fxbuffer.setFloat(n+e,t)},e.prototype.setUint32=function(e,t){var n=this.base;this.fxbuffer.setUint32(n+e,t)},e.prototype.setVec3=function(e,t){var n=this.base;this.fxbuffer.setVec3(n+e,t)},e.prototype.setVec4=function(e,t){var n=this.base;this.fxbuffer.setVec4(n+e,t)},e.prototype.setMat4=function(e,t){var n=this.base;this.fxbuffer.setMat4(n+e,t)},e.prototype.setMat3=function(e,t){var n=this.base;this.fxbuffer.setMat3(n+e,t)},e}(),o=function(){function e(e,t,n){if(this.m_seperated=!1,this.byteLength=t,null==e){var o=new r(t);this.view=new i(o,0,t),this.m_seperated=!0}else this.view=new i(e.fxbuffer,n,t);this.baseOffset=n}return Object.defineProperty(e.prototype,"isSeperated",{get:function(){return this.m_seperated},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferView",{get:function(){return this.view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDirty",{get:function(){return this.view.buffer.isDirty},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setDirty",{set:function(e){this.view.buffer.setDirty(e)},enumerable:!0,configurable:!0}),e}();t.ShaderSubData=o;var a=function(){function e(e){this.buffer=new r(e)}return Object.defineProperty(e.prototype,"fxbuffer",{get:function(){return this.buffer},enumerable:!0,configurable:!0}),e.prototype.submitBuffer=function(e,t){var n=this.buffer;if(!n.isDirty)return!1;var r=n.offsetMin,i=n.offsetMax;return r>=i?(n.setDirty(!1),!1):(e.bindBuffer(e.UNIFORM_BUFFER,t),e.bufferSubData(e.UNIFORM_BUFFER,r,n.raw,r,i-r),e.bindBuffer(e.UNIFORM_BUFFER,null),n.setDirty(!1),!0)},e}();t.ShaderData=a},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(e){for(var t=this.pipeline,n=t.GLCtx,r=t.bufferDebugInfo,i=0,o=r.length;i<o;i++){var a=r[i],u=a.rawTexture;null!=u&&n.drawTex(u,!1,!1,a.drawRect)}},t}(n(3).RenderPass);t.PassDebug=i},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(34),o=n(35),a=n(36),u=n(38),s=n(39),l=n(41),c=n(12),f=n(4),p=n(1),h=n(11),d=n(3),m=function(e){function t(){return e.call(this)||this}return r(t,e),t.prototype.init=function(){if(!this.m_inited){e.prototype.init.call(this);var t=this.glctx.gl;t.depthMask(!0),t.depthFunc(t.LEQUAL),t.enable(t.DEPTH_TEST);var n=this.m_mainFrameBuffer;this.createMainDepthFB(n.width,n.height),this.m_passGizmos=new u.PassGizmos(this),this.m_passDepth=new s.PassDepth(this),this.m_passOpaque=new i.PassOpaque(this),this.m_passTransparent=new o.PassTransparent(this),this.m_passSkybox=new a.PassSkybox(this),this.m_passShadowMap=new l.PassShadowMap(this),this.m_inited=!0}},t.prototype.createMainDepthFB=function(e,t){var n=this.m_mainFrameBufferInfo,r=new f.TextureCreationDesc(null,n.depthFormat,!1,h.GL.NEAREST,h.GL.NEAREST),i=f.Texture.createTexture2D(e,t,r,this.glctx);this.m_mainDepthTexture=i;var o=this.gl;if(null==this.m_mainDepthFB){var a=o.createFramebuffer();o.bindFramebuffer(o.DRAW_FRAMEBUFFER,a),o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.TEXTURE_2D,i.rawtexture,0),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),this.m_mainDepthFB=a}},t.prototype.resizeFrameBuffer=function(t,n){e.prototype.resizeFrameBuffer.call(this,t,n);var r=this.glctx,i=this.gl;null!=this.m_mainDepthFB&&i.deleteFramebuffer(this.m_mainDepthFB);var o=this.m_mainDepthTexture;o.resize(t,n,r);var a=i.createFramebuffer();i.bindFramebuffer(i.DRAW_FRAMEBUFFER,a),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,o.rawtexture,0),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),this.m_mainDepthFB=a},t.prototype.exec=function(e){var t=e.mainCamera;if(null!=t){t.aspect=this.mainFrameBufferAspect,this.updateShaderDataBasis(t),this.generateDrawList(e),this.bindTargetFrameBuffer();var n=this.gl;n.clearColor(1,0,0,1),n.clearDepth(10),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),this.m_passDepth.render(e),this.m_passShadowMap.render(e),this.m_passOpaque.render(e),this.m_passSkybox.render(e),this.m_passTransparent.render(e),this.m_passGizmos.render(),this.renderBufferDebug(),this.UnBindTargetFrameBuffer();var r=this.stateCache;r.setBlend(!1),r.setZTest(p.Comparison.ALWAYS),r.setZWrite(!0)}},t.prototype.release=function(){this.m_inited||(this.gl.deleteFramebuffer(this.m_mainDepthFB),this.m_mainDepthTexture.release(this.glctx),this.m_mainDepthTexture=null,this.m_passDebug=d.RenderPass.Release(this.m_passDepth),this.m_passGizmos=d.RenderPass.Release(this.m_passGizmos),this.m_passOpaque=d.RenderPass.Release(this.m_passOpaque),this.m_passShadowMap=d.RenderPass.Release(this.m_passShadowMap),this.m_passSkybox=d.RenderPass.Release(this.m_passSkybox),this.m_passTransparent=d.RenderPass.Release(this.m_passTransparent))},t.prototype.reload=function(){this.release(),this.init()},t}(c.PipelineBase);t.PipelineForwardZPrePass=m},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=function(e){function t(t){var n=e.call(this,t)||this;console.log("init opaque");var r=new i.ShaderTags;return r.blendOp=null,r.blend=!1,r.zwrite=!1,r.ztest=i.Comparison.LEQUAL,r.culling=i.CullingMode.Back,r.fillDefaultVal(),n.m_tags=r,t.GL.polygonOffset(-1,-1),n}return r(t,e),t.prototype.render=function(e){var t=this.pipeline.nodeList.nodeOpaque,n=this.pipeline,r=n.GL,i=n.GLCtx,o=this.m_tags,a=e.mainCamera;if(0!=t.length){r.enable(r.POLYGON_OFFSET_FILL);var u=e.lights[0];if(null!=u&&u.isDirty){var s=n.shaderDataLight;s.setLightData(u.lightPosData,u.lightType,0),s.setLightColorIntensity(u.lightColor,u.intensity,0),s.setAmbientColor(a.ambientColor),n.updateUniformBufferLight(s)}n.stateCache.reset(o),n.activeDefaultTexture();for(var l=t.length,c=null,f=n.shaderDataObj,p=0;p<l;p++){var h=t[p],d=h.material,m=h.mesh,y=d.program;if(h.refershVertexArray(i),y!=c){var v=y.Program;r.useProgram(v),n.uniformBindDefault(y),c=y}d.apply(r),f.setMtxModel(h.object.transform.objMatrix),n.updateUniformBufferObject(f),r.bindVertexArray(h.vertexArrayObj);var _=m.indiceDesc;r.drawElements(r.TRIANGLES,_.indiceCount,_.type,_.offset),r.bindVertexArray(null),d.clean(r)}r.disable(r.POLYGON_OFFSET_FILL)}},t}(n(3).RenderPass);t.PassOpaque=o},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=function(e){function t(t){var n=e.call(this,t)||this,r=new i.ShaderTags;return r.blendOp=i.BlendOperator.ADD,r.blend=!0,r.zwrite=!1,r.ztest=i.Comparison.LEQUAL,r.culling=i.CullingMode.Back,r.fillDefaultVal(),n.m_tags=r,n}return r(t,e),t.prototype.render=function(e){var t=this.pipeline,n=t.GL,r=t.GLCtx,i=this.m_tags,o=t.nodeList.nodeTransparent;if(0!=o.length){t.stateCache.reset(i),t.activeDefaultTexture();for(var a=o.length,u=null,s=t.shaderDataObj,l=0;l<a;l++){var c=o[l],f=c.material,p=c.mesh,h=f.program;if(c.refershVertexArray(r),h!=u){var d=h.Program;n.useProgram(d),t.uniformBindDefault(h),u=h}f.apply(n),s.setMtxModel(c.object.transform.objMatrix),t.updateUniformBufferObject(s),n.bindVertexArray(c.vertexArrayObj);var m=p.indiceDesc;n.drawElements(n.TRIANGLES,m.indiceCount,m.type,m.offset),n.bindVertexArray(null),f.clean(n)}}},t}(n(3).RenderPass);t.PassTransparent=o},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=n(6),a=n(21),u=n(37),s=n(7),l=n(5),c=n(2),f=function(e){function t(t){var n=e.call(this,t)||this;n.m_lastCubeType=u.CubeMapType.Texture360;var r=new i.ShaderTags;r.blend=!1,r.zwrite=!0,r.ztest=i.Comparison.LEQUAL,r.culling=i.CullingMode.Back,r.fillDefaultVal(),n.m_tags=r;var a=new s.Material(t.graphicRender.shaderLib.shaderSkybox);a.setFlag("ENVMAP_TYPE","TEX",!0);var c=new o.MeshRender(l.Mesh.Quad,a);return n.m_skyrender=c,n}return r(t,e),t.prototype.release=function(){this.m_skyrender.release(this.pipeline.GLCtx),this.m_skyrender=null,this.m_lastTex=null,e.prototype.release.call(this)},t.prototype.render=function(e){var t=e.mainCamera;if(t.clearType==a.ClearType.Skybox&&null!=t.skybox){var n=this.pipeline;n.bindTargetFrameBuffer(),n.stateCache.reset(this.m_tags);var r=this.m_skyrender,i=r.material,o=t.skybox;if(o.cubemapType!=this.m_lastCubeType){var s=o.cubemapType;this.m_lastCubeType=s,i.setFlag("ENVMAP_TYPE",s==u.CubeMapType.Cube?"CUBE":"TEX",!0),i.setTexture(c.ShaderFX.UNIFORM_MAIN_TEXTURE,o.gltex)}if(o.gltex!=this.m_lastTex){var l=o.gltex;this.m_lastTex=l,i.setTexture(c.ShaderFX.UNIFORM_MAIN_TEXTURE,l)}n.drawMeshRender(r)}},t}(n(3).RenderPass);t.PassSkybox=f},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var o,a=n(0),u=n(4);!function(e){e[e.Cube=0]="Cube",e[e.Texture360=1]="Texture360"}(o=t.CubeMapType||(t.CubeMapType={}));var s=function(){function e(e){this.m_type=e}return Object.defineProperty(e.prototype,"gltex",{get:function(){return this.m_rawTex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cubemapType",{get:function(){return this.m_type},enumerable:!0,configurable:!0}),e.prototype.release=function(e){this.m_rawTex&&(e.gl.deleteTexture(this.m_rawTex),this.m_rawTex=null)},e.loadCubeMapTex=function(t,n){var s=this;return null==t?null:new Promise(function(l,c){return r(s,void 0,void 0,function(){var r,s,f,p;return i(this,function(i){switch(i.label){case 0:return[4,a.GLUtility.loadImage(t)];case 1:if(null==(r=i.sent()))return c("load image failed!"),[2];s=null;try{f=n.gl,p=f.createTexture(),f.activeTexture(u.Texture.TEMP_TEXID),f.bindTexture(f.TEXTURE_2D,p),f.texImage2D(f.TEXTURE_2D,0,f.RGB,f.RGB,f.UNSIGNED_BYTE,r),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.bindTexture(f.TEXTURE_2D,null),(s=new e(o.Texture360)).m_rawTex=p}catch(e){c(e)}return l(s),[2]}})})})},e.loadCubeMap=function(t,n){return r(this,void 0,void 0,function(){var s=this;return i(this,function(l){return null==t||6!=t.length?[2,null]:[2,new Promise(function(l,c){return r(s,void 0,void 0,function(){var r,s,f,p,h,d,m,y,v;return i(this,function(i){switch(i.label){case 0:for(r=[],s=t,f=0;f<6;f++)r.push(a.GLUtility.loadImage(s[f]));return[4,Promise.all(r)];case 1:if(6!=(p=i.sent()).length)return c("load image failed!"),[2];h=null;try{for(d=n.gl,m=d.createTexture(),d.activeTexture(u.Texture.TEMP_TEXID),d.bindTexture(d.TEXTURE_CUBE_MAP,m),y=0;y<6;y++)v=p[y],d.texImage2D(d.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,d.RGB,d.RGB,d.UNSIGNED_BYTE,v);d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_WRAP_R,d.CLAMP_TO_EDGE),d.bindTexture(d.TEXTURE_CUBE_MAP,null),(h=new e(o.Cube)).m_rawTex=m}catch(e){return c(e),[2]}return l(h),[2]}})})})]})})},e}();t.TextureCubeMap=s},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),a=n(1),u=n(7),s=n(5),l=n(0),c=n(6),f=n(2),p=n(67),h=function(e){function t(n){var r=e.call(this,n)||this;if(r.enable=!0,null==t.s_shader){var i=f.ShaderFX.compileShaders(n.GLCtx,t.SH_gizmos);t.s_shader=i}var o=new u.Material(t.s_shader);r.m_material=o;var s=r.genMesh();r.m_mesh=s,null!=s&&(r.m_vao=c.MeshRender.CreateVertexArrayObj(n.GLCtx,s,o.program));var l=new a.ShaderTags;return l.blend=!1,l.ztest=a.Comparison.LEQUAL,l.zwrite=!1,l.fillDefaultVal(),r.m_tags=l,r}return r(t,e),t.prototype.render=function(e){if(this.enable){var t=this.m_mesh;if(null!=t){var n=o.PipelineBase,r=f.ShaderFX.UNIFORM_BASIS,i=f.ShaderFX.UNIFORM_OBJ,a=this.pipeline,u=a.GL;a.stateCache.apply(this.m_tags);var s=this.m_material,c=s.program,p=c.Program;u.useProgram(c.Program);var h=c.UniformBlock,d=h[r];null!=d&&u.uniformBlockBinding(p,d,n.UNIFORMINDEX_BASIS);var m=h[i];null!=m&&u.uniformBlockBinding(p,m,n.UNIFORMINDEX_OBJ),s.apply(u);var y=a.shaderDataObj,v=l.mat4.Identity;y.setMtxModel(v),a.updateUniformBufferObject(y),u.bindVertexArray(this.m_vao);var _=t.indiceDesc;u.drawElements(_.topology,_.indiceCount,_.type,_.offset),u.bindVertexArray(null)}}},t.prototype.genMesh=function(){var e=new p.MeshBuilder(s.MeshTopology.Lines);return e.addLine(l.glmath.vec3(-50,0,0),l.glmath.vec3(50,0,0)),e.addLine(l.glmath.vec3(0,0,-50),l.glmath.vec3(0,0,50)),e.addLine(l.glmath.vec3(-5,0,-5),l.glmath.vec3(5,0,-5)),e.addLine(l.glmath.vec3(5,0,-5),l.glmath.vec3(5,0,5)),e.addLine(l.glmath.vec3(5,0,5),l.glmath.vec3(-5,0,5)),e.addLine(l.glmath.vec3(-5,0,5),l.glmath.vec3(-5,0,-5)),e.genMesh()},i([f.ShaderFile("gizmos")],t,"SH_gizmos",void 0),t}(n(3).RenderPass);t.PassGizmos=h},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),o=n(1),a=n(0),u=n(40),s=n(3),l=n(2),c=function(e){function t(t){var n=e.call(this,t)||this,r=new o.ShaderTags;r.blendOp=null,r.blend=!1,r.zwrite=!0,r.ztest=o.Comparison.LEQUAL,r.culling=o.CullingMode.Back,r.fillDefaultVal(),n.m_tags=r;var i=t.graphicRender.shaderLib.shaderDepth;n.m_program=i.defaultProgram;var s=new u.BufferDebugInfo(t.mainDepthTexture,a.glmath.vec4(0,0,200,200));return n.m_bufferDebugInfo=s,t.addBufferDebugInfo(s),n}return r(t,e),t.prototype.render=function(e){var t=i.PipelineBase,n=this.pipeline,r=n.GL,o=n.GLCtx,a=this.m_tags,u=l.ShaderFX.UNIFORM_BASIS,s=l.ShaderFX.UNIFORM_OBJ,c=(e.mainCamera,n.nodeList.nodeOpaque);if(0!=c.length){r.colorMask(!1,!1,!1,!1),n.stateCache.reset(a),n.activeDefaultTexture();var f=c.length,p=this.m_program,h=p.Program;r.useProgram(this.m_program.Program);var d=p.UniformBlock,m=d[u];r.uniformBlockBinding(h,m,t.UNIFORMINDEX_BASIS);var y=d[s];r.uniformBlockBinding(h,y,t.UNIFORMINDEX_OBJ);for(var v=n.shaderDataObj,_=0;_<f;_++){var g=c[_],b=g.material,w=g.mesh;g.refershVertexArray(o),v.setMtxModel(g.object.transform.objMatrix),n.updateUniformBufferObject(v),r.bindVertexArray(g.vertexArrayObj);var T=w.indiceDesc;r.drawElements(r.TRIANGLES,T.indiceCount,T.type,T.offset),r.bindVertexArray(null),b.clean(r)}r.colorMask(!0,!0,!0,!0);var E=n.mainFrameBuffer;r.bindFramebuffer(r.READ_FRAMEBUFFER,E.frambuffer),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,n.mainDepthFrameBuffer);var R=E.width,x=E.height;r.blitFramebuffer(0,0,R,x,0,0,R,x,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),n.bindTargetFrameBuffer(!0),this.m_bufferDebugInfo.setTexture(n.mainDepthTexture)}},t}(s.RenderPass);t.PassDepth=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=function(){function e(e,t){this.m_texture=e,this.drawRect=t.clone()}return Object.defineProperty(e.prototype,"rawTexture",{get:function(){return this.m_texture instanceof r.Texture?this.m_texture.rawtexture:this.m_texture},enumerable:!0,configurable:!0}),e.prototype.setTexture=function(e){this.m_texture=e},e}();t.BufferDebugInfo=i},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(12),a=n(6),u=n(0),s=n(2),l=n(16),c=n(4),f=n(23),p=n(40),h=n(5),d=n(7),m=function(e){function t(t){var n=e.call(this,t)||this;return n.initShadowMaps(),n}return r(t,e),t.prototype.initShadowMaps=function(){var e=this.pipeline,n=e.GL,r=e.GLCtx,i=e.graphicRender.shadowConfig,o=e.graphicRender.shaderLib.shaderShadowMap,f=o.defaultProgram;this.m_shader=o,this.m_program=f,this.m_uniformLightVP=f.Uniforms.uLightVP;var m=f.UniformBlock,y=m[s.ShaderFX.UNIFORM_BASIS],v=m[s.ShaderFX.UNIFORM_OBJ];this.m_blockIndexBasis=y,this.m_blockIndexObj=v;var _=i.shadowmapSize,g=_,b=_;i.cascade==l.ShadowCascade.TwoCascade&&(b*=2),this.m_smheight=g,this.m_smwidth=b;var w=new c.TextureCreationDesc(null,n.DEPTH_COMPONENT24,!1,n.NEAREST,n.NEAREST),T=c.Texture.createTexture2D(b,g,w,r);this.m_smtex=T,n.activeTexture(n.TEXTURE12),n.bindTexture(n.TEXTURE_2D,T.rawtexture);var E=n.createFramebuffer();this.m_smfb=E,n.bindFramebuffer(n.DRAW_FRAMEBUFFER,E),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,T.rawtexture,0);var R=n.checkFramebufferStatus(n.DRAW_FRAMEBUFFER);R!=n.FRAMEBUFFER_COMPLETE&&console.error("fb status incomplete "+R.toString(16)),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null);var x=new p.BufferDebugInfo(this.m_smtex,u.glmath.vec4(200,0,200,200));if(e.addBufferDebugInfo(x),null==t.s_shadowGatherShader){var S=s.ShaderFX.compileShaders(r,t.SH_shadowGather);t.s_shadowGatherShader=S}var P=new d.Material(t.s_shadowGatherShader),A=P.program;this.m_gatherMat=P,P.setTexture("uDepthTexure",e.mainDepthTexture),P.setTexture("uShadowMap",this.m_smtex),this.m_quadMesh=h.Mesh.Quad,this.m_quadVAO=a.MeshRender.CreateVertexArrayObj(r,this.m_quadMesh,A);var F=new c.TextureCreationDesc(n.RGB,n.RGB8,!1,n.LINEAR,n.LINEAR),D=c.Texture.createTexture2D(e.mainFrameBufferWidth,e.mainFrameBufferHeight,F,r);this.m_shadowTexture=D;var O=n.createFramebuffer();n.bindFramebuffer(n.DRAW_FRAMEBUFFER,O),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,D.rawtexture,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),this.m_shadowFB=O;var M=new p.BufferDebugInfo(D,u.glmath.vec4(0,200,200,200));e.addBufferDebugInfo(M)},t.prototype.render=function(e){var t=o.PipelineBase,n=this.pipeline.nodeList.nodeOpaque,r=e.mainCamera;if(null!=r){var i=this.pipeline;r.aspect=i.mainFrameBufferAspect;var a=i.graphicRender.shadowConfig,u=this.m_program,s=i.GL,l=u.Program;s.useProgram(l),s.uniformBlockBinding(l,this.m_blockIndexBasis,t.UNIFORMINDEX_BASIS),s.uniformBlockBinding(l,this.m_blockIndexObj,t.UNIFORMINDEX_OBJ);for(var c=e.lights,f=0,p=c.length;f<p;f++)this.renderLightShadowMap(c[f],r,n,a);var h=this.pipeline.shaderDataShadowMap;i.updateUniformBufferShadowMap(h),i.bindTargetFrameBuffer(!0)}},t.prototype.renderLightShadowMap=function(e,t,n,r){if(e.lightType==f.LightType.direction){var i=this.pipeline,o=i.GL,a=i.shaderDataShadowMap;o.bindFramebuffer(o.DRAW_FRAMEBUFFER,this.m_smfb),o.enable(o.DEPTH_TEST),o.depthFunc(o.LEQUAL),o.clearDepth(1),o.clear(o.DEPTH_BUFFER_BIT),o.viewport(0,0,this.m_smwidth,this.m_smheight);var s=this.calculateLightMatrix(e,t,r)[0],l=s[0],c=s[1].mul(l);a.setLightMtx(c,0),i.shadowMapData.lightMtx0=c;var p=r.cascade,h=this.m_smheight;1==p?this.renderShadowCascade(u.glmath.vec4(0,0,h,h),n,c):2==p?(this.renderShadowCascade(u.glmath.vec4(0,0,h,h),n,c),this.renderShadowCascade(u.glmath.vec4(h,0,h,h),n,c)):(this.renderShadowCascade(u.glmath.vec4(0,0,h,h),n,c),this.renderShadowCascade(u.glmath.vec4(h,0,h,h),n,c),this.renderShadowCascade(u.glmath.vec4(0,h,h,h),n,c),this.renderShadowCascade(u.glmath.vec4(h,h,h,h),n,c)),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null)}},t.prototype.calculateLightMatrix=function(e,t,n){var r=t.transform,i=t.near,o=t.far-i,a=Math.min(o,n.shadowDistance),s=n.cascade,l=n.cascadeSplit,c=i,f=i,p=r.position,h=r.worldForward,d=Math.tan(t.fov/2*u.glmath.Deg2Rad),m=d*t.aspect,y=e.lightPosData,v=u.vec3.up;Math.abs(u.vec3.Dot(v,y))>.99&&(v=u.glmath.vec3(0,1,.001));for(var _=[],g=0;g<s;g++){var b=l[g]*a;c+=b;var w=.5*b,T=f+w,E=p.clone().sub(h.clone().mul(T)),R=c*d,x=c*m,S=Math.sqrt(R*R+w*w+x*x),P=E.sub(y.mulToRef(S)),A=u.mat4.coordCvt(P,y,v),F=u.mat4.orthographic(S,S,.1,2*S);_.push([A,F]),f+=b}return _},t.prototype.renderShadowCascade=function(e,t,n){var r=this.pipeline,i=r.GLCtx,o=i.gl;o.uniformMatrix4fv(this.m_uniformLightVP,!1,n.raw),o.viewport(e.x,e.y,e.z,e.w);for(var a=r.shaderDataObj,u=t.length,s=0;s<u;s++){var l=t[s];if(l.castShadow){var c=l.material,f=l.mesh;if(null!=c&&null!=f){l.refershVertexArray(i);var p=l.object.transform;a.setMtxModel(p.objMatrix),r.updateUniformBufferObject(a),o.bindVertexArray(l.vertexArrayObj);var h=f.indiceDesc;o.drawElements(h.topology,h.indiceCount,h.type,h.offset),o.bindVertexArray(null)}}}},t.prototype.shadowGathering=function(e){var t=o.PipelineBase,n=this.pipeline.shaderDataShadowMap;n.setLightMtx(this.pipeline.shadowMapData.lightMtx0,0),this.pipeline.updateUniformBufferShadowMap(n);var r=this.pipeline.GL;r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.m_shadowFB),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT);var i=this.m_shadowTexture;r.viewport(0,0,i.width,i.height);var a=this.m_gatherMat,u=a.program,l=u.Program;r.useProgram(l);var c=u.UniformBlock,f=c[s.ShaderFX.UNIFORM_SHADOWMAP];null!=f&&r.uniformBlockBinding(l,f,t.UNIFORMINDEX_SHADOWMAP);var p=c[s.ShaderFX.UNIFORM_BASIS];null!=p&&r.uniformBlockBinding(l,p,t.UNIFORMINDEX_BASIS);var h=c[s.ShaderFX.UNIFORM_OBJ];null!=h&&r.uniformBlockBinding(l,h,t.UNIFORMINDEX_OBJ),a.apply(r);var d=this.m_quadMesh,m=this.m_quadVAO;r.bindVertexArray(m);var y=d.indiceDesc;r.drawElements(r.TRIANGLES,y.indiceCount,y.type,y.offset),r.bindVertexArray(null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,null)},i([s.ShaderFile("shadowsGather")],t,"SH_shadowGather",void 0),t}(n(3).RenderPass);t.PassShadowMap=m},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=n(17),o=n(24),a=n(0),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_startpos=a.vec4.zero,t.m_rotay=0,t.m_rotax=0,t}return r(t,e),t.prototype.onStart=function(){console.log("camera freefly onstart"),this.m_trs=this.gameobject.transform},t.prototype.onUpdate=function(e){var t=this.m_trs,n=o.Input.snapshot;if(n.getKey("w")?t.applyTranslate(t.worldForward.mulToRef(-.3),!1):n.getKey("s")&&t.applyTranslate(t.worldForward.mulToRef(.3),!1),n.getKey("d")?t.applyTranslate(t.worldRight.mulToRef(-.3),!1):n.getKey("a")&&t.applyTranslate(t.worldRight.mulToRef(.3),!1),n.mousewheel){var r=t.worldForward.mulNumToRef(.05*n.mousewheelDelta);t.applyTranslate(r,!1)}if(n.getMouseBtn(0))if(n.getMouseDown(0)){this.m_startpos.set(n.mousepos);var i=t.localRotation.toEuler();this.m_rotax=i.x,this.m_rotay=i.y}else{var u=n.mousepos,s=this.m_startpos;if(0!=s.z||0!=s.w){var l=u.x-s.x,c=u.y-s.y;if(0!=l&&0!=c){var f=a.glmath.Deg2Rad,p=this.m_rotax-c*f*.3,h=this.m_rotay+l*f*.3;t.setRotation(a.quat.fromEuler(p,h,0))}}}},t}(i.Component);t.CameraFreeFly=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){void 0===e&&(e=!1),this.m_ts=0,this.m_delta=0,this.m_deltaaccu=0,this.m_accuCount=0,this.m_fps=0,this.m_printfps=!1,this.m_printfps=e}return Object.defineProperty(e.prototype,"fps",{get:function(){return this.m_fps},enumerable:!0,configurable:!0}),e.prototype.tick=function(e){var t=e-this.m_ts;if(this.m_delta=t,this.m_ts=e,this.m_printfps){this.m_deltaaccu+=this.m_delta;var n=this.m_accuCount;++n>=60&&(this.m_fps=6e4/this.m_deltaaccu,this.m_deltaaccu=0,n=0,console.log("FPS "+this.m_fps)),this.m_accuCount=n}return t},e}();t.FrameTimer=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.onFrame=function(e){e.onFrameStart();var t=e.transform;t.localMatrix,t.setObjMatrixDirty(!1),e.update(e),e.onFrameEnd()},e}();t.SceneManager=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(13),o=n(5),a=n(6),u=n(11),s=n(7),l=n(15),c=n(1),f=n(4),p=function(){function e(e,t,n){this.buffers={},this.buffersDesc={},this.materials={},this.images={},this.m_gltfData=e,this.m_glctx=t,this.m_shaderfxlib=n,this.m_pbrShader=n.shaderPbrMetallicRoughness,this.m_pbrBlendShader=n.shaderUnlitTexture,this.gltf=e.gltf}return e.prototype.release=function(){},e.prototype.createScene=function(){var e=this.gltf,t=e.scenes;if(null==t)return null;for(var n=t[e.scene],o=e.nodes,a=n.nodes,u=new i.GameObject,s=0,l=a.length;s<l;s++){var c=this.buildNode(o,a[s]);null!=c&&(c.transform.parent=u.transform)}return u.transform.setScale(r.glmath.vec3(.001,.001,.001)),u},e.prototype.buildNode=function(e,t){var n=e[t];if(null==n)throw console.error(e),console.error(t),new Error("invalid node");var o=new i.GameObject;if(o.name=n.name,n.rotation?o.transform.setRotation(new r.quat(n.rotation)):n.matrix&&(o.transform.localMatrix=new r.mat4(n.matrix)),n.mesh){var a=this.getMesh(n.mesh);null!=a&&(o.render=a)}var u=n.children;if(null!=u&&u.length>0)for(var s=0,l=u.length;s<l;s++){var c=this.buildNode(e,u[s]);null!=c&&(c.transform.parent=o.transform)}return o},e.prototype.getMesh=function(e){var t=this.gltf.meshes;if(null==t)return null;var n=t[e];if(null==n)return null;var r=n.primitives;if(null==r)return null;var i=new o.Mesh;i.name=n.name;var u=r[0],s=u.attributes;if(null!=s.NORMAL){var l=s.NORMAL,c=this.getBuffer(l),f=this.buffersDesc[l];i.setNormal(c,f.type,f.size)}if(null!=s.POSITION){var l=s.POSITION;c=this.getBuffer(l),f=this.buffersDesc[l];i.setPosition(c,f.type,f.size)}if(null!=s.TEXCOORD_0){l=s.TEXCOORD_0,c=this.getBuffer(l),f=this.buffersDesc[l];i.setUV(c,f.type,f.size)}if(s.TANGENT,null!=(l=u.indices)){c=this.getBuffer(l),f=this.buffersDesc[l];var p=null==u.mode?4:u.mode;i.setIndices(c,f.type,p)}var h=null;return null!=u.material&&(h=this.getMaterial(u.material)),new a.MeshRender(i,h)},e.prototype.getBuffer=function(e){var t=this.buffers[e];if(null!=t)return t;var n=this.gltf.accessors[e],r=this.gltf.bufferViews[n.bufferView];if(null==r)throw console.error(n),console.error(this.gltf.bufferViews[n.bufferView]),new Error("buffer view is null");var i=this.m_gltfData.rawBinary,a=n.componentType,s=null,l=0;null!=n.byteOffset&&(l+=n.byteOffset),null!=r.byteOffset&&(l+=r.byteOffset);var c=n.type,f=this.getSize(c),p=n.count*f;if(a==u.GL.FLOAT)s=new Float32Array(i,l,p);else if(a==u.GL.UNSIGNED_INT)s=new Uint32Array(i,l,p);else{if(a!=u.GL.UNSIGNED_SHORT)throw new Error("buffer datatype not supported."+a);s=new Uint16Array(i,l,p)}var h=p*o.MeshBufferUtility.TypeSize(a);return this.buffers[e]=s,this.buffersDesc[e]=new o.MeshVertexAttrDesc(a,f,h),s},e.prototype.getSize=function(e){switch(e){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}throw new Error("invalid type "+e)},e.prototype.getMaterial=function(e){var t=this.gltf.materials;if(null==t)return null;var n=t[e],i=new s.Material(this.m_pbrShader);i.name=n.name;var o=null,a=!1;1==n.doubleSided&&(null==o&&(o=new c.ShaderTags),o.culling=c.CullingMode.None,a=!0),"BLEND"==n.alphaMode&&(null==o&&(o=new c.ShaderTags),o.blendOp=c.BlendOperator.ADD,o.queue=c.RenderQueue.Transparent,a=!0,i.setShader(this.m_pbrBlendShader)),a&&(null==o.queue&&(o.queue=c.RenderQueue.Opaque),i.shaderTags=o);var u=n.pbrMetallicRoughness;if(null!=u){var f=u.baseColorFactor;null!=f&&i.setColor(l.ShaderFXLibs.SH_PBR_BaseColorFactor,new r.vec4(f));var p=u.baseColorTexture;if(null!=p)null!=(y=this.getImage(p.index))&&i.setTexture(l.ShaderFXLibs.SH_PBR_BaseColorTexture,y);var h=u.metallicFactor;null!=h&&i.setFloat(l.ShaderFXLibs.SH_PBR_MetallicFactor,h);var d=u.roughnessFactor;null!=d&&i.setFloat(l.ShaderFXLibs.SH_PBR_RoughnessFactor,d);var m=u.metallicRoughnessTexture;if(null!=m){var y=this.getImage(m.index);i.setTexture(l.ShaderFXLibs.SH_PBR_MetallicRoughnessTexture,y)}}var v=n.emissiveFactor;null!=v&&i.setColor(l.ShaderFXLibs.SH_PBR_EmissiveFactor,r.glmath.vec4(v[0],v[1],v[2],0));var _=n.emissiveTexture;if(null!=_){y=this.getImage(_.index);i.setTexture(l.ShaderFXLibs.SH_PBR_EmissiveTexture,y)}return this.materials[e]=i,i},e.prototype.getImage=function(e){var t=this.images[e];if(null!=t)return t;var n=this.gltf.images[e],r=n.mimeType;if("image/png"!=r&&"image/jpg"!=r)throw new Error("invalid mime type "+r);var i=this.gltf.bufferViews[n.bufferView];if(null==i)return null;var o=this.m_gltfData.rawBinary,a=new Uint8Array(o,i.byteOffset,i.byteLength),u=f.Texture.createTextureSync(a,n.mimeType,this.m_glctx);return this.images[e]=u,u},e}();t.GLTFSceneBuilder=p},function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"a",function(){return c});var r,i=n(8),o=n(9),a=(n.n(o),n(72)),u=n(25),s=(n.n(u),n(6)),l=(n.n(s),function(){function e(){}return e.prototype.onSetupRender=function(t){e.tracer=this,this.grender=t,this.m_csgcontainer=new f;var n=new a.a(this.m_csgcontainer);t.setPipeline(n),this.pipeline=n},e.prototype.onInit=function(){this.m_sceneMgr=new o.SceneManager},e.test=function(){e.tracer.pipeline.toggleRenderMode()},e.prototype.onSetupScene=function(){var e=new u.Scene,t=o.Camera.persepctive(null,60,1,.1,100);t.gameobject.addComponent(new o.CameraFreeFly),t.transform.parent=e.transform,t.transform.setPosition(o.glmath.vec3(4,0,5)),this.m_scene=e;var n=new o.Material(this.grender.shaderLib.shaderUnlitColor),r=this.m_csgcontainer,i=new o.GameObject("planeTop");i.transform.parent=e.transform;var a=p.createPlane(i,o.glmath.vec3(0,5,0),o.vec3.down);r.addObj(a),i.render.material=n.clone(),a.setColor(o.vec4.one);var s=new o.GameObject("planeBottom");s.transform.parent=e.transform;var l=p.createPlane(s,o.glmath.vec3(0,-5,0),o.vec3.up);r.addObj(l),s.render.material=n.clone(),l.setColor(o.vec4.one);var c=new o.GameObject("planeLeft");c.transform.parent=e.transform;var f=p.createPlane(c,o.glmath.vec3(5,0,0),o.vec3.right);r.addObj(f),c.render.material=n.clone(),f.setColor(o.glmath.vec4(0,0,1,1));var h=new o.GameObject("planeRight");h.transform.parent=e.transform;var d=p.createPlane(h,o.glmath.vec3(-5,0,0),o.vec3.left);r.addObj(d),h.render.material=n.clone(),d.setColor(o.glmath.vec4(1,0,0,1));var m=new o.GameObject("planeForward");m.transform.parent=e.transform;var y=p.createPlane(m,o.glmath.vec3(0,0,-10),o.vec3.forward);r.addObj(y),m.render.material=n.clone(),y.setColor(o.vec4.one);var v=new o.GameObject("planeBack");v.transform.parent=e.transform;var _=p.createPlane(v,o.glmath.vec3(0,0,10),o.vec3.back);r.addObj(_),v.render.material=n.clone(),_.setColor(o.vec4.one);var g=new o.GameObject("sphLight");g.transform.parent=e.transform;var b=p.createSphere(g,o.glmath.vec3(0,9,-6),5);r.addObj(b),g.render.material=n.clone(),b.setColor(o.glmath.vec4(1,1,1,1)),b.setMatParam(10,0,0,1);var w=new o.GameObject("sphDiffuse");w.transform.parent=e.transform;b=p.createSphere(w,o.glmath.vec3(0,0,-7),1);r.addObj(b),w.render.material=n.clone(),b.setColor(o.glmath.vec4(1,1,1,1));var T=new o.GameObject("sphReflective");T.transform.parent=e.transform;b=p.createSphere(T,o.glmath.vec3(-3,-3,-7),1.5);r.addObj(b),T.render.material=n.clone(),b.setColor(o.glmath.vec4(1,1,1,1)),b.setMatParam(0,1,0,1);var E=new o.GameObject("Refractive");E.transform.parent=e.transform;b=p.createSphere(E,o.glmath.vec3(3,-2,-6),2);r.addObj(b),E.render.material=n.clone(),b.setColor(o.glmath.vec4(1,1,1,1)),b.setMatParam(0,0,1,5),r.setDirty()},e.prototype.onFrame=function(e){this.m_sceneMgr.onFrame(this.m_scene),this.grender.render(this.m_scene,e)},e.prototype.onRelease=function(){},i.b([Object(o.DebugEntry)("test")],e,"test",null),e}()),c=function(e){function t(){return e.call(this,808)||this}return i.c(t,e),t.prototype.setData=function(e,t){var n=80*t,i=e.gobj.transform,o=this.buffer;o.setVec3(n,i.position),e.type==r.Sphere?o.setFloat(n+12,e.sphereRadius):o.setVec3(n+16,i.forward),o.setVec4(n+32,e.color),o.setUint32(n+48,e.type),o.setVec4(n+64,e.matParam)},t.prototype.setIter=function(e){var t=e/(1+e);this.buffer.setFloat(800,t)},t.prototype.setGeomCount=function(e){this.buffer.setUint32(804,e)},t.BUFFER_NAME="CSG_DATA",t}(o.ShaderData);!function(e){e[e.Sphere=0]="Sphere",e[e.Plane=1]="Plane"}(r||(r={}));var f=function(){function e(){this.csgobjs=[],this.m_isdirty=!0,this.m_data=new c}return Object.defineProperty(e.prototype,"data",{get:function(){return this.m_data},enumerable:!0,configurable:!0}),e.prototype.addObj=function(e){this.csgobjs.push(e),this.csgobjs.sort(function(e,t){return e.type-t.type})},e.prototype.setDirty=function(){this.m_isdirty=!0},e.prototype.updateUniformData=function(e,t){var n=this.m_data;if(this.m_isdirty){for(var r=this.csgobjs,i=0,o=r.length;i<o;i++)n.setData(r[i],i);this.m_isdirty=!1,n.setGeomCount(r.length)}n.submitBuffer(t,e)},e}(),p=function(){function e(){this.type=r.Sphere,this.color=o.Utility.randomColor(),this.matParam=o.glmath.vec4(0,0,0,1),this.sphereRadius=1}return e.prototype.setColor=function(e){this.color=e,this.gobj.render.material.setColor(o.ShaderFX.UNIFORM_MAIN_COLOR,e)},e.prototype.setMatParam=function(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1);var i=this.matParam;i.x=e,i.y=t,i.z=n,i.w=r},e.createSphere=function(t,n,i){void 0===i&&(i=1);var a=new e;return a.type=r.Sphere,a.gobj=t,a.sphereRadius=i,t.transform.localPosition=n,t.transform.localScale=o.vec3.one.mulNum(i),t.render=new s.MeshRender(o.Mesh.Sphere),a},e.createPlane=function(t,n,i){var a=new e;return a.gobj=t,a.type=r.Plane,t.transform.setPosition(n),t.transform.forward=i,t.transform.setScale(o.glmath.vec3(50,50,50)),t.render=new s.MeshRender(o.Mesh.Quad),a},e}()},function(e,t,n){n(48),e.exports=n(53)},function(e,t,n){"use strict";"undefined"===typeof Promise&&(n(49).enable(),window.Promise=n(51)),n(52),Object.assign=n(18)},function(e,t,n){"use strict";var r=n(26),i=[ReferenceError,TypeError,RangeError],o=!1;function a(){o=!1,r._47=null,r._71=null}function u(e,t){return t.some(function(t){return e instanceof t})}t.disable=a,t.enable=function(e){e=e||{},o&&a();o=!0;var t=0,n=0,s={};function l(t){(e.allRejections||u(s[t].error,e.whitelist||i))&&(s[t].displayId=n++,e.onUnhandled?(s[t].logged=!0,e.onUnhandled(s[t].displayId,s[t].error)):(s[t].logged=!0,function(e,t){console.warn("Possible Unhandled Promise Rejection (id: "+e+"):"),((t&&(t.stack||t))+"").split("\n").forEach(function(e){console.warn("  "+e)})}(s[t].displayId,s[t].error)))}r._47=function(t){2===t._83&&s[t._56]&&(s[t._56].logged?function(t){s[t].logged&&(e.onHandled?e.onHandled(s[t].displayId,s[t].error):s[t].onUnhandled||(console.warn("Promise Rejection Handled (id: "+s[t].displayId+"):"),console.warn('  This means you can ignore any previous messages of the form "Possible Unhandled Promise Rejection" with id '+s[t].displayId+".")))}(t._56):clearTimeout(s[t._56].timeout),delete s[t._56])},r._71=function(e,n){0===e._75&&(e._56=t++,s[e._56]={displayId:null,error:n,timeout:setTimeout(l.bind(null,e._56),u(n,i)?100:2e3),logged:!1})}}},function(e,t,n){"use strict";(function(t){function n(e){i.length||(r(),!0),i[i.length]=e}e.exports=n;var r,i=[],o=0,a=1024;function u(){for(;o<i.length;){var e=o;if(o+=1,i[e].call(),o>a){for(var t=0,n=i.length-o;t<n;t++)i[t]=i[t+o];i.length-=o,o=0}}i.length=0,o=0,!1}var s="undefined"!==typeof t?t:self,l=s.MutationObserver||s.WebKitMutationObserver;function c(e){return function(){var t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}r="function"===typeof l?function(e){var t=1,n=new l(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}(u):c(u),n.requestFlush=r,n.makeRequestCallFromTimer=c}).call(t,n(27))},function(e,t,n){"use strict";var r=n(26);e.exports=r;var i=c(!0),o=c(!1),a=c(null),u=c(void 0),s=c(0),l=c("");function c(e){var t=new r(r._44);return t._83=1,t._18=e,t}r.resolve=function(e){if(e instanceof r)return e;if(null===e)return a;if(void 0===e)return u;if(!0===e)return i;if(!1===e)return o;if(0===e)return s;if(""===e)return l;if("object"===typeof e||"function"===typeof e)try{var t=e.then;if("function"===typeof t)return new r(t.bind(e))}catch(e){return new r(function(t,n){n(e)})}return c(e)},r.all=function(e){var t=Array.prototype.slice.call(e);return new r(function(e,n){if(0===t.length)return e([]);var i=t.length;function o(a,u){if(u&&("object"===typeof u||"function"===typeof u)){if(u instanceof r&&u.then===r.prototype.then){for(;3===u._83;)u=u._18;return 1===u._83?o(a,u._18):(2===u._83&&n(u._18),void u.then(function(e){o(a,e)},n))}var s=u.then;if("function"===typeof s)return void new r(s.bind(u)).then(function(e){o(a,e)},n)}t[a]=u,0===--i&&e(t)}for(var a=0;a<t.length;a++)o(a,t[a])})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(t,n){e.forEach(function(e){r.resolve(e).then(t,n)})})},r.prototype.catch=function(e){return this.then(null,e)}},function(e,t){!function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(e){return e&&DataView.prototype.isPrototypeOf(e)},i=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};c.prototype.append=function(e,t){e=u(e),t=s(t);var n=this.map[e];this.map[e]=n?n+","+t:t},c.prototype.delete=function(e){delete this.map[u(e)]},c.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},c.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},c.prototype.set=function(e,t){this.map[u(e)]=s(t)},c.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},c.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),l(e)},c.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),l(e)},c.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),l(e)},t.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},m.call(y.prototype),m.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e};var a=[301,302,303,307,308];_.redirect=function(e,t){if(-1===a.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},e.Headers=c,e.Request=y,e.Response=_,e.fetch=function(e,n){return new Promise(function(r,i){var o=new y(e,n),a=new XMLHttpRequest;a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:function(e){var t=new c;return e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}}),t}(a.getAllResponseHeaders()||"")};e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL");var t="response"in a?a.response:a.responseText;r(new _(t,e))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.open(o.method,o.url,!0),"include"===o.credentials&&(a.withCredentials=!0),"responseType"in a&&t.blob&&(a.responseType="blob"),o.headers.forEach(function(e,t){a.setRequestHeader(t,e)}),a.send("undefined"===typeof o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}function u(e){if("string"!==typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function s(e){return"string"!==typeof e&&(e=String(e)),e}function l(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(n[Symbol.iterator]=function(){return n}),n}function c(e){this.map={},e instanceof c?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function f(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function h(e){var t=new FileReader,n=p(t);return t.readAsArrayBuffer(e),n}function d(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"===typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&r(e))this._bodyArrayBuffer=d(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!i(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=d(e)}else this._bodyText="";this.headers.get("content-type")||("string"===typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=p(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}function y(e,t){var n=(t=t||{}).body;if(e instanceof y){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new c(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new c(t.headers)),this.method=function(e){var t=e.toUpperCase();return o.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function v(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}function _(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new c(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!==typeof self?self:this)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),i=(n.n(r),n(55)),o=(n.n(i),n(59)),a=n(77),u=(n.n(a),n(78));i.render(r.createElement(o.a,null),document.getElementById("root")),Object(u.a)()},function(e,t,n){"use strict";var r=n(18),i="function"===typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,a=i?Symbol.for("react.portal"):60106,u=i?Symbol.for("react.fragment"):60107,s=i?Symbol.for("react.strict_mode"):60108,l=i?Symbol.for("react.profiler"):60114,c=i?Symbol.for("react.provider"):60109,f=i?Symbol.for("react.context"):60110,p=i?Symbol.for("react.concurrent_mode"):60111,h=i?Symbol.for("react.forward_ref"):60112,d=i?Symbol.for("react.suspense"):60113,m=i?Symbol.for("react.memo"):60115,y=i?Symbol.for("react.lazy"):60116,v="function"===typeof Symbol&&Symbol.iterator;function _(e){for(var t=arguments.length-1,n="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=0;r<t;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);!function(e,t,n,r,i,o,a,u){if(!e){if(e=void 0,void 0===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=[n,r,i,o,a,u],l=0;(e=Error(t.replace(/%s/g,function(){return s[l++]}))).name="Invariant Violation"}throw e.framesToPop=1,e}}(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function w(e,t,n){this.props=e,this.context=t,this.refs=b,this.updater=n||g}function T(){}function E(e,t,n){this.props=e,this.context=t,this.refs=b,this.updater=n||g}w.prototype.isReactComponent={},w.prototype.setState=function(e,t){"object"!==typeof e&&"function"!==typeof e&&null!=e&&_("85"),this.updater.enqueueSetState(this,e,t,"setState")},w.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},T.prototype=w.prototype;var R=E.prototype=new T;R.constructor=E,r(R,w.prototype),R.isPureReactComponent=!0;var x={current:null,currentDispatcher:null},S=Object.prototype.hasOwnProperty,P={key:!0,ref:!0,__self:!0,__source:!0};function A(e,t,n){var r=void 0,i={},a=null,u=null;if(null!=t)for(r in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(a=""+t.key),t)S.call(t,r)&&!P.hasOwnProperty(r)&&(i[r]=t[r]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var l=Array(s),c=0;c<s;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===i[r]&&(i[r]=s[r]);return{$$typeof:o,type:e,key:a,ref:u,props:i,_owner:x.current}}function F(e){return"object"===typeof e&&null!==e&&e.$$typeof===o}var D=/\/+/g,O=[];function M(e,t,n,r){if(O.length){var i=O.pop();return i.result=e,i.keyPrefix=t,i.func=n,i.context=r,i.count=0,i}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function C(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>O.length&&O.push(e)}function U(e,t,n){return null==e?0:function e(t,n,r,i){var u=typeof t;"undefined"!==u&&"boolean"!==u||(t=null);var s=!1;if(null===t)s=!0;else switch(u){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case o:case a:s=!0}}if(s)return r(i,t,""===n?"."+I(t,0):n),1;if(s=0,n=""===n?".":n+":",Array.isArray(t))for(var l=0;l<t.length;l++){var c=n+I(u=t[l],l);s+=e(u,c,r,i)}else if(c=null===t||"object"!==typeof t?null:"function"===typeof(c=v&&t[v]||t["@@iterator"])?c:null,"function"===typeof c)for(t=c.call(t),l=0;!(u=t.next()).done;)s+=e(u=u.value,c=n+I(u,l++),r,i);else"object"===u&&_("31","[object Object]"===(r=""+t)?"object with keys {"+Object.keys(t).join(", ")+"}":r,"");return s}(e,"",t,n)}function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(e){return t[e]})}(e.key):t.toString(36)}function B(e,t){e.func.call(e.context,t,e.count++)}function k(e,t,n){var r=e.result,i=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?L(e,r,n,function(e){return e}):null!=e&&(F(e)&&(e=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,i+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(D,"$&/")+"/")+n)),r.push(e))}function L(e,t,n,r,i){var o="";null!=n&&(o=(""+n).replace(D,"$&/")+"/"),U(e,k,t=M(t,o,r,i)),C(t)}var N={Children:{map:function(e,t,n){if(null==e)return e;var r=[];return L(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;U(e,B,t=M(null,null,t,n)),C(t)},count:function(e){return U(e,function(){return null},null)},toArray:function(e){var t=[];return L(e,t,null,function(e){return e}),t},only:function(e){return F(e)||_("143"),e}},createRef:function(){return{current:null}},Component:w,PureComponent:E,createContext:function(e,t){return void 0===t&&(t=null),(e={$$typeof:f,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,Provider:null,Consumer:null}).Provider={$$typeof:c,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:h,render:e}},lazy:function(e){return{$$typeof:y,_ctor:e,_status:-1,_result:null}},memo:function(e,t){return{$$typeof:m,type:e,compare:void 0===t?null:t}},Fragment:u,StrictMode:s,Suspense:d,createElement:A,cloneElement:function(e,t,n){(null===e||void 0===e)&&_("267",e);var i=void 0,a=r({},e.props),u=e.key,s=e.ref,l=e._owner;if(null!=t){void 0!==t.ref&&(s=t.ref,l=x.current),void 0!==t.key&&(u=""+t.key);var c=void 0;for(i in e.type&&e.type.defaultProps&&(c=e.type.defaultProps),t)S.call(t,i)&&!P.hasOwnProperty(i)&&(a[i]=void 0===t[i]&&void 0!==c?c[i]:t[i])}if(1===(i=arguments.length-2))a.children=n;else if(1<i){c=Array(i);for(var f=0;f<i;f++)c[f]=arguments[f+2];a.children=c}return{$$typeof:o,type:e.type,key:u,ref:s,props:a,_owner:l}},createFactory:function(e){var t=A.bind(null,e);return t.type=e,t},isValidElement:F,version:"16.6.1",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:x,assign:r}};N.unstable_ConcurrentMode=p,N.unstable_Profiler=l;var j={default:N},z=j&&N||j;e.exports=z.default||z},function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(56)},function(e,t,n){"use strict";var r=n(14),i=n(18),o=n(57);function a(e){for(var t=arguments.length-1,n="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=0;r<t;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);!function(e,t,n,r,i,o,a,u){if(!e){if(e=void 0,void 0===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=[n,r,i,o,a,u],l=0;(e=Error(t.replace(/%s/g,function(){return s[l++]}))).name="Invariant Violation"}throw e.framesToPop=1,e}}(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}r||a("227");var u=!1,s=null,l=!1,c=null,f={onError:function(e){u=!0,s=e}};function p(e,t,n,r,i,o,a,l,c){u=!1,s=null,function(e,t,n,r,i,o,a,u,s){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(e){this.onError(e)}}.apply(f,arguments)}var h=null,d={};function m(){if(h)for(var e in d){var t=d[e],n=h.indexOf(e);if(-1<n||a("96",e),!v[n])for(var r in t.extractEvents||a("97",e),v[n]=t,n=t.eventTypes){var i=void 0,o=n[r],u=t,s=r;_.hasOwnProperty(s)&&a("99",s),_[s]=o;var l=o.phasedRegistrationNames;if(l){for(i in l)l.hasOwnProperty(i)&&y(l[i],u,s);i=!0}else o.registrationName?(y(o.registrationName,u,s),i=!0):i=!1;i||a("98",r,e)}}}function y(e,t,n){g[e]&&a("100",e),g[e]=t,b[e]=t.eventTypes[n].dependencies}var v=[],_={},g={},b={},w=null,T=null,E=null;function R(e,t,n){var r=e.type||"unknown-event";e.currentTarget=E(n),function(e,t,n,r,i,o,f,h,d){if(p.apply(this,arguments),u){if(u){var m=s;u=!1,s=null}else a("198"),m=void 0;l||(l=!0,c=m)}}(r,t,void 0,e),e.currentTarget=null}function x(e,t){return null==t&&a("30"),null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function S(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}var P=null;function A(e){if(e){var t=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(t))for(var r=0;r<t.length&&!e.isPropagationStopped();r++)R(e,t[r],n[r]);else t&&R(e,t,n);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}var F={injectEventPluginOrder:function(e){h&&a("101"),h=Array.prototype.slice.call(e),m()},injectEventPluginsByName:function(e){var t,n=!1;for(t in e)if(e.hasOwnProperty(t)){var r=e[t];d.hasOwnProperty(t)&&d[t]===r||(d[t]&&a("102",t),d[t]=r,n=!0)}n&&m()}};function D(e,t){var n=e.stateNode;if(!n)return null;var r=w(n);if(!r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}return e?null:(n&&"function"!==typeof n&&a("231",t,typeof n),n)}function O(e){if(null!==e&&(P=x(P,e)),e=P,P=null,e&&(S(e,A),P&&a("95"),l))throw e=c,l=!1,c=null,e}var M=Math.random().toString(36).slice(2),C="__reactInternalInstance$"+M,U="__reactEventHandlers$"+M;function I(e){if(e[C])return e[C];for(;!e[C];){if(!e.parentNode)return null;e=e.parentNode}return 5===(e=e[C]).tag||6===e.tag?e:null}function B(e){return!(e=e[C])||5!==e.tag&&6!==e.tag?null:e}function k(e){if(5===e.tag||6===e.tag)return e.stateNode;a("33")}function L(e){return e[U]||null}function N(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function j(e,t,n){(t=D(e,n.dispatchConfig.phasedRegistrationNames[t]))&&(n._dispatchListeners=x(n._dispatchListeners,t),n._dispatchInstances=x(n._dispatchInstances,e))}function z(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,n=[];t;)n.push(t),t=N(t);for(t=n.length;0<t--;)j(n[t],"captured",e);for(t=0;t<n.length;t++)j(n[t],"bubbled",e)}}function X(e,t,n){e&&n&&n.dispatchConfig.registrationName&&(t=D(e,n.dispatchConfig.registrationName))&&(n._dispatchListeners=x(n._dispatchListeners,t),n._dispatchInstances=x(n._dispatchInstances,e))}function G(e){e&&e.dispatchConfig.registrationName&&X(e._targetInst,null,e)}function V(e){S(e,z)}var H=!("undefined"===typeof window||!window.document||!window.document.createElement);function W(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Y={animationend:W("Animation","AnimationEnd"),animationiteration:W("Animation","AnimationIteration"),animationstart:W("Animation","AnimationStart"),transitionend:W("Transition","TransitionEnd")},q={},Q={};function K(e){if(q[e])return q[e];if(!Y[e])return e;var t,n=Y[e];for(t in n)if(n.hasOwnProperty(t)&&t in Q)return q[e]=n[t];return e}H&&(Q=document.createElement("div").style,"AnimationEvent"in window||(delete Y.animationend.animation,delete Y.animationiteration.animation,delete Y.animationstart.animation),"TransitionEvent"in window||delete Y.transitionend.transition);var $=K("animationend"),J=K("animationiteration"),Z=K("animationstart"),ee=K("transitionend"),te="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ne=null,re=null,ie=null;function oe(){if(ie)return ie;var e,t,n=re,r=n.length,i="value"in ne?ne.value:ne.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return ie=i.slice(e,1<t?1-t:void 0)}function ae(){return!0}function ue(){return!1}function se(e,t,n,r){for(var i in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n,e=this.constructor.Interface)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?ae:ue,this.isPropagationStopped=ue,this}function le(e,t,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,n,r),i}return new this(e,t,n,r)}function ce(e){e instanceof this||a("279"),e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function fe(e){e.eventPool=[],e.getPooled=le,e.release=ce}i(se.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ae)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ae)},persist:function(){this.isPersistent=ae},isPersistent:ue,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=ue,this._dispatchInstances=this._dispatchListeners=null}}),se.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},se.extend=function(e){function t(){}function n(){return r.apply(this,arguments)}var r=this;t.prototype=r.prototype;var o=new t;return i(o,n.prototype),n.prototype=o,n.prototype.constructor=n,n.Interface=i({},r.Interface,e),n.extend=r.extend,fe(n),n},fe(se);var pe=se.extend({data:null}),he=se.extend({data:null}),de=[9,13,27,32],me=H&&"CompositionEvent"in window,ye=null;H&&"documentMode"in document&&(ye=document.documentMode);var ve=H&&"TextEvent"in window&&!ye,_e=H&&(!me||ye&&8<ye&&11>=ye),ge=String.fromCharCode(32),be={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},we=!1;function Te(e,t){switch(e){case"keyup":return-1!==de.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function Ee(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Re=!1;var xe={eventTypes:be,extractEvents:function(e,t,n,r){var i=void 0,o=void 0;if(me)e:{switch(e){case"compositionstart":i=be.compositionStart;break e;case"compositionend":i=be.compositionEnd;break e;case"compositionupdate":i=be.compositionUpdate;break e}i=void 0}else Re?Te(e,n)&&(i=be.compositionEnd):"keydown"===e&&229===n.keyCode&&(i=be.compositionStart);return i?(_e&&"ko"!==n.locale&&(Re||i!==be.compositionStart?i===be.compositionEnd&&Re&&(o=oe()):(re="value"in(ne=r)?ne.value:ne.textContent,Re=!0)),i=pe.getPooled(i,t,n,r),o?i.data=o:null!==(o=Ee(n))&&(i.data=o),V(i),o=i):o=null,(e=ve?function(e,t){switch(e){case"compositionend":return Ee(t);case"keypress":return 32!==t.which?null:(we=!0,ge);case"textInput":return(e=t.data)===ge&&we?null:e;default:return null}}(e,n):function(e,t){if(Re)return"compositionend"===e||!me&&Te(e,t)?(e=oe(),ie=re=ne=null,Re=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _e&&"ko"!==t.locale?null:t.data;default:return null}}(e,n))?((t=he.getPooled(be.beforeInput,t,n,r)).data=e,V(t)):t=null,null===o?t:null===t?o:[o,t]}},Se=null,Pe=null,Ae=null;function Fe(e){if(e=T(e)){"function"!==typeof Se&&a("280");var t=w(e.stateNode);Se(e.stateNode,e.type,t)}}function De(e){Pe?Ae?Ae.push(e):Ae=[e]:Pe=e}function Oe(){if(Pe){var e=Pe,t=Ae;if(Ae=Pe=null,Fe(e),t)for(e=0;e<t.length;e++)Fe(t[e])}}function Me(e,t){return e(t)}function Ce(e,t,n){return e(t,n)}function Ue(){}var Ie=!1;function Be(e,t){if(Ie)return e(t);Ie=!0;try{return Me(e,t)}finally{Ie=!1,(null!==Pe||null!==Ae)&&(Ue(),Oe())}}var ke={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Le(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!ke[e.type]:"textarea"===t}function Ne(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function je(e){if(!H)return!1;var t=(e="on"+e)in document;return t||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"===typeof t[e]),t}function ze(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Xe(e){e._valueTracker||(e._valueTracker=function(e){var t=ze(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Ge(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ze(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}var Ve=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,He=/^(.*)[\\\/]/,We="function"===typeof Symbol&&Symbol.for,Ye=We?Symbol.for("react.element"):60103,qe=We?Symbol.for("react.portal"):60106,Qe=We?Symbol.for("react.fragment"):60107,Ke=We?Symbol.for("react.strict_mode"):60108,$e=We?Symbol.for("react.profiler"):60114,Je=We?Symbol.for("react.provider"):60109,Ze=We?Symbol.for("react.context"):60110,et=We?Symbol.for("react.concurrent_mode"):60111,tt=We?Symbol.for("react.forward_ref"):60112,nt=We?Symbol.for("react.suspense"):60113,rt=We?Symbol.for("react.memo"):60115,it=We?Symbol.for("react.lazy"):60116,ot="function"===typeof Symbol&&Symbol.iterator;function at(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=ot&&e[ot]||e["@@iterator"])?e:null}function ut(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case et:return"ConcurrentMode";case Qe:return"Fragment";case qe:return"Portal";case $e:return"Profiler";case Ke:return"StrictMode";case nt:return"Suspense"}if("object"===typeof e)switch(e.$$typeof){case Ze:return"Context.Consumer";case Je:return"Context.Provider";case tt:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case rt:return ut(e.type);case it:if(e=1===e._status?e._result:null)return ut(e)}return null}function st(e){var t="";do{e:switch(e.tag){case 2:case 16:case 0:case 1:case 5:case 8:case 13:var n=e._debugOwner,r=e._debugSource,i=ut(e.type),o=null;n&&(o=ut(n.type)),n=i,i="",r?i=" (at "+r.fileName.replace(He,"")+":"+r.lineNumber+")":o&&(i=" (created by "+o+")"),o="\n    in "+(n||"Unknown")+i;break e;default:o=""}t+=o,e=e.return}while(e);return t}var lt=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ct=Object.prototype.hasOwnProperty,ft={},pt={};function ht(e,t,n,r,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t}var dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){dt[e]=new ht(e,0,!1,e,null)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];dt[t]=new ht(t,1,!1,e[1],null)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){dt[e]=new ht(e,2,!1,e.toLowerCase(),null)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){dt[e]=new ht(e,2,!1,e,null)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){dt[e]=new ht(e,3,!1,e.toLowerCase(),null)}),["checked","multiple","muted","selected"].forEach(function(e){dt[e]=new ht(e,3,!0,e,null)}),["capture","download"].forEach(function(e){dt[e]=new ht(e,4,!1,e,null)}),["cols","rows","size","span"].forEach(function(e){dt[e]=new ht(e,6,!1,e,null)}),["rowSpan","start"].forEach(function(e){dt[e]=new ht(e,5,!1,e.toLowerCase(),null)});var mt=/[\-:]([a-z])/g;function yt(e){return e[1].toUpperCase()}function vt(e,t,n,r){var i=dt.hasOwnProperty(t)?dt[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!ct.call(pt,e)||!ct.call(ft,e)&&(lt.test(e)?pt[e]=!0:(ft[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}function _t(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function gt(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function bt(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=_t(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function wt(e,t){null!=(t=t.checked)&&vt(e,"checked",t,!1)}function Tt(e,t){wt(e,t);var n=_t(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?Rt(e,t.type,n):t.hasOwnProperty("defaultValue")&&Rt(e,t.type,_t(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Et(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!e.defaultChecked,e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function Rt(e,t,n){"number"===t&&e.ownerDocument.activeElement===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(mt,yt);dt[t]=new ht(t,1,!1,e,null)}),"xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(mt,yt);dt[t]=new ht(t,1,!1,e,"http://www.w3.org/1999/xlink")}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(mt,yt);dt[t]=new ht(t,1,!1,e,"http://www.w3.org/XML/1998/namespace")}),dt.tabIndex=new ht("tabIndex",1,!1,"tabindex",null);var xt={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function St(e,t,n){return(e=se.getPooled(xt.change,e,t,n)).type="change",De(n),V(e),e}var Pt=null,At=null;function Ft(e){O(e)}function Dt(e){if(Ge(k(e)))return e}function Ot(e,t){if("change"===e)return t}var Mt=!1;function Ct(){Pt&&(Pt.detachEvent("onpropertychange",Ut),At=Pt=null)}function Ut(e){"value"===e.propertyName&&Dt(At)&&Be(Ft,e=St(At,e,Ne(e)))}function It(e,t,n){"focus"===e?(Ct(),At=n,(Pt=t).attachEvent("onpropertychange",Ut)):"blur"===e&&Ct()}function Bt(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Dt(At)}function kt(e,t){if("click"===e)return Dt(t)}function Lt(e,t){if("input"===e||"change"===e)return Dt(t)}H&&(Mt=je("input")&&(!document.documentMode||9<document.documentMode));var Nt={eventTypes:xt,_isInputEventSupported:Mt,extractEvents:function(e,t,n,r){var i=t?k(t):window,o=void 0,a=void 0,u=i.nodeName&&i.nodeName.toLowerCase();if("select"===u||"input"===u&&"file"===i.type?o=Ot:Le(i)?Mt?o=Lt:(o=Bt,a=It):(u=i.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(o=kt),o&&(o=o(e,t)))return St(o,n,r);a&&a(e,i,t),"blur"===e&&(e=i._wrapperState)&&e.controlled&&"number"===i.type&&Rt(i,"number",i.value)}},jt=se.extend({view:null,detail:null}),zt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xt(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=zt[e])&&!!t[e]}function Gt(){return Xt}var Vt=0,Ht=0,Wt=!1,Yt=!1,qt=jt.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Gt,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=Vt;return Vt=e.screenX,Wt?"mousemove"===e.type?e.screenX-t:0:(Wt=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=Ht;return Ht=e.screenY,Yt?"mousemove"===e.type?e.screenY-t:0:(Yt=!0,0)}}),Qt=qt.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Kt={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},$t={eventTypes:Kt,extractEvents:function(e,t,n,r){var i="mouseover"===e||"pointerover"===e,o="mouseout"===e||"pointerout"===e;if(i&&(n.relatedTarget||n.fromElement)||!o&&!i)return null;if(i=r.window===r?r:(i=r.ownerDocument)?i.defaultView||i.parentWindow:window,o?(o=t,t=(t=n.relatedTarget||n.toElement)?I(t):null):o=null,o===t)return null;var a=void 0,u=void 0,s=void 0,l=void 0;"mouseout"===e||"mouseover"===e?(a=qt,u=Kt.mouseLeave,s=Kt.mouseEnter,l="mouse"):"pointerout"!==e&&"pointerover"!==e||(a=Qt,u=Kt.pointerLeave,s=Kt.pointerEnter,l="pointer");var c=null==o?i:k(o);if(i=null==t?i:k(t),(e=a.getPooled(u,o,n,r)).type=l+"leave",e.target=c,e.relatedTarget=i,(n=a.getPooled(s,t,n,r)).type=l+"enter",n.target=i,n.relatedTarget=c,r=t,o&&r)e:{for(i=r,l=0,a=t=o;a;a=N(a))l++;for(a=0,s=i;s;s=N(s))a++;for(;0<l-a;)t=N(t),l--;for(;0<a-l;)i=N(i),a--;for(;l--;){if(t===i||t===i.alternate)break e;t=N(t),i=N(i)}t=null}else t=null;for(i=t,t=[];o&&o!==i&&(null===(l=o.alternate)||l!==i);)t.push(o),o=N(o);for(o=[];r&&r!==i&&(null===(l=r.alternate)||l!==i);)o.push(r),r=N(r);for(r=0;r<t.length;r++)X(t[r],"bubbled",e);for(r=o.length;0<r--;)X(o[r],"captured",n);return[e,n]}},Jt=Object.prototype.hasOwnProperty;function Zt(e,t){return e===t?0!==e||0!==t||1/e===1/t:e!==e&&t!==t}function en(e,t){if(Zt(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Jt.call(t,n[r])||!Zt(e[n[r]],t[n[r]]))return!1;return!0}function tn(e){var t=e;if(e.alternate)for(;t.return;)t=t.return;else{if(0!==(2&t.effectTag))return 1;for(;t.return;)if(0!==(2&(t=t.return).effectTag))return 1}return 3===t.tag?2:3}function nn(e){2!==tn(e)&&a("188")}function rn(e){if(!(e=function(e){var t=e.alternate;if(!t)return 3===(t=tn(e))&&a("188"),1===t?null:e;for(var n=e,r=t;;){var i=n.return,o=i?i.alternate:null;if(!i||!o)break;if(i.child===o.child){for(var u=i.child;u;){if(u===n)return nn(i),e;if(u===r)return nn(i),t;u=u.sibling}a("188")}if(n.return!==r.return)n=i,r=o;else{u=!1;for(var s=i.child;s;){if(s===n){u=!0,n=i,r=o;break}if(s===r){u=!0,r=i,n=o;break}s=s.sibling}if(!u){for(s=o.child;s;){if(s===n){u=!0,n=o,r=i;break}if(s===r){u=!0,r=o,n=i;break}s=s.sibling}u||a("189")}}n.alternate!==r&&a("190")}return 3!==n.tag&&a("188"),n.stateNode.current===n?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}var on=se.extend({animationName:null,elapsedTime:null,pseudoElement:null}),an=se.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),un=jt.extend({relatedTarget:null});function sn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}var ln={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fn=jt.extend({key:function(e){if(e.key){var t=ln[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=sn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?cn[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Gt,charCode:function(e){return"keypress"===e.type?sn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?sn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),pn=qt.extend({dataTransfer:null}),hn=jt.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Gt}),dn=se.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),mn=qt.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),yn=[["abort","abort"],[$,"animationEnd"],[J,"animationIteration"],[Z,"animationStart"],["canplay","canPlay"],["canplaythrough","canPlayThrough"],["drag","drag"],["dragenter","dragEnter"],["dragexit","dragExit"],["dragleave","dragLeave"],["dragover","dragOver"],["durationchange","durationChange"],["emptied","emptied"],["encrypted","encrypted"],["ended","ended"],["error","error"],["gotpointercapture","gotPointerCapture"],["load","load"],["loadeddata","loadedData"],["loadedmetadata","loadedMetadata"],["loadstart","loadStart"],["lostpointercapture","lostPointerCapture"],["mousemove","mouseMove"],["mouseout","mouseOut"],["mouseover","mouseOver"],["playing","playing"],["pointermove","pointerMove"],["pointerout","pointerOut"],["pointerover","pointerOver"],["progress","progress"],["scroll","scroll"],["seeking","seeking"],["stalled","stalled"],["suspend","suspend"],["timeupdate","timeUpdate"],["toggle","toggle"],["touchmove","touchMove"],[ee,"transitionEnd"],["waiting","waiting"],["wheel","wheel"]],vn={},_n={};function gn(e,t){var n=e[0],r="on"+((e=e[1])[0].toUpperCase()+e.slice(1));t={phasedRegistrationNames:{bubbled:r,captured:r+"Capture"},dependencies:[n],isInteractive:t},vn[e]=t,_n[n]=t}[["blur","blur"],["cancel","cancel"],["click","click"],["close","close"],["contextmenu","contextMenu"],["copy","copy"],["cut","cut"],["auxclick","auxClick"],["dblclick","doubleClick"],["dragend","dragEnd"],["dragstart","dragStart"],["drop","drop"],["focus","focus"],["input","input"],["invalid","invalid"],["keydown","keyDown"],["keypress","keyPress"],["keyup","keyUp"],["mousedown","mouseDown"],["mouseup","mouseUp"],["paste","paste"],["pause","pause"],["play","play"],["pointercancel","pointerCancel"],["pointerdown","pointerDown"],["pointerup","pointerUp"],["ratechange","rateChange"],["reset","reset"],["seeked","seeked"],["submit","submit"],["touchcancel","touchCancel"],["touchend","touchEnd"],["touchstart","touchStart"],["volumechange","volumeChange"]].forEach(function(e){gn(e,!0)}),yn.forEach(function(e){gn(e,!1)});var bn={eventTypes:vn,isInteractiveTopLevelEventType:function(e){return void 0!==(e=_n[e])&&!0===e.isInteractive},extractEvents:function(e,t,n,r){var i=_n[e];if(!i)return null;switch(e){case"keypress":if(0===sn(n))return null;case"keydown":case"keyup":e=fn;break;case"blur":case"focus":e=un;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=qt;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=hn;break;case $:case J:case Z:e=on;break;case ee:e=dn;break;case"scroll":e=jt;break;case"wheel":e=mn;break;case"copy":case"cut":case"paste":e=an;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=Qt;break;default:e=se}return V(t=e.getPooled(i,t,n,r)),t}},wn=bn.isInteractiveTopLevelEventType,Tn=[];function En(e){var t=e.targetInst,n=t;do{if(!n){e.ancestors.push(n);break}var r;for(r=n;r.return;)r=r.return;if(!(r=3!==r.tag?null:r.stateNode.containerInfo))break;e.ancestors.push(n),n=I(r)}while(n);for(n=0;n<e.ancestors.length;n++){t=e.ancestors[n];var i=Ne(e.nativeEvent);r=e.topLevelType;for(var o=e.nativeEvent,a=null,u=0;u<v.length;u++){var s=v[u];s&&(s=s.extractEvents(r,t,o,i))&&(a=x(a,s))}O(a)}}var Rn=!0;function xn(e,t){if(!t)return null;var n=(wn(e)?Pn:An).bind(null,e);t.addEventListener(e,n,!1)}function Sn(e,t){if(!t)return null;var n=(wn(e)?Pn:An).bind(null,e);t.addEventListener(e,n,!0)}function Pn(e,t){Ce(An,e,t)}function An(e,t){if(Rn){var n=Ne(t);if(null===(n=I(n))||"number"!==typeof n.tag||2===tn(n)||(n=null),Tn.length){var r=Tn.pop();r.topLevelType=e,r.nativeEvent=t,r.targetInst=n,e=r}else e={topLevelType:e,nativeEvent:t,targetInst:n,ancestors:[]};try{Be(En,e)}finally{e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>Tn.length&&Tn.push(e)}}}var Fn={},Dn=0,On="_reactListenersID"+(""+Math.random()).slice(2);function Mn(e){return Object.prototype.hasOwnProperty.call(e,On)||(e[On]=Dn++,Fn[e[On]]={}),Fn[e[On]]}function Cn(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Un(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function In(e,t){var n,r=Un(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Un(r)}}function Bn(){for(var e=window,t=Cn();t instanceof e.HTMLIFrameElement;){try{e=t.contentDocument.defaultView}catch(e){break}t=Cn(e.document)}return t}function kn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var Ln=H&&"documentMode"in document&&11>=document.documentMode,Nn={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},jn=null,zn=null,Xn=null,Gn=!1;function Vn(e,t){var n=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return Gn||null==jn||jn!==Cn(n)?null:("selectionStart"in(n=jn)&&kn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Xn&&en(Xn,n)?null:(Xn=n,(e=se.getPooled(Nn.select,zn,e,t)).type="select",e.target=jn,V(e),e))}var Hn={eventTypes:Nn,extractEvents:function(e,t,n,r){var i,o=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;if(!(i=!o)){e:{o=Mn(o),i=b.onSelect;for(var a=0;a<i.length;a++){var u=i[a];if(!o.hasOwnProperty(u)||!o[u]){o=!1;break e}}o=!0}i=!o}if(i)return null;switch(o=t?k(t):window,e){case"focus":(Le(o)||"true"===o.contentEditable)&&(jn=o,zn=t,Xn=null);break;case"blur":Xn=zn=jn=null;break;case"mousedown":Gn=!0;break;case"contextmenu":case"mouseup":case"dragend":return Gn=!1,Vn(n,r);case"selectionchange":if(Ln)break;case"keydown":case"keyup":return Vn(n,r)}return null}};function Wn(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,function(e){null!=e&&(t+=e)}),t}(t.children))&&(e.children=t),e}function Yn(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+_t(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function qn(e,t){return null!=t.dangerouslySetInnerHTML&&a("91"),i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Qn(e,t){var n=t.value;null==n&&(n=t.defaultValue,null!=(t=t.children)&&(null!=n&&a("92"),Array.isArray(t)&&(1>=t.length||a("93"),t=t[0]),n=t),null==n&&(n="")),e._wrapperState={initialValue:_t(n)}}function Kn(e,t){var n=_t(t.value),r=_t(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function $n(e){var t=e.textContent;t===e._wrapperState.initialValue&&(e.value=t)}F.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),w=L,T=B,E=k,F.injectEventPluginsByName({SimpleEventPlugin:bn,EnterLeaveEventPlugin:$t,ChangeEventPlugin:Nt,SelectEventPlugin:Hn,BeforeInputEventPlugin:xe});var Jn={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function Zn(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function er(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Zn(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var tr=void 0,nr=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n)})}:e}(function(e,t){if(e.namespaceURI!==Jn.svg||"innerHTML"in e)e.innerHTML=t;else{for((tr=tr||document.createElement("div")).innerHTML="<svg>"+t+"</svg>",t=tr.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function rr(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var ir={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},or=["Webkit","ms","Moz","O"];function ar(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||ir.hasOwnProperty(e)&&ir[e]?(""+t).trim():t+"px"}function ur(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ar(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(ir).forEach(function(e){or.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ir[t]=ir[e]})});var sr=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lr(e,t){t&&(sr[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML)&&a("137",e,""),null!=t.dangerouslySetInnerHTML&&(null!=t.children&&a("60"),"object"===typeof t.dangerouslySetInnerHTML&&"__html"in t.dangerouslySetInnerHTML||a("61")),null!=t.style&&"object"!==typeof t.style&&a("62",""))}function cr(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function fr(e,t){var n=Mn(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=b[t];for(var r=0;r<t.length;r++){var i=t[r];if(!n.hasOwnProperty(i)||!n[i]){switch(i){case"scroll":Sn("scroll",e);break;case"focus":case"blur":Sn("focus",e),Sn("blur",e),n.blur=!0,n.focus=!0;break;case"cancel":case"close":je(i)&&Sn(i,e);break;case"invalid":case"submit":case"reset":break;default:-1===te.indexOf(i)&&xn(i,e)}n[i]=!0}}}function pr(){}var hr=null,dr=null;function mr(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function yr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var vr="function"===typeof setTimeout?setTimeout:void 0,_r="function"===typeof clearTimeout?clearTimeout:void 0;function gr(e){for(e=e.nextSibling;e&&1!==e.nodeType&&3!==e.nodeType;)e=e.nextSibling;return e}function br(e){for(e=e.firstChild;e&&1!==e.nodeType&&3!==e.nodeType;)e=e.nextSibling;return e}new Set;var wr=[],Tr=-1;function Er(e){0>Tr||(e.current=wr[Tr],wr[Tr]=null,Tr--)}function Rr(e,t){wr[++Tr]=e.current,e.current=t}var xr={},Sr={current:xr},Pr={current:!1},Ar=xr;function Fr(e,t){var n=e.type.contextTypes;if(!n)return xr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Dr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Or(e){Er(Pr),Er(Sr)}function Mr(e){Er(Pr),Er(Sr)}function Cr(e,t,n){Sr.current!==xr&&a("168"),Rr(Sr,t),Rr(Pr,n)}function Ur(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())o in e||a("108",ut(t)||"Unknown",o);return i({},n,r)}function Ir(e){var t=e.stateNode;return t=t&&t.__reactInternalMemoizedMergedChildContext||xr,Ar=Sr.current,Rr(Sr,t),Rr(Pr,Pr.current),!0}function Br(e,t,n){var r=e.stateNode;r||a("169"),n?(t=Ur(e,t,Ar),r.__reactInternalMemoizedMergedChildContext=t,Er(Pr),Er(Sr),Rr(Sr,t)):Er(Pr),Rr(Pr,n)}var kr=null,Lr=null;function Nr(e){return function(t){try{return e(t)}catch(e){}}}function jr(e,t,n,r){return new function(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.firstContextDependency=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}(e,t,n,r)}function zr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Xr(e,t){var n=e.alternate;return null===n?((n=jr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=e.childExpirationTime,n.expirationTime=e.expirationTime,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,n.firstContextDependency=e.firstContextDependency,n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Gr(e,t,n,r,i,o){var u=2;if(r=e,"function"===typeof e)zr(e)&&(u=1);else if("string"===typeof e)u=5;else e:switch(e){case Qe:return Vr(n.children,i,o,t);case et:return Hr(n,3|i,o,t);case Ke:return Hr(n,2|i,o,t);case $e:return(e=jr(12,n,t,4|i)).elementType=$e,e.type=$e,e.expirationTime=o,e;case nt:return(e=jr(13,n,t,i)).elementType=nt,e.type=nt,e.expirationTime=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case Je:u=10;break e;case Ze:u=9;break e;case tt:u=11;break e;case rt:u=14;break e;case it:u=16,r=null;break e}a("130",null==e?e:typeof e,"")}return(t=jr(u,n,t,i)).elementType=e,t.type=r,t.expirationTime=o,t}function Vr(e,t,n,r){return(e=jr(7,e,r,t)).expirationTime=n,e}function Hr(e,t,n,r){return e=jr(8,e,r,t),t=0===(1&t)?Ke:et,e.elementType=t,e.type=t,e.expirationTime=n,e}function Wr(e,t,n){return(e=jr(6,e,null,t)).expirationTime=n,e}function Yr(e,t,n){return(t=jr(4,null!==e.children?e.children:[],e.key,t)).expirationTime=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qr(e,t){e.didError=!1;var n=e.earliestPendingTime;0===n?e.earliestPendingTime=e.latestPendingTime=t:n<t?e.earliestPendingTime=t:e.latestPendingTime>t&&(e.latestPendingTime=t),$r(t,e)}function Qr(e,t){e.didError=!1;var n=e.latestPingedTime;0!==n&&n>=t&&(e.latestPingedTime=0),n=e.earliestPendingTime;var r=e.latestPendingTime;n===t?e.earliestPendingTime=r===t?e.latestPendingTime=0:r:r===t&&(e.latestPendingTime=n),n=e.earliestSuspendedTime,r=e.latestSuspendedTime,0===n?e.earliestSuspendedTime=e.latestSuspendedTime=t:n<t?e.earliestSuspendedTime=t:r>t&&(e.latestSuspendedTime=t),$r(t,e)}function Kr(e,t){var n=e.earliestPendingTime;return e=e.earliestSuspendedTime,n>t&&(t=n),e>t&&(t=e),t}function $r(e,t){var n=t.earliestSuspendedTime,r=t.latestSuspendedTime,i=t.earliestPendingTime,o=t.latestPingedTime;0===(i=0!==i?i:o)&&(0===e||r<e)&&(i=r),0!==(e=i)&&n>e&&(e=n),t.nextExpirationTimeToWorkOn=i,t.expirationTime=e}var Jr=!1;function Zr(e){return{baseState:e,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function ei(e){return{baseState:e.baseState,firstUpdate:e.firstUpdate,lastUpdate:e.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function ti(e){return{expirationTime:e,tag:0,payload:null,callback:null,next:null,nextEffect:null}}function ni(e,t){null===e.lastUpdate?e.firstUpdate=e.lastUpdate=t:(e.lastUpdate.next=t,e.lastUpdate=t)}function ri(e,t){var n=e.alternate;if(null===n){var r=e.updateQueue,i=null;null===r&&(r=e.updateQueue=Zr(e.memoizedState))}else r=e.updateQueue,i=n.updateQueue,null===r?null===i?(r=e.updateQueue=Zr(e.memoizedState),i=n.updateQueue=Zr(n.memoizedState)):r=e.updateQueue=ei(i):null===i&&(i=n.updateQueue=ei(r));null===i||r===i?ni(r,t):null===r.lastUpdate||null===i.lastUpdate?(ni(r,t),ni(i,t)):(ni(r,t),i.lastUpdate=t)}function ii(e,t){var n=e.updateQueue;null===(n=null===n?e.updateQueue=Zr(e.memoizedState):oi(e,n)).lastCapturedUpdate?n.firstCapturedUpdate=n.lastCapturedUpdate=t:(n.lastCapturedUpdate.next=t,n.lastCapturedUpdate=t)}function oi(e,t){var n=e.alternate;return null!==n&&t===n.updateQueue&&(t=e.updateQueue=ei(t)),t}function ai(e,t,n,r,o,a){switch(n.tag){case 1:return"function"===typeof(e=n.payload)?e.call(a,r,o):e;case 3:e.effectTag=-2049&e.effectTag|64;case 0:if(null===(o="function"===typeof(e=n.payload)?e.call(a,r,o):e)||void 0===o)break;return i({},r,o);case 2:Jr=!0}return r}function ui(e,t,n,r,i){Jr=!1;for(var o=(t=oi(e,t)).baseState,a=null,u=0,s=t.firstUpdate,l=o;null!==s;){var c=s.expirationTime;c<i?(null===a&&(a=s,o=l),u<c&&(u=c)):(l=ai(e,0,s,l,n,r),null!==s.callback&&(e.effectTag|=32,s.nextEffect=null,null===t.lastEffect?t.firstEffect=t.lastEffect=s:(t.lastEffect.nextEffect=s,t.lastEffect=s))),s=s.next}for(c=null,s=t.firstCapturedUpdate;null!==s;){var f=s.expirationTime;f<i?(null===c&&(c=s,null===a&&(o=l)),u<f&&(u=f)):(l=ai(e,0,s,l,n,r),null!==s.callback&&(e.effectTag|=32,s.nextEffect=null,null===t.lastCapturedEffect?t.firstCapturedEffect=t.lastCapturedEffect=s:(t.lastCapturedEffect.nextEffect=s,t.lastCapturedEffect=s))),s=s.next}null===a&&(t.lastUpdate=null),null===c?t.lastCapturedUpdate=null:e.effectTag|=32,null===a&&null===c&&(o=l),t.baseState=o,t.firstUpdate=a,t.firstCapturedUpdate=c,e.expirationTime=u,e.memoizedState=l}function si(e,t,n){null!==t.firstCapturedUpdate&&(null!==t.lastUpdate&&(t.lastUpdate.next=t.firstCapturedUpdate,t.lastUpdate=t.lastCapturedUpdate),t.firstCapturedUpdate=t.lastCapturedUpdate=null),li(t.firstEffect,n),t.firstEffect=t.lastEffect=null,li(t.firstCapturedEffect,n),t.firstCapturedEffect=t.lastCapturedEffect=null}function li(e,t){for(;null!==e;){var n=e.callback;if(null!==n){e.callback=null;var r=t;"function"!==typeof n&&a("191",n),n.call(r)}e=e.nextEffect}}function ci(e,t){return{value:e,source:t,stack:st(t)}}var fi={current:null},pi=null,hi=null,di=null;function mi(e,t){var n=e.type._context;Rr(fi,n._currentValue),n._currentValue=t}function yi(e){var t=fi.current;Er(fi),e.type._context._currentValue=t}function vi(e){pi=e,di=hi=null,e.firstContextDependency=null}function _i(e,t){return di!==e&&!1!==t&&0!==t&&("number"===typeof t&&1073741823!==t||(di=e,t=1073741823),t={context:e,observedBits:t,next:null},null===hi?(null===pi&&a("293"),pi.firstContextDependency=hi=t):hi=hi.next=t),e._currentValue}var gi={},bi={current:gi},wi={current:gi},Ti={current:gi};function Ei(e){return e===gi&&a("174"),e}function Ri(e,t){Rr(Ti,t),Rr(wi,e),Rr(bi,gi);var n=t.nodeType;switch(n){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:er(null,"");break;default:t=er(t=(n=8===n?t.parentNode:t).namespaceURI||null,n=n.tagName)}Er(bi),Rr(bi,t)}function xi(e){Er(bi),Er(wi),Er(Ti)}function Si(e){Ei(Ti.current);var t=Ei(bi.current),n=er(t,e.type);t!==n&&(Rr(wi,e),Rr(bi,n))}function Pi(e){wi.current===e&&(Er(bi),Er(wi))}function Ai(e,t){if(e&&e.defaultProps)for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}var Fi=Ve.ReactCurrentOwner,Di=(new r.Component).refs;function Oi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:i({},t,n),e.memoizedState=n,null!==(r=e.updateQueue)&&0===e.expirationTime&&(r.baseState=n)}var Mi={isMounted:function(e){return!!(e=e._reactInternalFiber)&&2===tn(e)},enqueueSetState:function(e,t,n){e=e._reactInternalFiber;var r=Ea(),i=ti(r=Qo(r,e));i.payload=t,void 0!==n&&null!==n&&(i.callback=n),Vo(),ri(e,i),Jo(e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternalFiber;var r=Ea(),i=ti(r=Qo(r,e));i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),Vo(),ri(e,i),Jo(e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var n=Ea(),r=ti(n=Qo(n,e));r.tag=2,void 0!==t&&null!==t&&(r.callback=t),Vo(),ri(e,r),Jo(e,n)}};function Ci(e,t,n,r,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!en(n,r)||!en(i,o))}function Ui(e,t,n){var r=!1,i=xr,o=t.contextType;return"object"===typeof o&&null!==o?o=Fi.currentDispatcher.readContext(o):(i=Dr(t)?Ar:Sr.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?Fr(e,i):xr),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Mi,e.stateNode=t,t._reactInternalFiber=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Ii(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Mi.enqueueReplaceState(t,t.state,null)}function Bi(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Di;var o=t.contextType;"object"===typeof o&&null!==o?i.context=Fi.currentDispatcher.readContext(o):(o=Dr(t)?Ar:Sr.current,i.context=Fr(e,o)),null!==(o=e.updateQueue)&&(ui(e,o,n,i,r),i.state=e.memoizedState),"function"===typeof(o=t.getDerivedStateFromProps)&&(Oi(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Mi.enqueueReplaceState(i,i.state,null),null!==(o=e.updateQueue)&&(ui(e,o,n,i,r),i.state=e.memoizedState)),"function"===typeof i.componentDidMount&&(e.effectTag|=4)}var ki=Array.isArray;function Li(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){var r=void 0;(n=n._owner)&&(1!==n.tag&&a("289"),r=n.stateNode),r||a("147",e);var i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=r.refs;t===Di&&(t=r.refs={}),null===e?delete t[i]:t[i]=e})._stringRef=i,t)}"string"!==typeof e&&a("284"),n._owner||a("290",e)}return e}function Ni(e,t){"textarea"!==e.type&&a("31","[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,"")}function ji(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t,n){return(e=Xr(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.effectTag=2,n):r:(t.effectTag=2,n):n}function u(t){return e&&null===t.alternate&&(t.effectTag=2),t}function s(e,t,n,r){return null===t||6!==t.tag?((t=Wr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=Li(e,t,n),r.return=e,r):((r=Gr(n.type,n.key,n.props,null,e.mode,r)).ref=Li(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Yr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function f(e,t,n,r,o){return null===t||7!==t.tag?((t=Vr(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=Wr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case Ye:return(n=Gr(t.type,t.key,t.props,null,e.mode,n)).ref=Li(e,null,t),n.return=e,n;case qe:return(t=Yr(t,e.mode,n)).return=e,t}if(ki(t)||at(t))return(t=Vr(t,e.mode,n,null)).return=e,t;Ni(e,t)}return null}function h(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:s(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case Ye:return n.key===i?n.type===Qe?f(e,t,n.props.children,r,i):l(e,t,n,r):null;case qe:return n.key===i?c(e,t,n,r):null}if(ki(n)||at(n))return null!==i?null:f(e,t,n,r,null);Ni(e,n)}return null}function d(e,t,n,r,i){if("string"===typeof r||"number"===typeof r)return s(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case Ye:return e=e.get(null===r.key?n:r.key)||null,r.type===Qe?f(t,e,r.props.children,i,r.key):l(t,e,r,i);case qe:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(ki(r)||at(r))return f(t,e=e.get(n)||null,r,i,null);Ni(t,r)}return null}function m(i,a,u,s){for(var l=null,c=null,f=a,m=a=0,y=null;null!==f&&m<u.length;m++){f.index>m?(y=f,f=null):y=f.sibling;var v=h(i,f,u[m],s);if(null===v){null===f&&(f=y);break}e&&f&&null===v.alternate&&t(i,f),a=o(v,a,m),null===c?l=v:c.sibling=v,c=v,f=y}if(m===u.length)return n(i,f),l;if(null===f){for(;m<u.length;m++)(f=p(i,u[m],s))&&(a=o(f,a,m),null===c?l=f:c.sibling=f,c=f);return l}for(f=r(i,f);m<u.length;m++)(y=d(f,i,m,u[m],s))&&(e&&null!==y.alternate&&f.delete(null===y.key?m:y.key),a=o(y,a,m),null===c?l=y:c.sibling=y,c=y);return e&&f.forEach(function(e){return t(i,e)}),l}function y(i,u,s,l){var c=at(s);"function"!==typeof c&&a("150"),null==(s=c.call(s))&&a("151");for(var f=c=null,m=u,y=u=0,v=null,_=s.next();null!==m&&!_.done;y++,_=s.next()){m.index>y?(v=m,m=null):v=m.sibling;var g=h(i,m,_.value,l);if(null===g){m||(m=v);break}e&&m&&null===g.alternate&&t(i,m),u=o(g,u,y),null===f?c=g:f.sibling=g,f=g,m=v}if(_.done)return n(i,m),c;if(null===m){for(;!_.done;y++,_=s.next())null!==(_=p(i,_.value,l))&&(u=o(_,u,y),null===f?c=_:f.sibling=_,f=_);return c}for(m=r(i,m);!_.done;y++,_=s.next())null!==(_=d(m,i,y,_.value,l))&&(e&&null!==_.alternate&&m.delete(null===_.key?y:_.key),u=o(_,u,y),null===f?c=_:f.sibling=_,f=_);return e&&m.forEach(function(e){return t(i,e)}),c}return function(e,r,o,s){var l="object"===typeof o&&null!==o&&o.type===Qe&&null===o.key;l&&(o=o.props.children);var c="object"===typeof o&&null!==o;if(c)switch(o.$$typeof){case Ye:e:{for(c=o.key,l=r;null!==l;){if(l.key===c){if(7===l.tag?o.type===Qe:l.elementType===o.type){n(e,l.sibling),(r=i(l,o.type===Qe?o.props.children:o.props)).ref=Li(e,l,o),r.return=e,e=r;break e}n(e,l);break}t(e,l),l=l.sibling}o.type===Qe?((r=Vr(o.props.children,e.mode,s,o.key)).return=e,e=r):((s=Gr(o.type,o.key,o.props,null,e.mode,s)).ref=Li(e,r,o),s.return=e,e=s)}return u(e);case qe:e:{for(l=o.key;null!==r;){if(r.key===l){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=i(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Yr(o,e.mode,s)).return=e,e=r}return u(e)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,o)).return=e,e=r):(n(e,r),(r=Wr(o,e.mode,s)).return=e,e=r),u(e);if(ki(o))return m(e,r,o,s);if(at(o))return y(e,r,o,s);if(c&&Ni(e,o),"undefined"===typeof o&&!l)switch(e.tag){case 1:case 0:a("152",(s=e.type).displayName||s.name||"Component")}return n(e,r)}}var zi=ji(!0),Xi=ji(!1),Gi=null,Vi=null,Hi=!1;function Wi(e,t){var n=jr(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Yi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function qi(e){if(Hi){var t=Vi;if(t){var n=t;if(!Yi(e,t)){if(!(t=gr(n))||!Yi(e,t))return e.effectTag|=2,Hi=!1,void(Gi=e);Wi(Gi,n)}Gi=e,Vi=br(t)}else e.effectTag|=2,Hi=!1,Gi=e}}function Qi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag;)e=e.return;Gi=e}function Ki(e){if(e!==Gi)return!1;if(!Hi)return Qi(e),Hi=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!yr(t,e.memoizedProps))for(t=Vi;t;)Wi(e,t),t=gr(t);return Qi(e),Vi=Gi?gr(e.stateNode):null,!0}function $i(){Vi=Gi=null,Hi=!1}var Ji=Ve.ReactCurrentOwner;function Zi(e,t,n,r){t.child=null===e?Xi(t,null,n,r):zi(t,e.child,n,r)}function eo(e,t,n,r,i){n=n.render;var o=t.ref;return vi(t),r=n(r,o),t.effectTag|=1,Zi(e,t,r,i),t.child}function to(e,t,n,r,i,o){if(null===e){var a=n.type;return"function"!==typeof a||zr(a)||void 0!==a.defaultProps||null!==n.compare?((e=Gr(n.type,null,r,null,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,no(e,t,a,r,i,o))}return a=e.child,i<o&&(i=a.memoizedProps,(n=null!==(n=n.compare)?n:en)(i,r)&&e.ref===t.ref)?co(e,t,o):((e=Xr(a,r)).ref=t.ref,e.return=t,t.child=e)}function no(e,t,n,r,i,o){return null!==e&&i<o&&en(e.memoizedProps,r)&&e.ref===t.ref?co(e,t,o):io(e,t,n,r,o)}function ro(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.effectTag|=128)}function io(e,t,n,r,i){var o=Dr(n)?Ar:Sr.current;return o=Fr(t,o),vi(t),n=n(r,o),t.effectTag|=1,Zi(e,t,n,i),t.child}function oo(e,t,n,r,i){if(Dr(n)){var o=!0;Ir(t)}else o=!1;if(vi(t),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),Ui(t,n,r),Bi(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,u=t.memoizedProps;a.props=u;var s=a.context,l=n.contextType;"object"===typeof l&&null!==l?l=Fi.currentDispatcher.readContext(l):l=Fr(t,l=Dr(n)?Ar:Sr.current);var c=n.getDerivedStateFromProps,f="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;f||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(u!==r||s!==l)&&Ii(t,a,r,l),Jr=!1;var p=t.memoizedState;s=a.state=p;var h=t.updateQueue;null!==h&&(ui(t,h,r,a,i),s=t.memoizedState),u!==r||p!==s||Pr.current||Jr?("function"===typeof c&&(Oi(t,n,c,r),s=t.memoizedState),(u=Jr||Ci(t,n,u,r,p,s,l))?(f||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.effectTag|=4)):("function"===typeof a.componentDidMount&&(t.effectTag|=4),t.memoizedProps=r,t.memoizedState=s),a.props=r,a.state=s,a.context=l,r=u):("function"===typeof a.componentDidMount&&(t.effectTag|=4),r=!1)}else a=t.stateNode,u=t.memoizedProps,a.props=t.type===t.elementType?u:Ai(t.type,u),s=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Fi.currentDispatcher.readContext(l):l=Fr(t,l=Dr(n)?Ar:Sr.current),(f="function"===typeof(c=n.getDerivedStateFromProps)||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(u!==r||s!==l)&&Ii(t,a,r,l),Jr=!1,s=t.memoizedState,p=a.state=s,null!==(h=t.updateQueue)&&(ui(t,h,r,a,i),p=t.memoizedState),u!==r||s!==p||Pr.current||Jr?("function"===typeof c&&(Oi(t,n,c,r),p=t.memoizedState),(c=Jr||Ci(t,n,u,r,s,p,l))?(f||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof a.componentDidUpdate&&(t.effectTag|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!==typeof a.componentDidUpdate||u===e.memoizedProps&&s===e.memoizedState||(t.effectTag|=4),"function"!==typeof a.getSnapshotBeforeUpdate||u===e.memoizedProps&&s===e.memoizedState||(t.effectTag|=256),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||u===e.memoizedProps&&s===e.memoizedState||(t.effectTag|=4),"function"!==typeof a.getSnapshotBeforeUpdate||u===e.memoizedProps&&s===e.memoizedState||(t.effectTag|=256),r=!1);return ao(e,t,n,r,o,i)}function ao(e,t,n,r,i,o){ro(e,t);var a=0!==(64&t.effectTag);if(!r&&!a)return i&&Br(t,n,!1),co(e,t,o);r=t.stateNode,Ji.current=t;var u=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.effectTag|=1,null!==e&&a?(t.child=zi(t,e.child,null,o),t.child=zi(t,null,u,o)):Zi(e,t,u,o),t.memoizedState=r.state,i&&Br(t,n,!0),t.child}function uo(e){var t=e.stateNode;t.pendingContext?Cr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Cr(0,t.context,!1),Ri(e,t.containerInfo)}function so(e,t,n){var r=t.mode,i=t.pendingProps,o=t.memoizedState;if(0===(64&t.effectTag)){o=null;var a=!1}else o={timedOutAt:null!==o?o.timedOutAt:0},a=!0,t.effectTag&=-65;return null===e?a?(a=i.fallback,i=Vr(null,r,0,null),0===(1&t.mode)&&lo(t,i,null!==t.memoizedState?t.child.child:t.child),r=Vr(a,r,n,null),i.sibling=r,(n=i).return=r.return=t):n=r=Xi(t,null,i.children,n):null!==e.memoizedState?(e=(r=e.child).sibling,a?(n=i.fallback,(i=Xr(r,r.pendingProps)).effectTag|=2,0===(1&t.mode)&&((a=null!==t.memoizedState?t.child.child:t.child)!==r.child&&lo(t,i,a)),(r=i.sibling=Xr(e,n,e.expirationTime)).effectTag|=2,n=i,i.childExpirationTime=0,n.return=r.return=t):(a=e.child,r=zi(t,r.child,i.children,n),zi(t,a,null,n),n=r)):(e=e.child,a?(a=i.fallback,(i=Vr(null,r,0,null)).effectTag|=2,i.child=e,e.return=i,0===(1&t.mode)&&lo(t,i,null!==t.memoizedState?t.child.child:t.child),(r=i.sibling=Vr(a,r,n,null)).effectTag|=2,n=i,i.childExpirationTime=0,n.return=r.return=t):r=n=zi(t,e,i.children,n)),t.memoizedState=o,t.child=n,r}function lo(e,t,n){for(n=t.child=n;null!==n;)null===t.firstEffect&&(t.firstEffect=n.firstEffect),null!==n.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=n.firstEffect),t.lastEffect=n.lastEffect),1<n.effectTag&&(null!==t.lastEffect?t.lastEffect.nextEffect=n:t.firstEffect=n,t.lastEffect=n),n.return=t,n=n.sibling;e.firstEffect=t.firstEffect,e.lastEffect=t.lastEffect}function co(e,t,n){if(null!==e&&(t.firstContextDependency=e.firstContextDependency),t.childExpirationTime<n)return null;if(null!==e&&t.child!==e.child&&a("153"),null!==t.child){for(n=Xr(e=t.child,e.pendingProps,e.expirationTime),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Xr(e,e.pendingProps,e.expirationTime)).return=t;n.sibling=null}return t.child}function fo(e,t,n){var r=t.expirationTime;if(null!==e&&e.memoizedProps===t.pendingProps&&!Pr.current&&r<n){switch(t.tag){case 3:uo(t),$i();break;case 5:Si(t);break;case 1:Dr(t.type)&&Ir(t);break;case 4:Ri(t,t.stateNode.containerInfo);break;case 10:mi(t,t.memoizedProps.value);break;case 13:if(null!==t.memoizedState)return 0!==(r=t.child.childExpirationTime)&&r>=n?so(e,t,n):null!==(t=co(e,t,n))?t.sibling:null}return co(e,t,n)}switch(t.expirationTime=0,t.tag){case 2:r=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps;var i=Fr(t,Sr.current);if(vi(t),i=r(e,i),t.effectTag|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(t.tag=1,Dr(r)){var o=!0;Ir(t)}else o=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null;var u=r.getDerivedStateFromProps;"function"===typeof u&&Oi(t,r,u,e),i.updater=Mi,t.stateNode=i,i._reactInternalFiber=t,Bi(t,r,e,n),t=ao(null,t,r,!0,o,n)}else t.tag=0,Zi(null,t,i,n),t=t.child;return t;case 16:switch(i=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),o=t.pendingProps,e=function(e){var t=e._result;switch(e._status){case 1:return t;case 2:case 0:throw t;default:throw e._status=0,(t=(t=e._ctor)()).then(function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)},function(t){0===e._status&&(e._status=2,e._result=t)}),e._result=t,t}}(i),t.type=e,i=t.tag=function(e){if("function"===typeof e)return zr(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===tt)return 11;if(e===rt)return 14}return 2}(e),o=Ai(e,o),u=void 0,i){case 0:u=io(null,t,e,o,n);break;case 1:u=oo(null,t,e,o,n);break;case 11:u=eo(null,t,e,o,n);break;case 14:u=to(null,t,e,Ai(e.type,o),r,n);break;default:a("283",e)}return u;case 0:return r=t.type,i=t.pendingProps,io(e,t,r,i=t.elementType===r?i:Ai(r,i),n);case 1:return r=t.type,i=t.pendingProps,oo(e,t,r,i=t.elementType===r?i:Ai(r,i),n);case 3:return uo(t),null===(r=t.updateQueue)&&a("282"),i=null!==(i=t.memoizedState)?i.element:null,ui(t,r,t.pendingProps,null,n),(r=t.memoizedState.element)===i?($i(),t=co(e,t,n)):(i=t.stateNode,(i=(null===e||null===e.child)&&i.hydrate)&&(Vi=br(t.stateNode.containerInfo),Gi=t,i=Hi=!0),i?(t.effectTag|=2,t.child=Xi(t,null,r,n)):(Zi(e,t,r,n),$i()),t=t.child),t;case 5:return Si(t),null===e&&qi(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,u=i.children,yr(r,i)?u=null:null!==o&&yr(r,o)&&(t.effectTag|=16),ro(e,t),1!==n&&1&t.mode&&i.hidden?(t.expirationTime=1,t=null):(Zi(e,t,u,n),t=t.child),t;case 6:return null===e&&qi(t),null;case 13:return so(e,t,n);case 4:return Ri(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=zi(t,null,r,n):Zi(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,eo(e,t,r,i=t.elementType===r?i:Ai(r,i),n);case 7:return Zi(e,t,t.pendingProps,n),t.child;case 8:case 12:return Zi(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,u=t.memoizedProps,mi(t,o=i.value),null!==u){var s=u.value;if(0===(o=s===o&&(0!==s||1/s===1/o)||s!==s&&o!==o?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(s,o):1073741823))){if(u.children===i.children&&!Pr.current){t=co(e,t,n);break e}}else for(null!==(u=t.child)&&(u.return=t);null!==u;){if(null!==(s=u.firstContextDependency))do{if(s.context===r&&0!==(s.observedBits&o)){if(1===u.tag){var l=ti(n);l.tag=2,ri(u,l)}u.expirationTime<n&&(u.expirationTime=n),null!==(l=u.alternate)&&l.expirationTime<n&&(l.expirationTime=n);for(var c=u.return;null!==c;){if(l=c.alternate,c.childExpirationTime<n)c.childExpirationTime=n,null!==l&&l.childExpirationTime<n&&(l.childExpirationTime=n);else{if(!(null!==l&&l.childExpirationTime<n))break;l.childExpirationTime=n}c=c.return}}l=u.child,s=s.next}while(null!==s);else l=10===u.tag&&u.type===t.type?null:u.child;if(null!==l)l.return=u;else for(l=u;null!==l;){if(l===t){l=null;break}if(null!==(u=l.sibling)){u.return=l.return,l=u;break}l=l.return}u=l}}Zi(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(o=t.pendingProps).children,vi(t),r=r(i=_i(i,o.unstable_observedBits)),t.effectTag|=1,Zi(e,t,r,n),t.child;case 14:return to(e,t,i=t.type,o=Ai(i.type,t.pendingProps),r,n);case 15:return no(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Ai(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,Dr(r)?(e=!0,Ir(t)):e=!1,vi(t),Ui(t,r,i),Bi(t,r,i,n),ao(null,t,r,!0,e,n);default:a("156")}}function po(e){e.effectTag|=4}var ho=void 0,mo=void 0,yo=void 0,vo=void 0;function _o(e,t){var n=t.source,r=t.stack;null===r&&null!==n&&(r=st(n)),null!==n&&ut(n.type),t=t.value,null!==e&&1===e.tag&&ut(e.type);try{console.error(t)}catch(e){setTimeout(function(){throw e})}}function go(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(t){qo(e,t)}else t.current=null}function bo(e){switch("function"===typeof Lr&&Lr(e),e.tag){case 0:case 11:case 14:case 15:var t=e.updateQueue;if(null!==t&&null!==(t=t.lastEffect)){var n=t=t.next;do{var r=n.destroy;if(null!==r){var i=e;try{r()}catch(e){qo(i,e)}}n=n.next}while(n!==t)}break;case 1:if(go(e),"function"===typeof(t=e.stateNode).componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(t){qo(e,t)}break;case 5:go(e);break;case 4:Eo(e)}}function wo(e){return 5===e.tag||3===e.tag||4===e.tag}function To(e){e:{for(var t=e.return;null!==t;){if(wo(t)){var n=t;break e}t=t.return}a("160"),n=void 0}var r=t=void 0;switch(n.tag){case 5:t=n.stateNode,r=!1;break;case 3:case 4:t=n.stateNode.containerInfo,r=!0;break;default:a("161")}16&n.effectTag&&(rr(t,""),n.effectTag&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||wo(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag;){if(2&n.effectTag)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break e}}for(var i=e;;){if(5===i.tag||6===i.tag)if(n)if(r){var o=t,u=i.stateNode,s=n;8===o.nodeType?o.parentNode.insertBefore(u,s):o.insertBefore(u,s)}else t.insertBefore(i.stateNode,n);else r?(u=t,s=i.stateNode,8===u.nodeType?(o=u.parentNode).insertBefore(s,u):(o=u).appendChild(s),null!==(u=u._reactRootContainer)&&void 0!==u||null!==o.onclick||(o.onclick=pr)):t.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function Eo(e){for(var t=e,n=!1,r=void 0,i=void 0;;){if(!n){n=t.return;e:for(;;){switch(null===n&&a("160"),n.tag){case 5:r=n.stateNode,i=!1;break e;case 3:case 4:r=n.stateNode.containerInfo,i=!0;break e}n=n.return}n=!0}if(5===t.tag||6===t.tag){e:for(var o=t,u=o;;)if(bo(u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===o)break;for(;null===u.sibling;){if(null===u.return||u.return===o)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}i?(o=r,u=t.stateNode,8===o.nodeType?o.parentNode.removeChild(u):o.removeChild(u)):r.removeChild(t.stateNode)}else if(4===t.tag?(r=t.stateNode.containerInfo,i=!0):bo(t),null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return;4===(t=t.return).tag&&(n=!1)}t.sibling.return=t.return,t=t.sibling}}function Ro(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 1:break;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps,i=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[U]=r,"input"===e&&"radio"===r.type&&null!=r.name&&wt(n,r),cr(e,i),t=cr(e,r),i=0;i<o.length;i+=2){var u=o[i],s=o[i+1];"style"===u?ur(n,s):"dangerouslySetInnerHTML"===u?nr(n,s):"children"===u?rr(n,s):vt(n,u,s,t)}switch(e){case"input":Tt(n,r);break;case"textarea":Kn(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(e=r.value)?Yn(n,!!r.multiple,e,!1):t!==!!r.multiple&&(null!=r.defaultValue?Yn(n,!!r.multiple,r.defaultValue,!0):Yn(n,!!r.multiple,r.multiple?[]:"",!1))}}}break;case 6:null===t.stateNode&&a("162"),t.stateNode.nodeValue=t.memoizedProps;break;case 3:case 12:break;case 13:if(e=t,null===(n=t.memoizedState)?r=!1:(r=!0,e=t.child,0===n.timedOutAt&&(n.timedOutAt=Ea())),null!==e)e:for(t=n=e;;){if(5===t.tag)e=t.stateNode,r?e.style.display="none":(e=t.stateNode,o=void 0!==(o=t.memoizedProps.style)&&null!==o&&o.hasOwnProperty("display")?o.display:null,e.style.display=ar("display",o));else if(6===t.tag)t.stateNode.nodeValue=r?"":t.memoizedProps;else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;null===t.sibling;){if(null===t.return||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}break;case 17:break;default:a("163")}}function xo(e,t,n){(n=ti(n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ca(r),_o(e,t)},n}function So(e,t,n){(n=ti(n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Xo?Xo=new Set([this]):Xo.add(this));var n=t.value,i=t.stack;_o(e,t),this.componentDidCatch(n,{componentStack:null!==i?i:""})}),n}function Po(e){switch(e.tag){case 1:Dr(e.type)&&Or();var t=e.effectTag;return 2048&t?(e.effectTag=-2049&t|64,e):null;case 3:return xi(),Mr(),0!==(64&(t=e.effectTag))&&a("285"),e.effectTag=-2049&t|64,e;case 5:return Pi(e),null;case 13:return 2048&(t=e.effectTag)?(e.effectTag=-2049&t|64,e):null;case 4:return xi(),null;case 10:return yi(e),null;default:return null}}ho=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},mo=function(){},yo=function(e,t,n,r,o){var a=e.memoizedProps;if(a!==r){var u=t.stateNode;switch(Ei(bi.current),e=null,n){case"input":a=gt(u,a),r=gt(u,r),e=[];break;case"option":a=Wn(u,a),r=Wn(u,r),e=[];break;case"select":a=i({},a,{value:void 0}),r=i({},r,{value:void 0}),e=[];break;case"textarea":a=qn(u,a),r=qn(u,r),e=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(u.onclick=pr)}lr(n,r),u=n=void 0;var s=null;for(n in a)if(!r.hasOwnProperty(n)&&a.hasOwnProperty(n)&&null!=a[n])if("style"===n){var l=a[n];for(u in l)l.hasOwnProperty(u)&&(s||(s={}),s[u]="")}else"dangerouslySetInnerHTML"!==n&&"children"!==n&&"suppressContentEditableWarning"!==n&&"suppressHydrationWarning"!==n&&"autoFocus"!==n&&(g.hasOwnProperty(n)?e||(e=[]):(e=e||[]).push(n,null));for(n in r){var c=r[n];if(l=null!=a?a[n]:void 0,r.hasOwnProperty(n)&&c!==l&&(null!=c||null!=l))if("style"===n)if(l){for(u in l)!l.hasOwnProperty(u)||c&&c.hasOwnProperty(u)||(s||(s={}),s[u]="");for(u in c)c.hasOwnProperty(u)&&l[u]!==c[u]&&(s||(s={}),s[u]=c[u])}else s||(e||(e=[]),e.push(n,s)),s=c;else"dangerouslySetInnerHTML"===n?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(e=e||[]).push(n,""+c)):"children"===n?l===c||"string"!==typeof c&&"number"!==typeof c||(e=e||[]).push(n,""+c):"suppressContentEditableWarning"!==n&&"suppressHydrationWarning"!==n&&(g.hasOwnProperty(n)?(null!=c&&fr(o,n),e||l===c||(e=[])):(e=e||[]).push(n,c))}s&&(e=e||[]).push("style",s),o=e,(t.updateQueue=o)&&po(t)}},vo=function(e,t,n,r){n!==r&&po(t)};var Ao={readContext:_i},Fo=Ve.ReactCurrentOwner,Do=1073741822,Oo=0,Mo=!1,Co=null,Uo=null,Io=0,Bo=-1,ko=!1,Lo=null,No=!1,jo=null,zo=null,Xo=null;function Go(){if(null!==Co)for(var e=Co.return;null!==e;){var t=e;switch(t.tag){case 1:var n=t.type.childContextTypes;null!==n&&void 0!==n&&Or();break;case 3:xi(),Mr();break;case 5:Pi(t);break;case 4:xi();break;case 10:yi(t)}e=e.return}Uo=null,Io=0,Bo=-1,ko=!1,Co=null}function Vo(){null!==zo&&(o.unstable_cancelCallback(jo),zo())}function Ho(e){for(;;){var t=e.alternate,n=e.return,r=e.sibling;if(0===(1024&e.effectTag)){Co=e;e:{var o=t,u=Io,s=(t=e).pendingProps;switch(t.tag){case 2:case 16:break;case 15:case 0:break;case 1:Dr(t.type)&&Or();break;case 3:xi(),Mr(),(s=t.stateNode).pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),null!==o&&null!==o.child||(Ki(t),t.effectTag&=-3),mo(t);break;case 5:Pi(t);var l=Ei(Ti.current);if(u=t.type,null!==o&&null!=t.stateNode)yo(o,t,u,s,l),o.ref!==t.ref&&(t.effectTag|=128);else if(s){var c=Ei(bi.current);if(Ki(t)){o=(s=t).stateNode;var f=s.type,p=s.memoizedProps,h=l;switch(o[C]=s,o[U]=p,u=void 0,l=f){case"iframe":case"object":xn("load",o);break;case"video":case"audio":for(f=0;f<te.length;f++)xn(te[f],o);break;case"source":xn("error",o);break;case"img":case"image":case"link":xn("error",o),xn("load",o);break;case"form":xn("reset",o),xn("submit",o);break;case"details":xn("toggle",o);break;case"input":bt(o,p),xn("invalid",o),fr(h,"onChange");break;case"select":o._wrapperState={wasMultiple:!!p.multiple},xn("invalid",o),fr(h,"onChange");break;case"textarea":Qn(o,p),xn("invalid",o),fr(h,"onChange")}for(u in lr(l,p),f=null,p)p.hasOwnProperty(u)&&(c=p[u],"children"===u?"string"===typeof c?o.textContent!==c&&(f=["children",c]):"number"===typeof c&&o.textContent!==""+c&&(f=["children",""+c]):g.hasOwnProperty(u)&&null!=c&&fr(h,u));switch(l){case"input":Xe(o),Et(o,p,!0);break;case"textarea":Xe(o),$n(o);break;case"select":case"option":break;default:"function"===typeof p.onClick&&(o.onclick=pr)}u=f,s.updateQueue=u,(s=null!==u)&&po(t)}else{p=t,o=u,h=s,f=9===l.nodeType?l:l.ownerDocument,c===Jn.html&&(c=Zn(o)),c===Jn.html?"script"===o?((o=f.createElement("div")).innerHTML="<script><\/script>",f=o.removeChild(o.firstChild)):"string"===typeof h.is?f=f.createElement(o,{is:h.is}):(f=f.createElement(o),"select"===o&&h.multiple&&(f.multiple=!0)):f=f.createElementNS(c,o),(o=f)[C]=p,o[U]=s,ho(o,t,!1,!1),h=o;var d=l,m=cr(f=u,p=s);switch(f){case"iframe":case"object":xn("load",h),l=p;break;case"video":case"audio":for(l=0;l<te.length;l++)xn(te[l],h);l=p;break;case"source":xn("error",h),l=p;break;case"img":case"image":case"link":xn("error",h),xn("load",h),l=p;break;case"form":xn("reset",h),xn("submit",h),l=p;break;case"details":xn("toggle",h),l=p;break;case"input":bt(h,p),l=gt(h,p),xn("invalid",h),fr(d,"onChange");break;case"option":l=Wn(h,p);break;case"select":h._wrapperState={wasMultiple:!!p.multiple},l=i({},p,{value:void 0}),xn("invalid",h),fr(d,"onChange");break;case"textarea":Qn(h,p),l=qn(h,p),xn("invalid",h),fr(d,"onChange");break;default:l=p}lr(f,l),c=void 0;var y=f,v=h,_=l;for(c in _)if(_.hasOwnProperty(c)){var b=_[c];"style"===c?ur(v,b):"dangerouslySetInnerHTML"===c?null!=(b=b?b.__html:void 0)&&nr(v,b):"children"===c?"string"===typeof b?("textarea"!==y||""!==b)&&rr(v,b):"number"===typeof b&&rr(v,""+b):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(g.hasOwnProperty(c)?null!=b&&fr(d,c):null!=b&&vt(v,c,b,m))}switch(f){case"input":Xe(h),Et(h,p,!1);break;case"textarea":Xe(h),$n(h);break;case"option":null!=p.value&&h.setAttribute("value",""+_t(p.value));break;case"select":(l=h).multiple=!!p.multiple,null!=(h=p.value)?Yn(l,!!p.multiple,h,!1):null!=p.defaultValue&&Yn(l,!!p.multiple,p.defaultValue,!0);break;default:"function"===typeof l.onClick&&(h.onclick=pr)}(s=mr(u,s))&&po(t),t.stateNode=o}null!==t.ref&&(t.effectTag|=128)}else null===t.stateNode&&a("166");break;case 6:o&&null!=t.stateNode?vo(o,t,o.memoizedProps,s):("string"!==typeof s&&(null===t.stateNode&&a("166")),o=Ei(Ti.current),Ei(bi.current),Ki(t)?(u=(s=t).stateNode,o=s.memoizedProps,u[C]=s,(s=u.nodeValue!==o)&&po(t)):(u=t,(s=(9===o.nodeType?o:o.ownerDocument).createTextNode(s))[C]=t,u.stateNode=s));break;case 11:break;case 13:if(s=t.memoizedState,0!==(64&t.effectTag)){t.expirationTime=u,t.firstEffect=t.lastEffect=null,Co=t;break e}((s=null!==s)!==(null!==o&&null!==o.memoizedState)||0===(1&t.effectTag)&&s)&&(t.effectTag|=4);break;case 7:case 8:case 12:break;case 4:xi(),mo(t);break;case 10:yi(t);break;case 9:case 14:break;case 17:Dr(t.type)&&Or();break;default:a("156")}Co=null}if(t=e,1===Io||1!==t.childExpirationTime){for(s=0,u=t.child;null!==u;)o=u.expirationTime,l=u.childExpirationTime,o>s&&(s=o),l>s&&(s=l),u=u.sibling;t.childExpirationTime=s}if(null!==Co)return Co.firstEffect=Co.lastEffect=null,Co;null!==n&&0===(1024&n.effectTag)&&(null===n.firstEffect&&(n.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==n.lastEffect&&(n.lastEffect.nextEffect=e.firstEffect),n.lastEffect=e.lastEffect),1<e.effectTag&&(null!==n.lastEffect?n.lastEffect.nextEffect=e:n.firstEffect=e,n.lastEffect=e))}else{if(null!==(e=Po(e)))return e.effectTag&=1023,e;null!==n&&(n.firstEffect=n.lastEffect=null,n.effectTag|=1024)}if(null!==r)return r;if(null===n)break;e=n}return null}function Wo(e){var t=fo(e.alternate,e,Io);return e.memoizedProps=e.pendingProps,null===t&&(t=Ho(e)),Fo.current=null,t}function Yo(e,t){Mo&&a("243"),Vo(),Mo=!0,Fo.currentDispatcher=Ao;var n=e.nextExpirationTimeToWorkOn;n===Io&&e===Uo&&null!==Co||(Go(),Io=n,Co=Xr((Uo=e).current,null),e.pendingCommitExpirationTime=0);for(var r=!1;;){try{if(t)for(;null!==Co&&!Pa();)Co=Wo(Co);else for(;null!==Co;)Co=Wo(Co)}catch(t){if(di=hi=pi=null,null===Co)r=!0,Ca(t);else{null===Co&&a("271");var i=Co,o=i.return;if(null!==o){e:{var u=e,s=o,l=i,c=t;if(o=Io,l.effectTag|=1024,l.firstEffect=l.lastEffect=null,null!==c&&"object"===typeof c&&"function"===typeof c.then){var f=c;c=s;var p=-1,h=-1;do{if(13===c.tag){var d=c.alternate;if(null!==d&&null!==(d=d.memoizedState)){h=10*(1073741822-d.timedOutAt);break}"number"===typeof(d=c.pendingProps.maxDuration)&&(0>=d?p=0:(-1===p||d<p)&&(p=d))}c=c.return}while(null!==c);c=s;do{if((d=13===c.tag)&&(d=void 0!==c.memoizedProps.fallback&&null===c.memoizedState),d){if(s=Ko.bind(null,u,c,l,0===(1&c.mode)?1073741823:o),f.then(s,s),0===(1&c.mode)){c.effectTag|=64,Zi(l.alternate,l,null,o),l.effectTag&=-1025,l.effectTag&=-933,1===l.tag&&null===l.alternate&&(l.tag=17),l.expirationTime=o;break e}-1===p?u=1073741823:(-1===h&&(h=10*(1073741822-Kr(u,o))-5e3),u=h+p),0<=u&&Bo<u&&(Bo=u),c.effectTag|=2048,c.expirationTime=o;break e}c=c.return}while(null!==c);c=Error((ut(l.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+st(l))}ko=!0,c=ci(c,l),u=s;do{switch(u.tag){case 3:l=c,u.effectTag|=2048,u.expirationTime=o,ii(u,o=xo(u,l,o));break e;case 1:if(l=c,s=u.type,f=u.stateNode,0===(64&u.effectTag)&&("function"===typeof s.getDerivedStateFromError||null!==f&&"function"===typeof f.componentDidCatch&&(null===Xo||!Xo.has(f)))){u.effectTag|=2048,u.expirationTime=o,ii(u,o=So(u,l,o));break e}}u=u.return}while(null!==u)}Co=Ho(i);continue}r=!0,Ca(t)}}break}if(Mo=!1,di=hi=pi=Fo.currentDispatcher=null,r)Uo=null,e.finishedWork=null;else if(null!==Co)e.finishedWork=null;else{if(null===(r=e.current.alternate)&&a("281"),Uo=null,ko){if(i=e.latestPendingTime,o=e.latestSuspendedTime,u=e.latestPingedTime,0!==i&&i<n||0!==o&&o<n||0!==u&&u<n)return Qr(e,n),void Ta(e,r,n,e.expirationTime,-1);if(!e.didError&&t)return e.didError=!0,n=e.nextExpirationTimeToWorkOn=n,t=e.expirationTime=1073741823,void Ta(e,r,n,t,-1)}t&&-1!==Bo?(Qr(e,n),(t=10*(1073741822-Kr(e,n)))<Bo&&(Bo=t),t=10*(1073741822-Ea()),t=Bo-t,Ta(e,r,n,e.expirationTime,0>t?0:t)):(e.pendingCommitExpirationTime=n,e.finishedWork=r)}}function qo(e,t){for(var n=e.return;null!==n;){switch(n.tag){case 1:var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Xo||!Xo.has(r)))return ri(n,e=So(n,e=ci(t,e),1073741823)),void Jo(n,1073741823);break;case 3:return ri(n,e=xo(n,e=ci(t,e),1073741823)),void Jo(n,1073741823)}n=n.return}3===e.tag&&(ri(e,n=xo(e,n=ci(t,e),1073741823)),Jo(e,1073741823))}function Qo(e,t){return 0!==Oo?e=Oo:Mo?e=No?1073741823:Io:1&t.mode?(e=pa?1073741822-10*(1+((1073741822-e+15)/10|0)):1073741822-25*(1+((1073741822-e+500)/25|0)),null!==Uo&&e===Io&&--e):e=1073741823,pa&&(0===ua||e<ua)&&(ua=e),e}function Ko(e,t,n,r){var i=e.earliestSuspendedTime,o=e.latestSuspendedTime;if(0!==i&&r<=i&&r>=o){o=i=r,e.didError=!1;var a=e.latestPingedTime;(0===a||a>o)&&(e.latestPingedTime=o),$r(o,e)}else qr(e,i=Qo(i=Ea(),t));0!==(1&t.mode)&&e===Uo&&Io===r&&(Uo=null),$o(t,i),0===(1&t.mode)&&($o(n,i),1===n.tag&&null!==n.stateNode&&((t=ti(i)).tag=2,ri(n,t))),0!==(n=e.expirationTime)&&Ra(e,n)}function $o(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t);var r=e.return,i=null;if(null===r&&3===e.tag)i=e.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<t&&(r.childExpirationTime=t),null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return null===i?null:i}function Jo(e,t){null!==(e=$o(e,t))&&(!Mo&&0!==Io&&t>Io&&Go(),qr(e,t),Mo&&!No&&Uo===e||Ra(e,e.expirationTime),_a>va&&(_a=0,a("185")))}function Zo(e,t,n,r,i){var o=Oo;Oo=1073741823;try{return e(t,n,r,i)}finally{Oo=o}}var ea=null,ta=null,na=0,ra=void 0,ia=!1,oa=null,aa=0,ua=0,sa=!1,la=null,ca=!1,fa=!1,pa=!1,ha=null,da=o.unstable_now(),ma=1073741822-(da/10|0),ya=ma,va=50,_a=0,ga=null;function ba(){ma=1073741822-((o.unstable_now()-da)/10|0)}function wa(e,t){if(0!==na){if(t<na)return;null!==ra&&o.unstable_cancelCallback(ra)}na=t,e=o.unstable_now()-da,ra=o.unstable_scheduleCallback(Aa,{timeout:10*(1073741822-t)-e})}function Ta(e,t,n,r,i){e.expirationTime=r,0!==i||Pa()?0<i&&(e.timeoutHandle=vr(function(e,t,n){e.pendingCommitExpirationTime=n,e.finishedWork=t,ba(),ya=ma,Da(e,n)}.bind(null,e,t,n),i)):(e.pendingCommitExpirationTime=n,e.finishedWork=t)}function Ea(){return ia?ya:(xa(),0!==aa&&1!==aa||(ba(),ya=ma),ya)}function Ra(e,t){null===e.nextScheduledRoot?(e.expirationTime=t,null===ta?(ea=ta=e,e.nextScheduledRoot=e):(ta=ta.nextScheduledRoot=e).nextScheduledRoot=ea):t>e.expirationTime&&(e.expirationTime=t),ia||(ca?fa&&(oa=e,aa=1073741823,Oa(e,1073741823,!1)):1073741823===t?Fa(1073741823,!1):wa(e,t))}function xa(){var e=0,t=null;if(null!==ta)for(var n=ta,r=ea;null!==r;){var i=r.expirationTime;if(0===i){if((null===n||null===ta)&&a("244"),r===r.nextScheduledRoot){ea=ta=r.nextScheduledRoot=null;break}if(r===ea)ea=i=r.nextScheduledRoot,ta.nextScheduledRoot=i,r.nextScheduledRoot=null;else{if(r===ta){(ta=n).nextScheduledRoot=ea,r.nextScheduledRoot=null;break}n.nextScheduledRoot=r.nextScheduledRoot,r.nextScheduledRoot=null}r=n.nextScheduledRoot}else{if(i>e&&(e=i,t=r),r===ta)break;if(1073741823===e)break;n=r,r=r.nextScheduledRoot}}oa=t,aa=e}var Sa=!1;function Pa(){return!!Sa||!!o.unstable_shouldYield()&&(Sa=!0)}function Aa(){try{if(!Pa()&&null!==ea){ba();var e=ea;do{var t=e.expirationTime;0!==t&&ma<=t&&(e.nextExpirationTimeToWorkOn=ma),e=e.nextScheduledRoot}while(e!==ea)}Fa(0,!0)}finally{Sa=!1}}function Fa(e,t){if(xa(),t)for(ba(),ya=ma;null!==oa&&0!==aa&&e<=aa&&!(Sa&&ma>aa);)Oa(oa,aa,ma>aa),xa(),ba(),ya=ma;else for(;null!==oa&&0!==aa&&e<=aa;)Oa(oa,aa,!1),xa();if(t&&(na=0,ra=null),0!==aa&&wa(oa,aa),_a=0,ga=null,null!==ha)for(e=ha,ha=null,t=0;t<e.length;t++){var n=e[t];try{n._onComplete()}catch(e){sa||(sa=!0,la=e)}}if(sa)throw e=la,la=null,sa=!1,e}function Da(e,t){ia&&a("253"),oa=e,aa=t,Oa(e,t,!1),Fa(1073741823,!1)}function Oa(e,t,n){if(ia&&a("245"),ia=!0,n){var r=e.finishedWork;null!==r?Ma(e,r,t):(e.finishedWork=null,-1!==(r=e.timeoutHandle)&&(e.timeoutHandle=-1,_r(r)),Yo(e,n),null!==(r=e.finishedWork)&&(Pa()?e.finishedWork=r:Ma(e,r,t)))}else null!==(r=e.finishedWork)?Ma(e,r,t):(e.finishedWork=null,-1!==(r=e.timeoutHandle)&&(e.timeoutHandle=-1,_r(r)),Yo(e,n),null!==(r=e.finishedWork)&&Ma(e,r,t));ia=!1}function Ma(e,t,n){var r=e.firstBatch;if(null!==r&&r._expirationTime>=n&&(null===ha?ha=[r]:ha.push(r),r._defer))return e.finishedWork=t,void(e.expirationTime=0);e.finishedWork=null,e===ga?_a++:(ga=e,_a=0),No=Mo=!0,e.current===t&&a("177"),0===(n=e.pendingCommitExpirationTime)&&a("261"),e.pendingCommitExpirationTime=0,r=t.expirationTime;var i=t.childExpirationTime;if(r=i>r?i:r,e.didError=!1,0===r?(e.earliestPendingTime=0,e.latestPendingTime=0,e.earliestSuspendedTime=0,e.latestSuspendedTime=0,e.latestPingedTime=0):(0!==(i=e.latestPendingTime)&&(i>r?e.earliestPendingTime=e.latestPendingTime=0:e.earliestPendingTime>r&&(e.earliestPendingTime=e.latestPendingTime)),0===(i=e.earliestSuspendedTime)?qr(e,r):r<e.latestSuspendedTime?(e.earliestSuspendedTime=0,e.latestSuspendedTime=0,e.latestPingedTime=0,qr(e,r)):r>i&&qr(e,r)),$r(0,e),Fo.current=null,1<t.effectTag?null!==t.lastEffect?(t.lastEffect.nextEffect=t,r=t.firstEffect):r=t:r=t.firstEffect,hr=Rn,kn(i=Bn())){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else e:{var u=(o=(o=i.ownerDocument)&&o.defaultView||window).getSelection&&o.getSelection();if(u&&0!==u.rangeCount){o=u.anchorNode;var s=u.anchorOffset,l=u.focusNode;u=u.focusOffset;try{o.nodeType,l.nodeType}catch(e){o=null;break e}var c=0,f=-1,p=-1,h=0,d=0,m=i,y=null;t:for(;;){for(var v;m!==o||0!==s&&3!==m.nodeType||(f=c+s),m!==l||0!==u&&3!==m.nodeType||(p=c+u),3===m.nodeType&&(c+=m.nodeValue.length),null!==(v=m.firstChild);)y=m,m=v;for(;;){if(m===i)break t;if(y===o&&++h===s&&(f=c),y===l&&++d===u&&(p=c),null!==(v=m.nextSibling))break;y=(m=y).parentNode}m=v}o=-1===f||-1===p?null:{start:f,end:p}}else o=null}o=o||{start:0,end:0}}else o=null;for(dr={focusedElem:i,selectionRange:o},Rn=!1,Lo=r;null!==Lo;){i=!1,o=void 0;try{for(;null!==Lo;){if(256&Lo.effectTag)e:{var _=Lo.alternate;switch((s=Lo).tag){case 0:case 11:case 15:break e;case 1:if(256&s.effectTag&&null!==_){var g=_.memoizedProps,b=_.memoizedState,w=s.stateNode,T=w.getSnapshotBeforeUpdate(s.elementType===s.type?g:Ai(s.type,g),b);w.__reactInternalSnapshotBeforeUpdate=T}break e;case 3:case 5:case 6:case 4:case 17:break e;default:a("163")}}Lo=Lo.nextEffect}}catch(e){i=!0,o=e}i&&(null===Lo&&a("178"),qo(Lo,o),null!==Lo&&(Lo=Lo.nextEffect))}for(Lo=r;null!==Lo;){_=!1,g=void 0;try{for(;null!==Lo;){var E=Lo.effectTag;if(16&E&&rr(Lo.stateNode,""),128&E){var R=Lo.alternate;if(null!==R){var x=R.ref;null!==x&&("function"===typeof x?x(null):x.current=null)}}switch(14&E){case 2:To(Lo),Lo.effectTag&=-3;break;case 6:To(Lo),Lo.effectTag&=-3,Ro(Lo.alternate,Lo);break;case 4:Ro(Lo.alternate,Lo);break;case 8:Eo(b=Lo),b.return=null,b.child=null,b.alternate&&(b.alternate.child=null,b.alternate.return=null)}Lo=Lo.nextEffect}}catch(e){_=!0,g=e}_&&(null===Lo&&a("178"),qo(Lo,g),null!==Lo&&(Lo=Lo.nextEffect))}if(x=dr,R=Bn(),E=x.focusedElem,g=x.selectionRange,R!==E&&E&&E.ownerDocument&&function e(t,n){return!(!t||!n)&&(t===n||(!t||3!==t.nodeType)&&(n&&3===n.nodeType?e(t,n.parentNode):"contains"in t?t.contains(n):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(n))))}(E.ownerDocument.documentElement,E)){null!==g&&kn(E)&&(R=g.start,void 0===(x=g.end)&&(x=R),"selectionStart"in E?(E.selectionStart=R,E.selectionEnd=Math.min(x,E.value.length)):(x=(R=E.ownerDocument||document)&&R.defaultView||window).getSelection&&(x=x.getSelection(),b=E.textContent.length,_=Math.min(g.start,b),g=void 0===g.end?_:Math.min(g.end,b),!x.extend&&_>g&&(b=g,g=_,_=b),b=In(E,_),w=In(E,g),b&&w&&(1!==x.rangeCount||x.anchorNode!==b.node||x.anchorOffset!==b.offset||x.focusNode!==w.node||x.focusOffset!==w.offset)&&((R=R.createRange()).setStart(b.node,b.offset),x.removeAllRanges(),_>g?(x.addRange(R),x.extend(w.node,w.offset)):(R.setEnd(w.node,w.offset),x.addRange(R))))),R=[];for(x=E;x=x.parentNode;)1===x.nodeType&&R.push({element:x,left:x.scrollLeft,top:x.scrollTop});for("function"===typeof E.focus&&E.focus(),E=0;E<R.length;E++)(x=R[E]).element.scrollLeft=x.left,x.element.scrollTop=x.top}for(dr=null,Rn=!!hr,hr=null,e.current=t,Lo=r;null!==Lo;){r=!1,E=void 0;try{for(R=n;null!==Lo;){var S=Lo.effectTag;if(36&S){var P=Lo.alternate;switch(_=R,(x=Lo).tag){case 0:case 11:case 15:break;case 1:var A=x.stateNode;if(4&x.effectTag)if(null===P)A.componentDidMount();else{var F=x.elementType===x.type?P.memoizedProps:Ai(x.type,P.memoizedProps);A.componentDidUpdate(F,P.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var D=x.updateQueue;null!==D&&si(0,D,A);break;case 3:var O=x.updateQueue;if(null!==O){if(g=null,null!==x.child)switch(x.child.tag){case 5:g=x.child.stateNode;break;case 1:g=x.child.stateNode}si(0,O,g)}break;case 5:var M=x.stateNode;null===P&&4&x.effectTag&&mr(x.type,x.memoizedProps)&&M.focus();break;case 6:case 4:case 12:case 13:case 17:break;default:a("163")}}if(128&S){var C=Lo.ref;if(null!==C){var U=Lo.stateNode;switch(Lo.tag){case 5:var I=U;break;default:I=U}"function"===typeof C?C(I):C.current=I}}Lo=Lo.nextEffect}}catch(e){r=!0,E=e}r&&(null===Lo&&a("178"),qo(Lo,E),null!==Lo&&(Lo=Lo.nextEffect))}Mo=No=!1,"function"===typeof kr&&kr(t.stateNode),S=t.expirationTime,0===(t=(t=t.childExpirationTime)>S?t:S)&&(Xo=null),e.expirationTime=t,e.finishedWork=null}function Ca(e){null===oa&&a("246"),oa.expirationTime=0,sa||(sa=!0,la=e)}function Ua(e,t){var n=ca;ca=!0;try{return e(t)}finally{(ca=n)||ia||Fa(1073741823,!1)}}function Ia(e,t){if(ca&&!fa){fa=!0;try{return e(t)}finally{fa=!1}}return e(t)}function Ba(e,t,n){if(pa)return e(t,n);ca||ia||0===ua||(Fa(ua,!1),ua=0);var r=pa,i=ca;ca=pa=!0;try{return e(t,n)}finally{pa=r,(ca=i)||ia||Fa(1073741823,!1)}}function ka(e,t,n,r,i){var o=t.current;e:if(n){n=n._reactInternalFiber;t:{2===tn(n)&&1===n.tag||a("170");var u=n;do{switch(u.tag){case 3:u=u.stateNode.context;break t;case 1:if(Dr(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break t}}u=u.return}while(null!==u);a("171"),u=void 0}if(1===n.tag){var s=n.type;if(Dr(s)){n=Ur(n,s,u);break e}}n=u}else n=xr;return null===t.context?t.context=n:t.pendingContext=n,t=i,(i=ti(r)).payload={element:e},null!==(t=void 0===t?null:t)&&(i.callback=t),Vo(),ri(o,i),Jo(o,r),r}function La(e,t,n,r){var i=t.current;return ka(e,t,n,i=Qo(Ea(),i),r)}function Na(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function ja(e){var t=1073741822-25*(1+((1073741822-Ea()+500)/25|0));t>=Do&&(t=Do-1),this._expirationTime=Do=t,this._root=e,this._callbacks=this._next=null,this._hasChildren=this._didComplete=!1,this._children=null,this._defer=!0}function za(){this._callbacks=null,this._didCommit=!1,this._onCommit=this._onCommit.bind(this)}function Xa(e,t,n){e={current:t=jr(3,null,null,t?3:0),containerInfo:e,pendingChildren:null,earliestPendingTime:0,latestPendingTime:0,earliestSuspendedTime:0,latestSuspendedTime:0,latestPingedTime:0,didError:!1,pendingCommitExpirationTime:0,finishedWork:null,timeoutHandle:-1,context:null,pendingContext:null,hydrate:n,nextExpirationTimeToWorkOn:0,expirationTime:0,firstBatch:null,nextScheduledRoot:null},this._internalRoot=t.stateNode=e}function Ga(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Va(e,t,n,r,i){Ga(n)||a("200");var o=n._reactRootContainer;if(o){if("function"===typeof i){var u=i;i=function(){var e=Na(o._internalRoot);u.call(e)}}null!=e?o.legacy_renderSubtreeIntoContainer(e,t,i):o.render(t,i)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new Xa(e,!1,t)}(n,r),"function"===typeof i){var s=i;i=function(){var e=Na(o._internalRoot);s.call(e)}}Ia(function(){null!=e?o.legacy_renderSubtreeIntoContainer(e,t,i):o.render(t,i)})}return Na(o._internalRoot)}function Ha(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return Ga(t)||a("200"),function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:qe,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)}Se=function(e,t,n){switch(t){case"input":if(Tt(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=L(r);i||a("90"),Ge(r),Tt(r,i)}}}break;case"textarea":Kn(e,n);break;case"select":null!=(t=n.value)&&Yn(e,!!n.multiple,t,!1)}},ja.prototype.render=function(e){this._defer||a("250"),this._hasChildren=!0,this._children=e;var t=this._root._internalRoot,n=this._expirationTime,r=new za;return ka(e,t,null,n,r._onCommit),r},ja.prototype.then=function(e){if(this._didComplete)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},ja.prototype.commit=function(){var e=this._root._internalRoot,t=e.firstBatch;if(this._defer&&null!==t||a("251"),this._hasChildren){var n=this._expirationTime;if(t!==this){this._hasChildren&&(n=this._expirationTime=t._expirationTime,this.render(this._children));for(var r=null,i=t;i!==this;)r=i,i=i._next;null===r&&a("251"),r._next=i._next,this._next=t,e.firstBatch=this}this._defer=!1,Da(e,n),t=this._next,this._next=null,null!==(t=e.firstBatch=t)&&t._hasChildren&&t.render(t._children)}else this._next=null,this._defer=!1},ja.prototype._onComplete=function(){if(!this._didComplete){this._didComplete=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++)(0,e[t])()}},za.prototype.then=function(e){if(this._didCommit)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},za.prototype._onCommit=function(){if(!this._didCommit){this._didCommit=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++){var n=e[t];"function"!==typeof n&&a("191",n),n()}}},Xa.prototype.render=function(e,t){var n=this._internalRoot,r=new za;return null!==(t=void 0===t?null:t)&&r.then(t),La(e,n,null,r._onCommit),r},Xa.prototype.unmount=function(e){var t=this._internalRoot,n=new za;return null!==(e=void 0===e?null:e)&&n.then(e),La(null,t,null,n._onCommit),n},Xa.prototype.legacy_renderSubtreeIntoContainer=function(e,t,n){var r=this._internalRoot,i=new za;return null!==(n=void 0===n?null:n)&&i.then(n),La(t,r,e,i._onCommit),i},Xa.prototype.createBatch=function(){var e=new ja(this),t=e._expirationTime,n=this._internalRoot,r=n.firstBatch;if(null===r)n.firstBatch=e,e._next=null;else{for(n=null;null!==r&&r._expirationTime>=t;)n=r,r=r._next;e._next=r,null!==n&&(n._next=e)}return e},Me=Ua,Ce=Ba,Ue=function(){ia||0===ua||(Fa(ua,!1),ua=0)};var Wa={createPortal:Ha,findDOMNode:function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;return void 0===t&&("function"===typeof e.render?a("188"):a("268",Object.keys(e))),e=null===(e=rn(t))?null:e.stateNode},hydrate:function(e,t,n){return Va(null,e,t,!0,n)},render:function(e,t,n){return Va(null,e,t,!1,n)},unstable_renderSubtreeIntoContainer:function(e,t,n,r){return(null==e||void 0===e._reactInternalFiber)&&a("38"),Va(e,t,n,!1,r)},unmountComponentAtNode:function(e){return Ga(e)||a("40"),!!e._reactRootContainer&&(Ia(function(){Va(null,null,e,!1,function(){e._reactRootContainer=null})}),!0)},unstable_createPortal:function(){return Ha.apply(void 0,arguments)},unstable_batchedUpdates:Ua,unstable_interactiveUpdates:Ba,flushSync:function(e,t){ia&&a("187");var n=ca;ca=!0;try{return Zo(e,t)}finally{ca=n,Fa(1073741823,!1)}},unstable_flushControlled:function(e){var t=ca;ca=!0;try{Zo(e)}finally{(ca=t)||ia||Fa(1073741823,!1)}},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{Events:[B,k,L,F.injectEventPluginsByName,_,V,function(e){S(e,G)},De,Oe,An,O]},unstable_createRoot:function(e,t){return Ga(e)||a("299","unstable_createRoot"),new Xa(e,!0,null!=t&&!0===t.hydrate)}};!function(e){var t=e.findFiberByHostInstance;(function(e){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var n=t.inject(e);kr=Nr(function(e){return t.onCommitFiberRoot(n,e)}),Lr=Nr(function(e){return t.onCommitFiberUnmount(n,e)})}catch(e){}})(i({},e,{findHostInstanceByFiber:function(e){return null===(e=rn(e))?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null}}))}({findFiberByHostInstance:I,bundleType:0,version:"16.6.1",rendererPackageName:"react-dom"});var Ya={default:Wa},qa=Ya&&Wa||Ya;e.exports=qa.default||qa},function(e,t,n){"use strict";e.exports=n(58)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=null,i=!1,o=3,a=-1,u=-1,s=!1,l=!1;function c(){if(!s){var e=r.expirationTime;l?v():l=!0,y(h,e)}}function f(){var e=r,t=r.next;if(r===t)r=null;else{var n=r.previous;r=n.next=t,t.previous=n}e.next=e.previous=null,n=e.callback,t=e.expirationTime,e=e.priorityLevel;var i=o,a=u;o=e,u=t;try{var s=n()}finally{o=i,u=a}if("function"===typeof s)if(s={callback:s,priorityLevel:e,expirationTime:t,next:null,previous:null},null===r)r=s.next=s.previous=s;else{n=null,e=r;do{if(e.expirationTime>=t){n=e;break}e=e.next}while(e!==r);null===n?n=r:n===r&&(r=s,c()),(t=n.previous).next=n.previous=s,s.next=n,s.previous=t}}function p(){if(-1===a&&null!==r&&1===r.priorityLevel){s=!0;try{do{f()}while(null!==r&&1===r.priorityLevel)}finally{s=!1,null!==r?c():l=!1}}}function h(e){s=!0;var n=i;i=e;try{if(e)for(;null!==r;){var o=t.unstable_now();if(!(r.expirationTime<=o))break;do{f()}while(null!==r&&r.expirationTime<=o)}else if(null!==r)do{f()}while(null!==r&&!_())}finally{s=!1,i=n,null!==r?c():l=!1,p()}}var d,m,y,v,_,g=Date,b="function"===typeof setTimeout?setTimeout:void 0,w="function"===typeof clearTimeout?clearTimeout:void 0,T="function"===typeof requestAnimationFrame?requestAnimationFrame:void 0,E="function"===typeof cancelAnimationFrame?cancelAnimationFrame:void 0;function R(e){d=T(function(t){w(m),e(t)}),m=b(function(){E(d),e(t.unstable_now())},100)}if("object"===typeof performance&&"function"===typeof performance.now){var x=performance;t.unstable_now=function(){return x.now()}}else t.unstable_now=function(){return g.now()};if("undefined"!==typeof window&&window._schedMock){var S=window._schedMock;y=S[0],v=S[1],_=S[2]}else if("undefined"===typeof window||"function"!==typeof window.addEventListener){var P=null,A=-1,F=function(e,t){if(null!==P){var n=P;P=null;try{A=t,n(e)}finally{A=-1}}};y=function(e,t){-1!==A?setTimeout(y,0,e,t):(P=e,setTimeout(F,t,!0,t),setTimeout(F,1073741823,!1,1073741823))},v=function(){P=null},_=function(){return!1},t.unstable_now=function(){return-1===A?0:A}}else{"undefined"!==typeof console&&("function"!==typeof T&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!==typeof E&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));var D=null,O=!1,M=-1,C=!1,U=!1,I=0,B=33,k=33;_=function(){return I<=t.unstable_now()};var L="__reactIdleCallback$"+Math.random().toString(36).slice(2);window.addEventListener("message",function(e){if(e.source===window&&e.data===L){O=!1,e=D;var n=M;D=null,M=-1;var r=t.unstable_now(),i=!1;if(0>=I-r){if(!(-1!==n&&n<=r))return C||(C=!0,R(N)),D=e,void(M=n);i=!0}if(null!==e){U=!0;try{e(i)}finally{U=!1}}}},!1);var N=function(e){if(null!==D){R(N);var t=e-I+k;t<k&&B<k?(8>t&&(t=8),k=t<B?B:t):B=t,I=e+k,O||(O=!0,window.postMessage(L,"*"))}else C=!1};y=function(e,t){D=e,M=t,U||0>t?window.postMessage(L,"*"):C||(C=!0,R(N))},v=function(){D=null,O=!1,M=-1}}t.unstable_ImmediatePriority=1,t.unstable_UserBlockingPriority=2,t.unstable_NormalPriority=3,t.unstable_IdlePriority=4,t.unstable_runWithPriority=function(e,n){switch(e){case 1:case 2:case 3:case 4:break;default:e=3}var r=o,i=a;o=e,a=t.unstable_now();try{return n()}finally{o=r,a=i,p()}},t.unstable_scheduleCallback=function(e,n){var i=-1!==a?a:t.unstable_now();if("object"===typeof n&&null!==n&&"number"===typeof n.timeout)n=i+n.timeout;else switch(o){case 1:n=i+-1;break;case 2:n=i+250;break;case 4:n=i+1073741823;break;default:n=i+5e3}if(e={callback:e,priorityLevel:o,expirationTime:n,next:null,previous:null},null===r)r=e.next=e.previous=e,c();else{i=null;var u=r;do{if(u.expirationTime>n){i=u;break}u=u.next}while(u!==r);null===i?i=r:i===r&&(r=e,c()),(n=i.previous).next=i.previous=e,e.next=i,e.previous=n}return e},t.unstable_cancelCallback=function(e){var t=e.next;if(null!==t){if(t===e)r=null;else{e===r&&(r=t);var n=e.previous;n.next=t,t.previous=n}e.next=e.previous=null}},t.unstable_wrapCallback=function(e){var n=o;return function(){var r=o,i=a;o=n,a=t.unstable_now();try{return e.apply(this,arguments)}finally{o=r,a=i,p()}}},t.unstable_getCurrentPriorityLevel=function(){return o},t.unstable_shouldYield=function(){return!i&&(null!==r&&r.expirationTime<u||_())}},function(e,t,n){"use strict";var r=n(8),i=n(14),o=(n.n(i),n(60)),a=(n.n(o),n(61)),u=n(63),s=function(e){function t(n){var r=e.call(this,n)||this;return r.onSampleClick=function(e){t.sampleRunner.LoadSample(e).then(function(t){t&&history.pushState(null,"Iris-sample | "+e,""+e)})},r.canvas=i.createRef(),document.title="Iris samples",r}return r.c(t,e),t.prototype.render=function(){var e=[],t=u.a.Samples;for(var n in t)t.hasOwnProperty(n)&&e.push({key:n,path:n});return i.createElement("div",{className:"App"},i.createElement("div",{className:"AppMenu"},i.createElement("h2",{className:"AppTitle"},"Iris-samples"),i.createElement(a.a,{sampleEnter:e,onMenuItemClick:this.onSampleClick})),i.createElement("canvas",{ref:this.canvas,className:"AppCanvas"}))},t.prototype.componentDidMount=function(){if(null==t.sampleRunner){var e=this.canvas.current;if(null!=e){var n=new u.a(e);t.sampleRunner=n;var r=window.location.pathname.substr(1);n.LoadInitSample(r)}}},t}(i.Component);t.a=s},function(e,t){},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(8),i=n(14),o=(n.n(i),n(62)),a=(n.n(o),function(e){function t(t){var n=e.call(this,t)||this;return n.onItemClick=function(e){var t=e.target.innerText;null!=t&&n.props.onMenuItemClick(t)},n}return r.c(t,e),t.prototype.render=function(){var e=this;return i.createElement("div",{className:"sample-menu"},this.props.sampleEnter.map(function(t,n){return i.createElement("a",{onClick:e.onItemClick,key:t.key,className:"menu-item"},t.key)}))},t}(i.Component))},function(e,t){},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(8),i=n(9),o=(n.n(i),n(70)),a=function(){function e(e){this.m_timer=new i.FrameTimer(!1),this.m_canvas=e;var t=new i.GraphicsRender(e);this.m_graphicsRender=t,i.Input.init(e),i.GLUtility.setTargetFPS(60),i.GLUtility.registerOnFrame(this.onFrame.bind(this)),i.WindowUtility.setOnResizeFunc(this.onResize.bind(this))}return Object.defineProperty(e,"Samples",{get:function(){return e.s_samples},enumerable:!0,configurable:!0}),e.prototype.LoadInitSample=function(t){return r.a(this,void 0,void 0,function(){return r.d(this,function(n){switch(n.label){case 0:return null!=t&&null!=e.s_samples[t]||(t=e.s_startSample),[4,this.LoadSample(t)];case 1:return n.sent(),[2]}})})},e.prototype.onResize=function(){var e=this.m_canvas,t=this.m_graphicsRender,n=e.clientWidth,r=e.clientHeight;t.resizeCanvas(n,r)},e.prototype.onFrame=function(e){var t=this.m_timer.tick(e)/1e3,n=this.m_curprogram;null!=n&&(i.Input.onFrame(t),n.onFrame(t))},e.registerSample=function(t,n){e.s_samples[n]=t.prototype,null==e.s_startSample&&(e.s_startSample=n)},e.Setup=function(){if(!e.s_setup){var t=o.a;for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];e.registerSample(r,n)}e.s_setup=!0}},e.prototype.LoadSample=function(t){return r.a(this,void 0,Promise,function(){var n,i,o,a;return r.d(this,function(r){switch(r.label){case 0:if(null==(n=e.s_samples[t]))return[2,!1];if(null!=(i=this.m_curprogram)){if(Object.getPrototypeOf(i)==n)return[2,!1];i.onRelease(),this.m_curprogram=null}return o=this.m_graphicsRender,[4,(a=Object.create(n)).onInit()];case 1:return r.sent(),[4,a.onSetupRender(o)];case 2:return r.sent(),[4,a.onSetupScene()];case 3:return r.sent(),this.m_curprogram=a,this.onResize(),[2,!0]}})})},e.s_samples={},e.s_setup=!1,e}();a.Setup()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.SHADERFX_BASIS="#define PI 3.1415926\n#define PI_2 6.2831852\n#define PI_HALF 1.5707963\nuniform UNIFORM_OBJ{\n    mat4 _obj2world_;\n};\n#define MATRIX_M _obj2world_\nuniform UNIFORM_BASIS{\n    //basic region\n    vec4 _screenparam_;//[width,height,1/wdith,1/height]\n    highp vec4 _time_;//[Time,deltaTime,sinTime,cosTime]\n    //camera\n    vec4 _camera_pos_;\n    mat4 _camera_mtx_view_;\n    vec4 _camera_projparam_;//[near,far,1/near,1/far]\n    mat4 _camera_mtx_proj_;\n    mat4 _camera_mtx_invproj_;\n    //Ambient And Fog\n    lowp vec4 _ambientcolor_;\n    vec4 _fogcolor_;\n    vec4 _fogparam_;\n};\n#define TIME _time_\n#define SCREEN _screenparam_\n\n#define MATRIX_V _camera_mtx_view_\n#define MATRIX_P _camera_mtx_proj_\n#define MATRIX_VP MATRIX_P * MATRIX_V\n#define MATRIX_MV MATRIX_V * MATRIX_M\n#define MATRIX_IT_MV transpose(inverse(MATRIX_MV))\n#define MATRIX_MVP MATRIX_P * MATRIX_MV\n#define MATRIX_INV_P _camera_mtx_invproj_\n#define MATRIX_WORLD2OBJ inverse(MATRIX_M)\n#define CAMERA_POS _camera_pos_\n#define CAMERA_NEAR _camera_projparam_.x\n#define CAMERA_FAR _camera_projparam_.y\n#define CAMERA_NEAR_INV _camera_projparam_.z\n#define CAMERA_FAR_INV _camera_projparam_.w\n#define SCREEN_WIDTH _screenparam_.x\n#define SCREEN_HEIGHT _screenparam_.y\n#define SCREEN_WIDTH_INV _screenparam_.z\n#define SCREEN_HEIGHT_INV _screenparam_.w\nvec3 ObjToWorldDir(in vec3 dir){\n    return normalize(dir * mat3(MATRIX_WORLD2OBJ));\n}\nfloat SAMPLE_DEPTH_TEXTURE(sampler2D depthtex,vec2 uv){\n    return texture(depthtex,uv).r;\n}\nfloat DECODE_VIEWDEPTH(float d){\n    return 1.0/ ((CAMERA_NEAR_INV - CAMERA_FAR_INV) * d  - CAMERA_NEAR_INV);\n}\nvec4 ClipToWorld(in vec4 clippoint){\n    return inverse(MATRIX_VP) * clippoint;\n}",e.SHADERFX_LIGHT="struct LIGHT_DATA{\n    vec4 pos_type;\n    vec4 col_intensity;\n};\nuniform UNIFORM_LIGHT{\n    LIGHT_DATA light_source[4];\n    vec4 ambient_color;\n};\n#define LIGHT_COLOR0 light_source[0].col_intensity.xyz\n#define LIGHT_COLOR1 light_source[1].col_intensity.xyz\n#define LIGHT_COLOR2 light_source[2].col_intensity.xyz\n#define LIGHT_COLOR3 light_source[3].col_intensity.xyz\n\n#define LIGHT_INTENSITY0 light_source[0].col_intensity.w\n#define LIGHT_INTENSITY1 light_source[1].col_intensity.w\n#define LIGHT_INTENSITY2 light_source[2].col_intensity.w\n#define LIGHT_INTENSITY3 light_source[3].col_intensity.w\n\n#define LIGHT_DIR0 light_source[0].pos_type.xyz\n#define LIGHT_DIR1 light_source[1].pos_type.xyz",e.SHADERFX_LIGHTING="vec3 LightModel_Lambert(vec3 lightdir,vec3 lightColor,vec3 normal,vec3 albedo){\n    float diff = max(.0,dot(-lightdir,normal));\n    return albedo * lightColor * diff;\n}",e.SHADERFX_SHADOWMAP="#options SMCASCADE NONE TWO FOUR\n#options SHADOW ON OFF\n\n#ifdef SHADOW_ON\n\nuniform UNIFORM_SHADOWMAP{\n    mat4 uLightMtx[4];\n    float uShadowDist;\n};\nuniform sampler2D uShadowMap;\n\nfloat computeShadow(vec4 vLightPos,sampler2D shadowsampler){\n    vec3 clipspace = vLightPos.xyz / vLightPos.w;\n    clipspace = clipspace *0.5 + 0.5;\n    float shadowDep = texture(shadowsampler,vec2(clipspace.xy)).x;\n    \n    //fix shadowmpa edge clamp\n    vec2 border = step(clipspace.xy,vec2(0.002));\n    border += step(vec2(0.998),clipspace.xy);\n    shadowDep += (border.x + border.y);\n\n    return step(clipspace.z- 0.01,shadowDep);\n}\n\nfloat computeShadowPoisson(vec4 vLightPos,sampler2D shadowsampler){\n    vec3 clipspace = vLightPos.xyz / vLightPos.w;\n    clipspace = clipspace *0.5 + 0.5;\n\n    vec2 coord = clipspace.xy;\n    float curdepth = clipspace.z - 0.01;\n    float visibility = 1.0;\n\n    float mapsize = 1.0/1024.0;\n\n    vec2 poissonDisk[4];\n        poissonDisk[0] = vec2(-0.94201624, -0.39906216);\n        poissonDisk[1] = vec2(0.94558609, -0.76890725);\n        poissonDisk[2] = vec2(-0.094184101, -0.92938870);\n        poissonDisk[3] = vec2(0.34495938, 0.29387760);\n\n    if(texture(shadowsampler,coord + poissonDisk[0] * mapsize).r <curdepth) visibility -=0.25;\n    if(texture(shadowsampler,coord + poissonDisk[1] * mapsize).r <curdepth) visibility -=0.25;\n    if(texture(shadowsampler,coord + poissonDisk[2] * mapsize).r <curdepth) visibility -=0.25;\n    if(texture(shadowsampler,coord + poissonDisk[3] * mapsize).r <curdepth) visibility -=0.25;\n    return visibility;\n}\n\nfloat computeShadowPCF3(vec4 vLightPos,sampler2DShadow shadowsampler){\n    vec3 clipspace = vLightPos.xyz / vLightPos.w;\n    clipspace = clipspace *0.5 + 0.5;\n\n    vec2 shadowMapSizeInv = vec2(1024.0,1.0/1024.0);\n\n    float curdepth = clipspace.z;\n\n    vec2 uv = clipspace.xy *shadowMapSizeInv.x;\n    uv += 0.5;\n    vec2 st = fract(uv);\n    vec2 base_uv = floor(uv) - 0.5;\n    base_uv *= shadowMapSizeInv.y;\n\n    vec2 uvw0 = 3. - 2. * st;\n    vec2 uvw1 = 1. + 2. * st;\n    vec2 u = vec2((2. - st.x) / uvw0.x - 1., st.x / uvw1.x + 1.) * shadowMapSizeInv.y;\n    vec2 v = vec2((2. - st.y) / uvw0.y - 1., st.y / uvw1.y + 1.) * shadowMapSizeInv.y;\n\n    float shadow = 0.;\n    shadow += uvw0.x * uvw0.y * texture(shadowsampler, vec3(base_uv.xy + vec2(u[0], v[0]), curdepth));\n    shadow += uvw1.x * uvw0.y * texture(shadowsampler, vec3(base_uv.xy + vec2(u[1], v[0]), curdepth));\n    shadow += uvw0.x * uvw1.y * texture(shadowsampler, vec3(base_uv.xy + vec2(u[0], v[1]), curdepth));\n    shadow += uvw1.x * uvw1.y * texture(shadowsampler, vec3(base_uv.xy + vec2(u[1], v[1]), curdepth));\n    shadow = shadow / 16.;\n    return shadow;\n}\n\n#endif",e.blit="#version 300 es\n\nprecision mediump float;\n#queue opaque\ninout vec2 vUV;\n#pragma vs vertex\nin vec4 aPosition;\nin vec2 aUV;\nvoid vertex(){\n    vec4 pos = aPosition;\n    pos.xy *=2.0;\n    vUV = vec2(aUV.x,1.0 -aUV.y);\n    gl_Position = pos;\n}\n#pragma ps fragment\nuniform sampler2D uSampler;\nout vec4 fragColor;\nvoid fragment(){\n    fragColor = texture(uSampler,vUV);\n}",e.depth="#version 300 es\n\nprecision mediump float;\n#include SHADERFX_BASIS\n#queue other\n#pragma vs vertex\n#pragma ps fragment\n\nin vec4 aPosition;\nvoid vertex(){\n    gl_Position = MATRIX_MVP * aPosition;\n}\n\nvoid fragment(){\n}",e.diffuse="#version 300 es\n\nprecision mediump float;\n#include SHADERFX_BASIS\n#include SHADERFX_LIGHT\n#include SHADERFX_LIGHTING\n\n#queue opaque\n#pragma vs vertex\n#pragma ps fragment\n\nin vec4 aPosition;\nin vec2 aUV;\nin vec4 aNormal;\n\nstruct V2F{\n    vec3 pos;\n    vec3 normal;\n};\ninout V2F v2f;\n\nvoid vertex(){\n    vec4 wpos = MATRIX_M * aPosition;\n    v2f.pos = wpos.xyz;\n    vec4 pos = MATRIX_VP * wpos;\n    gl_Position = pos;\n    v2f.normal = ObjToWorldDir(aNormal.xyz);\n}\n\nout lowp vec4 fragColor;\nuniform vec4 uColor;\nvoid fragment(){\n    vec3 lcolor = LightModel_Lambert(LIGHT_DIR0,LIGHT_COLOR0,v2f.normal,uColor.xyz);\n    fragColor = vec4(lcolor +0.1,1.0);\n}",e.gizmos="#version 300 es\n\nprecision mediump float;\n#include SHADERFX_BASIS\n#queue other\n#pragma vs vertex\n#pragma ps fragment\n\nin vec4 aPosition;\n\nvoid vertex(){\n    vec4 vpos = aPosition;\n    gl_Position = MATRIX_MVP * vpos;\n}\n\nout vec4 fragColor;\nvoid fragment(){\n    fragColor = vec4(1.0);\n}",e.pbrMetallicRoughness="#version 300 es\n\nprecision mediump float;\n#include SHADERFX_BASIS\n#include SHADERFX_LIGHT\n#include SHADERFX_SHADOWMAP\n#queue opaque\n\nstruct V2F{\n    vec4 wpos;\n    vec2 uv;\n    vec3 normal;\n    #ifdef SHADOW_ON\n    vec4 lpos;\n    #endif\n};\n\ninout V2F v2f;\n\n#pragma vs vertex\n\nin vec3 aPosition;\nin vec3 aNormal;\nin vec2 aUV;\n\nvoid vertex(){\n\n    vec4 wpos = MATRIX_M * vec4(aPosition,1.0);\n    v2f.wpos = wpos;\n    #ifdef SHADOW_ON\n    v2f.lpos = uLightMtx[0] * wpos;\n    #endif\n    v2f.normal = ObjToWorldDir(aNormal.xyz);\n    gl_Position = MATRIX_VP * wpos;\n    v2f.uv = aUV;\n}\n\n#pragma ps fragment\n\nuniform uPBR{\n    vec4 uColor;\n    float uMetallic;\n    float uRoughness;\n    float uEmissive;\n};\n\nuniform sampler2D uSampler;\nuniform sampler2D uTexMetallicRoughness;\nuniform sampler2D uTexEmissive;\n\nout vec4 fragColor;\n\nvec3 diffuse(vec3 diffcolor){\n    return diffcolor / PI;\n}\n\nvec3 specularReflection(float metallic,float vdoth){\n    return metallic + (vec3(1.0) - metallic) * pow(1.0- vdoth,5.0);\n}\n\nfloat microfacetDistribution(float alphaRoughness,float NdotH)\n{\n    float roughnessSq = alphaRoughness * alphaRoughness;\n    float f = (NdotH * roughnessSq - NdotH) * NdotH + 1.0;\n    return roughnessSq / (PI * f * f);\n}\n\nfloat geometricOcclusion(float NdotV, float NdotH,float VdotH,float NdotL)\n{\n    return min(min(2.0 * NdotV * NdotH / VdotH, 2.0 * NdotL * NdotH / VdotH), 1.0);\n}\n\n\nvoid fragment(){\n\n    vec2 uv = v2f.uv;\n    vec3 wpos = v2f.wpos.xyz;\n    vec3 diffColor = texture(uSampler,uv).xyz;\n\n    vec3 n = v2f.normal;\n    vec3 v = normalize(CAMERA_POS.xyz - wpos);\n    vec3 l = -LIGHT_DIR0;\n    vec3 h = normalize(v+l);\n\n    float roughness = uRoughness;\n    float metallic = uMetallic;\n\n    float NdotL = clamp(dot(n, l), 0.001, 1.0);\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    float NdotH = clamp(dot(n, h), 0.0, 1.0);\n    //float LdotH = clamp(dot(l, h), 0.0, 1.0);\n    float VdotH = clamp(dot(v, h), 0.0, 1.0);\n\n    vec3 F = specularReflection(metallic,VdotH);\n    float D = microfacetDistribution(roughness,NdotH);\n    float G = geometricOcclusion(NdotV,NdotH,VdotH,NdotL);\n\n    vec3 diff = (vec3(1.0) - F) * diffColor;\n    vec3 spec = F  * (G * D / (4.0 * NdotL * NdotV));\n\n    vec3 col = NdotL * LIGHT_COLOR0 * (diff + spec);\n\n    vec3 ambient = ambient_color.a * ambient_color.rgb;\n\n    col += ambient;\n\n    #ifdef SHADOW_ON\n    float shadow = computeShadow(v2f.lpos,uShadowMap);\n    shadow = clamp(shadow+0.5,0.0,1.0);\n    col = mix(min(col,ambient),col,shadow);\n    #endif\n\n    fragColor = vec4(col *1.2,1.0);\n\n}",e.shadowmap="#version 300 es\n\nprecision mediump float;\n#include SHADERFX_BASIS\n#queue other\n#pragma vs vertex\n#pragma ps fragment\n\nuniform mat4 uLightVP;\n\nin vec4 aPosition;\nvoid vertex(){\n    gl_Position = (uLightVP * MATRIX_M) * aPosition;\n}\n\nvoid fragment(){\n}",e.shadowsGather="#version 300 es\n\nprecision mediump float;\n#include SHADERFX_BASIS\n#include SHADERFX_SHADOWMAP\n\ninout vec2 vUV;\ninout vec3 vvdir;\n\n#pragma vs vertex\n\nin vec4 aPosition;\nvoid vertex(){\n    vec4 pos = aPosition;\n    vUV = pos.xy +0.5;\n    pos.xy *=2.0;\n\n    vec4 clippos = vec4(pos.xy *2.0,1.0,1.0);\n    vec4 cwpos = ClipToWorld(clippos);\n\n    vvdir = (cwpos.xyz / cwpos.w) - CAMERA_POS.xyz;\n    \n    gl_Position = pos;\n}\n\n#pragma ps fragment\n\nout vec4 fragColor;\nuniform sampler2D uDepthTexure;\nvoid fragment(){\n    float eyedepth = DECODE_VIEWDEPTH(SAMPLE_DEPTH_TEXTURE(uDepthTexure,vUV));\n    vec3 dir = normalize(vvdir);\n    vec3 wpos = dir * eyedepth + CAMERA_POS.xyz;\n    vec4 lpos = uLightMtx[0] * vec4(wpos,1.0);\n    vec3 lcpos = lpos.xyz / lpos.w;\n    lcpos = lpos.xyz *0.5 +0.5;\n    vec2 coord=  lcpos.xy;\n    float shadowDep = texture(uShadowMap,coord).x;\n    float d = shadowDep;// lcpos.z;\n    fragColor = vec4(lcpos.z -1.0,0,0,1.0);\n}",e.skybox="#version 300 es\n\nprecision mediump float;\n#include SHADERFX_BASIS\n#options ENVMAP_TYPE CUBE TEX \n#queue skybox\n\n#ifdef ENVMAP_TYPE_CUBE\ninout vec4 vWorldDir;\nuniform samplerCube uSampler;\n#endif\n#ifdef ENVMAP_TYPE_TEX\ninout vec3 vWorldDir;\nuniform sampler2D uSampler;\n#endif\n\n#pragma vs vertex\n\nin vec4 aPosition;\nvoid vertex(){\n    vec4 pos = aPosition;\n    pos.xy*=2.0;\n    pos.z = 1.0;\n    gl_Position = pos;\n\n    vec4 wpos =  inverse(MATRIX_VP) * pos;\n    wpos.xyz = wpos.xyz / wpos.w - CAMERA_POS.xyz;\n    #ifdef ENVMAP_TYPE_CUBE\n    vWorldDir = wpos;\n    #endif\n\n    #ifdef ENVMAP_TYPE_TEX\n    vWorldDir = wpos.xyz;\n    #endif\n    \n}\n\n#pragma ps fragment\nout lowp vec4 fragColor;\nvoid fragment(){\n    vec3 dir = vWorldDir.xyz;\n    #ifdef ENVMAP_TYPE_CUBE\n    fragColor = texture(uSampler,dir);\n    #endif\n    #ifdef ENVMAP_TYPE_TEX\n    dir = normalize(dir);\n    float y = 1.0 - 0.5 *(1.0 + dir.y);\n    float x = atan(dir.z,dir.x) / PI_2 + 0.5;\n    fragColor = texture(uSampler,vec2(x,y));\n    #endif\n}",e.UnlitColor="#version 300 es\n\nprecision mediump float;\n#include SHADERFX_BASIS\n#queue opaque\n\n#pragma vs vertex\nin vec4 aPosition;\nvoid vertex(){\n    gl_Position = MATRIX_MVP * aPosition;\n}\n\n#pragma ps fragment\nuniform vec4 uColor;\nout vec4 fragColor;\nvoid fragment(){\n    fragColor = uColor;\n}",e.UnlitTexture="#version 300 es\n\nprecision mediump float;\n#include SHADERFX_BASIS\n\n#queue opaque\n\ninout vec2 vUV;\n\n\n#pragma vs vertex\nin vec4 aPosition;\nin vec2 aUV;\nvoid vertex(){\n    gl_Position = MATRIX_MVP * aPosition;\n    vUV = aUV;\n}\n\n#pragma ps fragment\n\nuniform sampler2D uSampler;\nout vec4 fragColor;\nvoid fragment(){\n    fragColor = texture(uSampler,vUV);\n}",e.uvValue="#version 300 es\n\nprecision mediump float;\n#include SHADERFX_BASIS\n\ninout vec2 vUV;\n\n#pragma vs vertex\nin vec4 aPosition;\nin vec2 aUV;\nvoid vertex(){\n    gl_Position = MATRIX_MVP * aPosition;\n    vUV = aUV;\n}\n\n#pragma ps fragment\nout vec4 fragColor;\nvoid fragment(){\n    fragColor = vec4(vUV,0,1.0);\n}",e}();t.ShaderGen=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(){function e(){this.nodeOpaque=[],this.nodeTransparent=[],this.nodeImage=[]}return e.prototype.reset=function(){0!=this.nodeOpaque.length&&(this.nodeOpaque=[]),0!=this.nodeTransparent.length&&(this.nodeTransparent=[]),0!=this.nodeImage.length&&(this.nodeImage=[])},e.prototype.pushRenderNode=function(e){var t=e.material.shaderTags;if(null!=t)switch(t.queue){case r.RenderQueue.Opaque:this.nodeOpaque.push(e);break;case r.RenderQueue.Transparent:this.nodeTransparent.push(e);break;case r.RenderQueue.Image:this.nodeImage.push(e)}},e.prototype.sort=function(){},e}();t.RenderNodeList=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(){function e(e){this.gl=e.gl,this.m_curtags=new r.ShaderTags}return e.prototype.reset=function(e){this.m_lastTags=null;var t=this.m_curtags,n=this.gl;if(null!=e.ztest){var i=e.ztest;t.ztest!=i&&(t.ztest=i,n.depthFunc(i))}if(null!=e.culling){var o=e.culling;if(t.culling!=o){var a=t.culling;t.culling=o,o==r.CullingMode.None?n.disable(n.CULL_FACE):(a==r.CullingMode.None&&n.enable(n.CULL_FACE),n.cullFace(o))}}if(null!=e.zwrite){var u=e.zwrite;t.zwrite!=u&&(t.zwrite=u,n.depthMask(u))}var s=e.blend;t.blend!=s&&(s?n.enable(n.BLEND):n.disable(n.BLEND)),this.m_deftags=e},e.prototype.setZTest=function(e){var t=this.m_curtags;t.ztest!=e&&(t.ztest=e,this.gl.depthFunc(e))},e.prototype.setZWrite=function(e){var t=this.m_curtags;t.zwrite!=e&&(t.zwrite=e,this.gl.depthMask(e))},e.prototype.setBlend=function(e){var t=this.m_curtags;if(t.blend!=e){t.blend=e;var n=this.gl;e?n.enable(n.BLEND):n.disable(n.BLEND)}},e.prototype.apply=function(e){if(this.m_lastTags!=e){var t=this.m_deftags,n=this.m_curtags,i=this.gl,o=e.ztest;null==o&&(o=t.ztest),o!=n.ztest&&(n.ztest=o,i.depthFunc(o));var a=e.culling;if(null==a&&(a=t.culling),a!=n.culling){var u=n.culling;n.culling=a,a==r.CullingMode.None?i.disable(i.CULL_FACE):(u==r.CullingMode.None&&i.enable(i.CULL_FACE),i.cullFace(a))}var s=e.zwrite;null==s&&(s=t.zwrite),s!=n.zwrite&&(n.zwrite=s,i.depthMask(s));var l=e.blend;l!=n.blend&&(l?i.enable(i.BLEND):i.disable(i.BLEND)),this.m_lastTags=e}},e.prototype.release=function(){},e}();t.PipelineStateCache=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=n(11),o=function(){function e(e){this.m_indicesCount=0,this.m_topology=e,this.m_positions=[],this.m_indiecs=[]}return e.prototype.addLine=function(e,t){this.m_positions.push(e.x,e.y,e.z,1,t.x,t.y,t.z,1);var n=this.m_indiecs,r=this.m_indicesCount;n.push(r,r+1),this.m_indicesCount+=2},e.prototype.addPoint=function(e){},e.prototype.addTri=function(e,t,n){var r=this.m_positions;r.push(e.x,e.y,e.z,1),r.push(t.x,t.y,t.z,1),r.push(n.x,n.y,n.z,1);var i=this.m_indicesCount;this.m_indiecs.push(i,i+1,i+2),this.m_indicesCount=i+3},e.prototype.genMesh=function(){var e=this.m_topology,t=new r.Mesh;return t.setPosition(new Float32Array(this.m_positions),i.GLConst.FLOAT,4),t.setIndices(new Uint16Array(this.m_indiecs),i.GLConst.UNSIGNED_SHORT,e),t},e}();t.MeshBuilder=o},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t){return e.call(this,t,!0)||this}return r(t,e),t.prototype.refreshMeshBuffer=function(e){if(!this.m_bufferInited){var t=e.gl;if(!this.m_seperatedBuffer)throw new Error("dynamic buffer only support seperated buffer currently");var n=this.vertexDesc,r=n.position;if(null!=r){var i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i);var o=this.m_dataPosition;o&&t.bufferData(t.ARRAY_BUFFER,o,t.DYNAMIC_DRAW),this.bufferVertices=i,r.offset=0}if(null!=n.uv){i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i);var a=this.m_dataUV;a&&t.bufferData(t.ARRAY_BUFFER,a,t.DYNAMIC_DRAW),this.bufferUV=i,r.offset=0}if(null!=n.normal){i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i);var u=this.m_dataNormal;u&&t.bufferData(t.ARRAY_BUFFER,u,t.DYNAMIC_DRAW),this.bufferNormal=i,r.offset=0}t.bindBuffer(t.ARRAY_BUFFER,null);var s=this.m_dataIndices;if(null!=s&&0!=s.length){i=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i),t.bufferData(t.ELEMENT_ARRAY_BUFFER,s,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),this.bufferIndices=i}this.m_bufferInited=!0}},t.prototype.uploadDataBufferPosition=function(e,t){void 0===t&&(t=null);var n=this.bufferVertices;if(null==n)throw new Error("buffer is null");var r=null;if(null!=t&&t!=this.m_dataPosition){if(t.byteLength>this.m_dataPosition.byteLength)throw new Error("buffer overflow");r=t}else r=this.m_dataPosition;e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,r,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null)},t.prototype.uploadDataBufferUV=function(e,t){void 0===t&&(t=null);var n=this.bufferUV;if(null==n)throw new Error("uvbuffer is null");var r=null;if(null!=t&&t!=this.m_dataUV){if(t.byteLength>this.m_dataUV.byteLength)throw new Error("uvbuffer overflow");r=t}else r=this.m_dataUV;e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,r,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null)},t.prototype.uploadDataBufferNormal=function(e,t){void 0===t&&(t=null);var n=this.bufferNormal;if(null==n)throw new Error("normal buffer is null");var r=null;if(null!=t&&t!=this.m_dataNormal){if(t.byteLength>this.m_dataNormal.byteLength)throw new Error("normal buffer overflow");r=t}else r=this.m_dataNormal;e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,r,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null)},t.prototype.uploadDataBufferIndices=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!0);var r=this.bufferIndices;if(null==r)throw new Error("normal buffer is null");var i=null;if(null!=t&&t!=this.m_dataIndices){if(t.byteLength>this.m_dataIndices.byteLength)throw new Error("normal buffer overflow");i=t}else i=this.m_dataIndices;e.bindBuffer(e.ARRAY_BUFFER,r),e.bufferData(e.ARRAY_BUFFER,i,n?e.DYNAMIC_DRAW:e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null)},t}(n(5).Mesh);t.DynamicMesh=i},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,u)}s((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),u=n(25),s=n(13),l=n(21),c=n(29),f=n(23),p=n(28),h=n(10),d=n(24),m=n(44),y=n(42),v=n(43),_=n(37),g=n(45),b=n(33),w=n(22),T=function(){function e(t){this.m_sceneInited=!1,this.m_timer=new v.FrameTimer(!1),e.Instance=this,this.m_canvas=t;var n=new b.PipelineForwardZPrePass;this.m_pipeline=n;var r=new c.GraphicsRender(t,n);this.m_sceneMgr=new m.SceneManager,r.shadowConfig.shadowDistance=20,this.m_graphicsRender=r,d.Input.init(t),this.createScene(r.glctx),a.GLUtility.setTargetFPS(60),a.GLUtility.registerOnFrame(this.onFrame.bind(this)),this.resizeCanvas(),h.WindowUtility.setOnResizeFunc(this.resizeCanvas.bind(this))}return e.prototype.resizeCanvas=function(){var e=this.m_canvas;this.m_graphicsRender.resizeCanvas(e.clientWidth,e.clientHeight)},e.prototype.onFrame=function(e){if(this.m_sceneInited){var t=this.m_timer.tick(e)/1e3;d.Input.onFrame(t);var n=this.m_scene;this.m_sceneMgr.onFrame(n);var r=this.m_graphicsRender;r.render(n,t),r.renderToCanvas()}},e.prototype.createScene=function(e){return i(this,void 0,void 0,function(){var t,n,r,i,c,p,d,m,v,b,T;return o(this,function(o){switch(o.label){case 0:return t=this.m_graphicsRender,new w.Transform(null).forward=a.vec3.down,[4,e.createTextureImageAsync("res/images/tex0.png")];case 1:return o.sent(),[4,_.TextureCubeMap.loadCubeMapTex("res/envmap/day360.jpg",e)];case 2:return n=o.sent(),[4,a.GLTFtool.LoadGLTFBinary("res/gltf/scene.glb")];case 3:return r=o.sent(),i=new g.GLTFSceneBuilder(r,e,this.m_graphicsRender.shaderLib),c=!0,p=new u.Scene,this.m_scene=p,(d=l.Camera.persepctive(null,60,400/300,.5,1e3)).transform.setPosition(a.glmath.vec3(0,-500,5)),d.transform.setLocalDirty(),d.ambientColor=h.Utility.colorRGBA(3,110,167,15),d.clearType=l.ClearType.Background,d.skybox=n,d.background=a.glmath.vec4(0,1,0,1),d.gameobject.addComponent(new y.CameraFreeFly),d.gameobject.name="camera",this.m_camera=d,c?((m=i.createScene()).name="gltfscene",null!=(v=m.getChildByName("sky_sky_0"))&&((b=v.render).castShadow=!1,b.material.setShader(t.shaderLib.shaderUnlitTexture)),m.transform.parent=p.transform,m.transform.applyTranslate(a.glmath.vec3(0,15,0)),d.transform.parent=m.transform):d.transform.parent=p.transform,T=new s.GameObject,f.Light.creatDirctionLight(T,1,a.glmath.vec3(.5,-1,.6)).lightColor=new a.vec3([1,1,1]),T.transform.parent=p.transform,this.m_sceneInited=!0,[2]}})})},e.cmdReload=function(e){null!=e&&e.m_graphicsRender.reload()},e.cmdPassDebug=function(){var t=e.Instance;null!=t&&(t.m_pipeline.renderPassDebug=!t.m_pipeline.renderPassDebug)},r([p.DebugEntry("cmd.reload")],e,"cmdReload",null),r([p.DebugEntry("cmd.passDebug")],e,"cmdPassDebug",null),e}();t.SampleGame=T,window.SampleGame=T},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(71),i=n(46),o={"gltf-assets":n(75).a,cube:r.a,"path-tracer":i.b}},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(9),i=(n.n(r),n(6)),o=(n.n(i),function(){function e(){}return e.prototype.onSetupRender=function(e){this.grender=e,e.setPipeline(new r.PipelineForwardZPrePass)},e.prototype.onInit=function(){this.m_scenemgr=new r.SceneManager},e.prototype.onSetupScene=function(){var e=this.grender,t=new r.Scene;this.m_scene=t;var n=r.Camera.persepctive(null,60,400/300,.5,1e3);n.transform.setPosition(r.glmath.vec3(0,1,0)),n.transform.setLocalDirty(),n.transform.parent=t.transform,n.clearType=r.ClearType.Background,n.background=r.vec4.zero,n.gameobject.addComponent(new r.CameraFreeFly);var o=new r.GameObject("cube"),a=new r.Material(e.shaderLib.shaderDiffuse);a.setColor(r.ShaderFX.UNIFORM_MAIN_COLOR,r.glmath.vec4(1,1,1,1));var u=new i.MeshRender(r.Mesh.Cube,a);this.m_render=u,o.render=u,o.transform.setPosition(r.glmath.vec3(0,0,-7)),o.addComponent({onUpdate:function(e){var t=r.Input.snapshot.deltaTime;t*=30;var n=r.quat.fromEulerDeg(t,-t,-2*t);this.gameobject.transform.applyRotate(n)}}),o.transform.parent=t.transform;var s=new r.GameObject("loght");r.Light.creatDirctionLight(s,1,r.glmath.vec3(0,-1,.1)).gameobject.transform.parent=t.transform},e.prototype.onFrame=function(e){var t=this.grender,n=t.glctx.gl;n.clearColor(0,1,1,1),n.clear(n.COLOR_BUFFER_BIT);var r=this.m_scene;this.m_scenemgr.onFrame(r),t.render(r,e),t.renderToCanvas()},e.prototype.onRelease=function(){var e=this.grender.glctx;null!=this.m_render&&(this.m_render.release(e),this.m_render=null),this.m_scene=null,this.m_scenemgr=null,this.grender=null},e}())},function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(8),i=n(9),o=(n.n(i),n(4)),a=(n.n(o),n(20)),u=(n.n(a),n(1)),s=(n.n(u),n(6)),l=(n.n(s),n(46)),c=n(73),f=n(74),p=function(e){function t(t){var n=e.call(this)||this;return n.m_onfront=!0,n.m_setup=!1,n.drawRaster=!1,n.m_frame=0,n.m_maxFrame=5e3,n.m_csgcontainer=t,n.CSGBufferIndex=i.PipelineBase.UNIFORMINDEX_SHADER,n}return r.c(t,e),t.prototype.init=function(){return r.a(this,void 0,void 0,function(){var n,p,h,d,m,y,v,_,g,b,w,T;return r.d(this,function(r){switch(r.label){case 0:return this.m_inited?[2]:(e.prototype.init.call(this),n=this.gl,p=this.mainFrameBufferWidth,h=this.mainFrameBufferHeight,d=new o.TextureCreationDesc(n.RGB,n.RGB8,!1),this.m_texBack=o.Texture.createTexture2D(p,h,d,this.glctx),this.m_texFront=o.Texture.createTexture2D(p,h,d,this.glctx),m=n.createFramebuffer(),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,m),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.m_texBack.rawtexture,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),this.m_fbBack=m,y=n.createFramebuffer(),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,y),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.m_texFront.rawtexture,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),this.m_fbFront=y,null!=t.SH_PATHTRACER?[3,3]:(v=t,[4,a.ShaderSource.load(c,"pathtracer")]));case 1:return v.SH_PATHTRACER=r.sent(),[4,i.ShaderVariant.load(f,"VARIANT_PATH_TRACER")];case 2:_=r.sent(),i.ShaderFX.registVariant(_),i.ShaderFX.linkAllVariant(),r.label=3;case 3:return null==this.m_shader&&(this.m_shader=i.ShaderFX.compileShaders(this.glctx,t.SH_PATHTRACER)),(g=new i.Material(this.m_shader)).setUniformBlockwitName(l.a.BUFFER_NAME,this.CSGBufferIndex),this.m_meshrender=new s.MeshRender(i.Mesh.Quad,g),this.m_passOpaque=new i.PassOpaque(this),null==this.m_csgbuffer&&(b=n.createBuffer(),n.bindBuffer(n.UNIFORM_BUFFER,b),n.bufferData(n.UNIFORM_BUFFER,this.m_csgcontainer.data.fxbuffer.raw,n.STATIC_DRAW),n.bindBufferBase(n.UNIFORM_BUFFER,i.PipelineBase.UNIFORMINDEX_SHADER,b),n.bindBuffer(n.UNIFORM_BUFFER,null),this.m_csgbuffer=b),(w=new u.ShaderTags).blend=!1,w.ztest=u.Comparison.LEQUAL,w.zwrite=!0,w.fillDefaultVal(),this.m_stateRaster=w,(T=new u.ShaderTags).ztest=u.Comparison.ALWAYS,T.zwrite=!1,w.blend=!1,T.fillDefaultVal(),n.depthMask(!0),n.clearDepth(1),this.m_setup=!0,[2]}})})},t.prototype.resizeFrameBuffer=function(t,n){e.prototype.resizeFrameBuffer.call(this,t,n);var r=this.gl;this.m_fbBack=this.resizeBufferAndTex(this.m_fbBack,this.m_texBack,r.COLOR_ATTACHMENT0,t,n),this.m_fbFront=this.resizeBufferAndTex(this.m_fbFront,this.m_texFront,r.COLOR_ATTACHMENT0,t,n)},t.prototype.resizeBufferAndTex=function(e,t,n,r,i){var o=this.gl;return null!=e&&o.deleteFramebuffer(e),t.resize(r,i,this.glctx),e=o.createFramebuffer(),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,e),o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,n,o.TEXTURE_2D,t.rawtexture,0),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),e},t.prototype.toggleRenderMode=function(){this.drawRaster=!this.drawRaster},t.prototype.release=function(){if(this.m_inited){e.prototype.release.call(this);var t=this.gl,n=this.glctx;null!=this.m_fbBack&&(t.deleteFramebuffer(this.m_fbBack),this.m_fbBack=null),null!=this.m_fbFront&&(t.deleteFramebuffer(this.m_fbFront),this.m_fbFront=null),null!=this.m_texBack&&(this.m_texBack.release(n),this.m_texBack=null),null!=this.m_texFront&&(this.m_texFront.release(n),this.m_texFront=null)}},t.prototype.exec=function(e){if(this.m_setup){this.generateDrawList(e);var t=this.gl,n=e.mainCamera;n.aspect=this.mainFrameBufferAspect,(n.isDataProjDirty||n.isDataTrsDirty)&&(this.m_frame=1),this.updateShaderDataBasis(n);var r=this.m_csgcontainer;r.data.setIter(this.m_frame),r.updateUniformData(this.m_csgbuffer,t);var o=this.stateCache,a=this.drawRaster,u=this.m_onfront;if(!a&&this.m_frame<this.m_maxFrame){var s=this.m_meshrender.material;s.setTexture(i.ShaderFX.UNIFORM_MAIN_TEXTURE,u?this.m_texBack:this.m_texFront),s.setFloat("seed",Math.random()),o.apply(this.m_stateTracer),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,u?this.m_fbFront:this.m_fbBack),this.drawMeshRender(this.m_meshrender),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),this.m_onfront=!this.m_onfront,this.m_frame++}this.bindTargetFrameBuffer(),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),a?(o.apply(this.m_stateRaster),this.m_passOpaque.render(e)):this.drawFullScreenTex(u?this.m_texFront:this.m_texBack)}},t}(i.PipelineBase)},function(e,t,n){e.exports=n.p+"static/media/pathtracer.7f4bba40.glsl"},function(e,t,n){e.exports=n.p+"static/media/pathtracer.inc.3b0be1af.glsl"},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(8),i=n(9),o=(n.n(i),n(76)),a=function(){function e(){}return e.prototype.onSetupRender=function(e){this.grender=e;var t=new i.PipelineForwardZPrePass;e.setPipeline(t),this.pipeline=t},e.prototype.onInit=function(){return r.a(this,void 0,void 0,function(){return r.d(this,function(e){return this.m_sceneMgr=new i.SceneManager,[2]})})},e.prototype.onSetupScene=function(){return r.a(this,void 0,void 0,function(){var e,t,n,a,u,s,l,c,f;return r.d(this,function(r){switch(r.label){case 0:return e=this.pipeline,t=new i.Scene,this.m_scene=t,[4,i.GLTFtool.LoadGLTFBinary(o)];case 1:return n=r.sent(),a=new i.GLTFSceneBuilder(n,e.GLCtx,this.grender.shaderLib),u=a.createScene(),null!=(s=u.getChildByName("sky_sky_0"))&&((l=s.render).castShadow=!1,l.material.setShader(this.grender.shaderLib.shaderUnlitTexture)),u.transform.parent=t.transform,(c=i.Camera.persepctive(null,60,400/300,.5,1e3)).transform.setPosition(i.glmath.vec3(5,-13,-15)),c.transform.applyRotate(i.quat.fromEulerDeg(-20,160,0)),c.transform.setLocalDirty(),c.ambientColor=i.Utility.colorRGBA(3,110,167,15),c.clearType=i.ClearType.Background,c.background=i.glmath.vec4(1,0,0,1),c.gameobject.addComponent(new i.CameraFreeFly),c.gameobject.name="camera",c.transform.parent=t.transform,f=new i.GameObject("light"),i.Light.creatDirctionLight(f,1,i.glmath.vec3(.5,-1,.6)).lightColor=new i.vec3([1,1,1]),f.transform.parent=t.transform,[2]}})})},e.prototype.onFrame=function(e){var t=this.m_sceneMgr,n=this.m_scene,r=this.grender;t.onFrame(n),r.render(n,e),this.m_sceneMgr.onFrame(n),r.render(n,e),r.renderToCanvas()},e.prototype.onRelease=function(){},e}()},function(e,t,n){e.exports=n.p+"static/media/scene.c81d3cf2.glb"},function(e,t){},function(e,t,n){"use strict";t.a=function(){if("serviceWorker"in navigator){var e=new URL("",window.location.toString());if(e.origin!==window.location.origin)return;window.addEventListener("load",function(){var e="/service-worker.js";r?(!function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):i(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):i(e)})}};var r=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function i(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}}]);
//# sourceMappingURL=main.cb127320.js.map